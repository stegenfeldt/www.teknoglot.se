<?xml version="1.0" encoding="UTF-8" ?>
<!-- This is a WordPress eXtended RSS file generated by WordPress as an export of your site. -->
<!-- It contains information about your site's posts, pages, comments, categories, and other content. -->
<!-- You may use this file to transfer that content from one site to another. -->
<!-- This file is not intended to serve as a complete backup of your site. -->

<!-- To import this information into a WordPress site follow these steps: -->
<!-- 1. Log in to that site as an administrator. -->
<!-- 2. Go to Tools: Import in the WordPress admin panel. -->
<!-- 3. Install the "WordPress" importer from the list. -->
<!-- 4. Activate & Run Importer. -->
<!-- 5. Upload this file using the form provided on that page. -->
<!-- 6. You will first be asked to map the authors in this export file to users -->
<!--    on the site. For each author, you may choose to map to an -->
<!--    existing user on the site or to create a new user. -->
<!-- 7. WordPress will then import each of the posts, pages, comments, categories, etc. -->
<!--    contained in this file into your site. -->

<!-- generator="WordPress/3.1" created="2011-04-27 20:15" -->
<rss version="2.0"
	xmlns:excerpt="http://wordpress.org/export/1.1/excerpt/"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:wp="http://wordpress.org/export/1.1/"
>

<channel>
	<title>teknoglot:</title>
	<link>http://www.teknoglot.se</link>
	<description>Techspeak for the socially diminished</description>
	<pubDate>Wed, 27 Apr 2011 20:15:31 +0000</pubDate>
	<language>en</language>
	<wp:wxr_version>1.1</wp:wxr_version>
	<wp:base_site_url>http://www.teknoglot.se</wp:base_site_url>
	<wp:base_blog_url>http://www.teknoglot.se</wp:base_blog_url>

	<wp:author><wp:author_id>1</wp:author_id><wp:author_login>ilex</wp:author_login><wp:author_email>sam@hartati.se</wp:author_email><wp:author_display_name><![CDATA[Sam T]]></wp:author_display_name><wp:author_first_name><![CDATA[Samuel]]></wp:author_first_name><wp:author_last_name><![CDATA[Tegenfeldt]]></wp:author_last_name></wp:author>


	<generator>http://wordpress.org/?v=3.1</generator>

	<item>
		<title>Clearing Disabled Discovery in OpsMgr 2007</title>
		<link>http://www.teknoglot.se/ms/opsmgr2007/clearing-disabled-discovery/</link>
		<pubDate>Mon, 20 Apr 2009 09:15:15 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/?p=16</guid>
		<description></description>
		<content:encoded><![CDATA[Jonathan Almquist has posted (a while ago) an article on how to clear discovered objects after you have disabled the discovery rules in OpsMgr that I think deserves a notion.

Read more about it at <a title="Remove-DisabledMonitoringObject" href="http://blogs.technet.com/jonathanalmquist/archive/2008/09/14/remove-disabledmonitoringobject.aspx">Jonathan Almquist on Operations Manager : Remove-DisabledMonitoringObject</a>.]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>16</wp:post_id>
		<wp:post_date>2009-04-20 10:15:15</wp:post_date>
		<wp:post_date_gmt>2009-04-20 09:15:15</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>clearing-disabled-discovery</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="how-to"><![CDATA[How-To]]></category>
		<category domain="post_tag" nicename="opsmgr"><![CDATA[OpsMgr]]></category>
		<category domain="category" nicename="opsmgr2007"><![CDATA[OpsMgr 2007]]></category>
		<category domain="post_tag" nicename="script"><![CDATA[Script]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Silly Hibernation doo-doo on WinXP</title>
		<link>http://www.teknoglot.se/ms/winxp/silly-hibernation-doo-doo-on-winxp/</link>
		<pubDate>Sun, 03 Dec 2006 11:55:52 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://www.tranquillity.se/2006/12/03/silly-hibernation-doo-doo-on-winxp/</guid>
		<description></description>
		<content:encoded><![CDATA[I recently added another 500MB of RAM to my computer... and there was much rejoice.

However, after a few days it started to behave erraticly when pressing the Fn+F12 combo (on a ThinkPad that means "Hibernate"). It simply refused to hibernate with the very intuitive error message "Insufficent System Resources Exist to Complete the API".

Anyway. <a title="Microsoft.com" href="http://www.microsoft.com/">Microsoft</a> has a fix for it, and you don't have to call them to get it anymore either. Just follow the link below.
<a title="http://support.microsoft.com/kb/Q909095" href="http://support.microsoft.com/kb/Q909095">http://support.microsoft.com/kb/Q909095</a>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>41</wp:post_id>
		<wp:post_date>2006-12-03 12:55:52</wp:post_date>
		<wp:post_date_gmt>2006-12-03 11:55:52</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>silly-hibernation-doo-doo-on-winxp</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="drivers"><![CDATA[Drivers]]></category>
		<category domain="post_tag" nicename="kb"><![CDATA[KB]]></category>
		<category domain="category" nicename="winxp"><![CDATA[Windows XP]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>w3Socket in VBScript</title>
		<link>http://www.teknoglot.se/code/vbs/w3socket-in-vbscript/</link>
		<pubDate>Sat, 21 Apr 2007 15:10:05 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://www.tranquillity.se/2007/04/21/w3socket-in-vbscript/</guid>
		<description></description>
		<content:encoded><![CDATA[I've been doing quite a lot of VBScripting in a couple of projects lately. The current one requires med to connect to a couple of telnet servers and look for... stuff.
Since we're not in VB6 och .Net i cannot simply user Winsock as normally due to the lack of licensing features in <acronym title="VisualBasic Script">VBS</acronym>/<acronym title="Windows Scripting Host">WSH.</acronym>

Thankfully for me, <a title="Dimac" href="http://www.dimac.com/">Dimac</a> has release a <a title="Dimac - Free Downloads" href="http://www.dimac.com/default3.asp?M=FreeDownloads/Menu.asp&amp;P=FreeDownloads/FreeDownloadsstart.asp">nifty little component</a> for free that makes talking telnet in VBS very simple.

I thought that, hey! I must share this!
So here's an example in Classic VBS:

[vb light="false"]
Dim oTelnet
oTelnet = CreateObject(&quot;Socket.Tcp&quot;)

With oTelnet
.DoTelnetEmulation = True
.TelnetEmulation = &quot;TTY&quot;
.Host = &quot;192.168.242.1:23&quot;
.Open
.WaitFor &quot;SLUSSEN login:&quot;
.SendLine &quot;ANiftyUsename&quot;
.WaitFor &quot;Password:&quot;
.SendLine &quot;TEHP@ssw0rd&quot;
.WaitFor &quot;~ #&quot;
.SendLine &quot;ifconfig&quot;
MsgBox .Buffer
.Close
End With

Set oTelnet = Nothing
[/vb]

Not very hard at all. This one is connecting to my router (with fake user/pwd... DUH!) and there's no support for setting the prompt type there, thus the "~ #".
The result of running this script with correct login info gives me a popup with the routers <acronym title="Network Interface Card">NIC</acronym>-configuration.]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>59</wp:post_id>
		<wp:post_date>2007-04-21 16:10:05</wp:post_date>
		<wp:post_date_gmt>2007-04-21 15:10:05</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>w3socket-in-vbscript</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="script"><![CDATA[Script]]></category>
		<category domain="category" nicename="vbs"><![CDATA[VBS]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>jd_tweet_this</wp:meta_key>
			<wp:meta_value><![CDATA[no]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Intel Drivers causes old-school freezes on Windows Vista</title>
		<link>http://www.teknoglot.se/ms/vista/intel-drivers-causes-old-school-freezes-on-windows-vista/</link>
		<pubDate>Sat, 01 Dec 2007 11:31:55 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://www.tranquillity.se/2007/12/01/intel-drivers-causes-old-school-freezes-on-windows-vista/</guid>
		<description></description>
		<content:encoded><![CDATA[<p>I recently got a nice new Lenovo ThinkPad T61 laptop at work to replace the old T42 I had earlier. Totally nice with 2,2GHz dual-core, Windows Vista and stuff.</p> <p>Now, there seems to be a problem with some drivers since I get the back-to-the-90s kinda lockups. You know were pretty much everything remotely interactive freeze. No BSOD, no crasches, no reboot. Just a plain freeze and all you can do is to press and hold the powerbutton until the computer powers off.</p> <p>Apparently, these problems are caused by some bug or something in the Intel Turbo Memory Driver and the Intel Matrix Storage Manager in combination with some power-save feature in Windows Vista called "Windows Hybrid Hard Disk Power Savings Mode". (Christ! Whatever happened to abrevations? I think i want those back. "ITMD and IMSM with WHDDPSM causes hickups"... no... wait.)</p> <p>Aaaanyway.<br />The people over at the <a href="http://forum.notebookreview.com">forums of Notebookreview.com</a> has experienced this and posted a guide with the appropriate links. </p> <p>Check it out at <a title="http://forum.notebookreview.com/showthread.php?t=160154&amp;page=2" href="http://forum.notebookreview.com/showthread.php?t=160154&amp;page=2">http://forum.notebookreview.com/showthread.php?t=160154&amp;page=2</a></p> <p>Cheers!</p>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>81</wp:post_id>
		<wp:post_date>2007-12-01 12:31:55</wp:post_date>
		<wp:post_date_gmt>2007-12-01 11:31:55</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>intel-drivers-causes-old-school-freezes-on-windows-vista</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="drivers"><![CDATA[Drivers]]></category>
		<category domain="category" nicename="vista"><![CDATA[Windows Vista]]></category>
		<wp:postmeta>
			<wp:meta_key>IMM-Glossary_-_Posts_-_Permission</wp:meta_key>
			<wp:meta_value><![CDATA[]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Quest Software acquires eXc and VizionCore</title>
		<link>http://www.teknoglot.se/tb/quest-software-acquires-exc-and-vizioncore/</link>
		<pubDate>Wed, 30 Jan 2008 11:09:18 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://www.tranquillity.se/2008/01/30/quest-software-acquires-exc-and-vizioncore/</guid>
		<description></description>
		<content:encoded><![CDATA[Yes, I am officially slow. But never mind.

<a href="http://www.quest.com/">Quest Software</a> is a rather nice software developer with some interesting products for a wide range of <a href="http://www.microsoft.com">Microsoft</a> systems -- like <a href="http://www.quest.com/site-administrator-for-sharepoint/">Site Administrator</a> and <a href="http://www.quest.com/recovery-manager-for-sharepoint/">Recovery Manager</a> for SharePoint -- but also database and application servers like <a href="http://www.sap.com/">SAP</a> and Oracle E-business.

I have lately been working with some of their <a href="http://www.microsoft.com/sharepoint/default.mspx">MOSS</a>-related products that, neglecting the somewhat goofy and unspecific manuals, are stable and well worth taking a look at.

Quite recently they have acquired two other companies also worth paying attention to as they, too, tend to deliver products that ease things up. <a href="http://www.excsoftware.com/version3/version3/Default.aspx">eXc</a> does it's thing in the <a href="http://www.microsoft.com/mom">Microsoft SCOM/MOM</a> arena while <a href="http://www.vizioncore.com/">VizionCore</a> dances with virtualization techniques. At least, that's where I've come across them both.

How will this affect me, then?
Not very much it would seem. Here's what VizionCore says about their part:
<blockquote>“The completion of this acquisition signals another major step in Vizioncore’s evolution and growth in the virtualization market,” said David Bieneman, CEO of VizionCore. “While maintaining the autonomy that has made us successful, we will also be able to leverage technologies developed by and acquired by Quest, such as Invirtus and Provision Networks, to enhance and expand the feature sets of VizionCore products. This is very positive news for virtualization customers who will enjoy a richer and robust product set that will help them achieve greater levels of ROI from their investments in virtualization platforms.”</blockquote>
In my head, this means that VizionCore will still be VizionCore but with, perhaps, tighter integration with Invirtus. Invirtus was, by the way, a "Strategic Partner" to VizionCore even before the acquisition.

eXc then? Well. It is not clearly stated in the press-release as far as I can tell. We can only hope that they will make the decision to rebuild their not-even-web1.0 excuse for a website. And what the hell is up with that logo? Fortunately for us, their design skills -- or lack thereof -- does not reflect their programming skills. But still... no sane man or woman uses Comic Sans in a logo. Not even jokingly. Actually, using Comic Sans at all should be considered an act of felony.
<h6>references:</h6>
<a href="http://www.quest.com/newsroom/news-releases-show.aspx?contentid=6540">Quest Software Continues Its Value Add to Microsoft System Center</a>
<a href="http://www.quest.com/newsroom/news-releases-show.aspx?contentid=6752">Quest Software Completes Acquisition of VizionCore...</a>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>87</wp:post_id>
		<wp:post_date>2008-01-30 12:09:18</wp:post_date>
		<wp:post_date_gmt>2008-01-30 11:09:18</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>quest-software-acquires-exc-and-vizioncore</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="opsmgr"><![CDATA[OpsMgr]]></category>
		<category domain="category" nicename="tb"><![CDATA[Technobabble]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>IMM-Glossary_-_Posts_-_Permission</wp:meta_key>
			<wp:meta_value><![CDATA[]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>NVidia problems in Ubuntu 8.10</title>
		<link>http://www.teknoglot.se/linux/ubuntu/nvidia-problems-in-ubuntu-810/</link>
		<pubDate>Mon, 10 Nov 2008 08:20:14 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://www.tranquillity.se/2008/11/10/nvidia-problems-in-ubuntu-810/</guid>
		<description></description>
		<content:encoded><![CDATA[[updated, scroll down if you want to skip some nonsense]

So, I did an upgrade to Ubuntu Studio 8.10 (basically Ubuntu with rt-kernel and lots of nice media-related packages easily accessible and a skin that rocks) from the earlier 8.04. And the upgrade itself was really easy. I just opened the "Software Sources", set the  <em>Release upgrade</em> to <strong>Normal Releases</strong> (you find it under the <em>Updates</em> tab).
After that you get the option to do a <em>Distribution Upgrade</em>, which I did (took some 45 minutes to finish).

I did however run into some serious problems with the NVidia Drivers after the upgrade. Basically, the new drivers dont seem to install correctly under the new kernel. This conclusion took me a day of laborating with settings, installing packages, uninstalling packages, reinstalling packages and a whole lot of googling.

What I have come down to right now is doing the following:
<blockquote><strong>sudo apt-get install module-assistant</strong></blockquote>
This will install the module assistant and it will also make sure that you have all the correct linux headers to install the NVidia drivers.

<span style="text-decoration: line-through;">Going back to the "Software Sources" under i check the "Unsopported updates".</span>
Then i execute
<blockquote><span style="text-decoration: line-through;">sudo apt-get autoremove</span></blockquote>
<blockquote><span style="text-decoration: line-through;">sudo apt-get install nvidia-177-kernel-source</span></blockquote>
<blockquote><strong>m-a auto-install nvidia</strong></blockquote>
<strong>UPDATE!</strong>

After fiddling around with this Laptop (Lenovo Thinkpad T61) I really just needed these three steps to fix the problem. All of them from X using the regular nv-drivers.
<ol>
	<li>In a terminal, run <em>sudo apt-get install module assistant</em></li>
	<li>In a terminal, run <em>sudo m-a auto-install nvidia</em></li>
	<li>Open the "Hardware Drivers" application and pick the driver you want (177 in my case) and click Activate. If it worked alright, you'll get the green recycle icon and be asked to reboot to activate the settings.</li>
</ol>
Hopefully, this might help someone. It did work for me and I am now able to work with wobbly windows and all that crap. (Besides some serious 3d stuff ;) )

Anyway. Since I did not save the urls, I cannot give credit to those who have pointed to stuff that did help me on the way, but I've actually not find information anywhere yet that solve the problem totally and, well... that's why I did decide to post in here.

Feel free to leave a comment if you got any more info or if you got any help from this.]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>98</wp:post_id>
		<wp:post_date>2008-11-10 09:20:14</wp:post_date>
		<wp:post_date_gmt>2008-11-10 08:20:14</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>nvidia-problems-in-ubuntu-810</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="drivers"><![CDATA[Drivers]]></category>
		<category domain="post_tag" nicename="nvidia"><![CDATA[NVidia]]></category>
		<category domain="category" nicename="ubuntu"><![CDATA[Ubuntu]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:comment>
			<wp:comment_id>2</wp:comment_id>
			<wp:comment_author><![CDATA[Elli]]></wp:comment_author>
			<wp:comment_author_email>elligirl@gmail.com</wp:comment_author_email>
			<wp:comment_author_url>http://</wp:comment_author_url>
			<wp:comment_author_IP>154.5.59.51</wp:comment_author_IP>
			<wp:comment_date>2008-11-12 18:26:27</wp:comment_date>
			<wp:comment_date_gmt>2008-11-12 17:26:27</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[I've been fighting with Ubuntu ever since the upgrade to Ibex. I've tried your method and it feels like it's going to work, but the blue screen of the module installer always says the build fails. Not sure why. :(]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>3</wp:comment_id>
			<wp:comment_author><![CDATA[samPe]]></wp:comment_author>
			<wp:comment_author_email>samuel.persson@gmail.com</wp:comment_author_email>
			<wp:comment_author_url>http://www.tranquillity.se</wp:comment_author_url>
			<wp:comment_author_IP>195.67.18.75</wp:comment_author_IP>
			<wp:comment_date>2008-11-18 12:41:32</wp:comment_date>
			<wp:comment_date_gmt>2008-11-18 11:41:32</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[<p>I assume you are getting stuck at step 2?<br />
Do you get any error messages?</p>
<p>Try executing the striked commands in my post. They did no good, as far as I can tell, on my laptop and when I repeated another one I could leave them out.<br />
Before the second step, do:<br />
<code>sudo apt-get autoremove</code><br />
and then<br />
<code>sudo apt-get install nvidia-177-kernel-source</code></p>
<p>Let me know if it helps.</p>]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>4</wp:comment_id>
			<wp:comment_author><![CDATA[Elli]]></wp:comment_author>
			<wp:comment_author_email>elligirl@gmail.com</wp:comment_author_email>
			<wp:comment_author_url>http://</wp:comment_author_url>
			<wp:comment_author_IP>154.5.59.51</wp:comment_author_IP>
			<wp:comment_date>2008-11-21 20:05:05</wp:comment_date>
			<wp:comment_date_gmt>2008-11-21 19:05:05</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[I'm not sure what changed now, but when I tried to grab the nvidia driver, this is what I get:

sudo apt-get install nvidia 177-kernel-source
Reading package lists... Done
Building dependency tree
Reading state information... Done
E: Couldn't find package nvidia-177-kernel-source]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>5</wp:comment_id>
			<wp:comment_author><![CDATA[samPe]]></wp:comment_author>
			<wp:comment_author_email>samuel.persson@gmail.com</wp:comment_author_email>
			<wp:comment_author_url>http://www.tranquillity.se</wp:comment_author_url>
			<wp:comment_author_IP>195.67.18.73</wp:comment_author_IP>
			<wp:comment_date>2008-11-24 10:55:10</wp:comment_date>
			<wp:comment_date_gmt>2008-11-24 09:55:10</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[<p>Hmm... I'm afraid I haven't got a good answer for you there.</p>
<p>Try running:<br />
<code>sudo aptitude search nvidia-177</code></p>
<p>You should be able to see two packages there. The <code>nvidia-177-kernel-source</code> and the <code>nvidia-177-modaliases</code></p>
<p>Perhaps it's a repository thing?</p>]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>6</wp:comment_id>
			<wp:comment_author><![CDATA[shubbar]]></wp:comment_author>
			<wp:comment_author_email>ahmed.shubbar@gmail.com</wp:comment_author_email>
			<wp:comment_author_url>http://</wp:comment_author_url>
			<wp:comment_author_IP>94.99.90.160</wp:comment_author_IP>
			<wp:comment_date>2008-11-28 17:16:01</wp:comment_date>
			<wp:comment_date_gmt>2008-11-28 16:16:01</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Still build failed even after executing the striked commands above. Error was: "Build of the package nvidia-kernel-source failed!". How to fix this?]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>7</wp:comment_id>
			<wp:comment_author><![CDATA[samPe]]></wp:comment_author>
			<wp:comment_author_email>samuel.persson@gmail.com</wp:comment_author_email>
			<wp:comment_author_url>http://www.tranquillity.se</wp:comment_author_url>
			<wp:comment_author_IP>83.226.232.32</wp:comment_author_IP>
			<wp:comment_date>2008-11-29 19:52:27</wp:comment_date>
			<wp:comment_date_gmt>2008-11-29 18:52:27</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Spontaneously, i would guess that you does not have the "unstable" repositories enabled.
Now, I'm currently on a Debian box and I don't remember what they are called in Ubuntu. I Will check it out and get back to you.
This is probably the case for both you and Elli.]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
	</item>
	<item>
		<title>Got &quot;failed to create System.PropertyBagData&quot; in OpsMgr?</title>
		<link>http://www.teknoglot.se/ms/opsmgr2007/failed-to-create-propertybagdata-opsmgr/</link>
		<pubDate>Tue, 21 Apr 2009 07:37:27 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/?p=120</guid>
		<description></description>
		<content:encoded><![CDATA[On several systems at different sites I've noticed an abundance of the following errors in the Operations Manager 2007 logs:
[plain light="true"]
Event Type:    Warning
Event Source:    Health Service Modules
Event Category:    None
Event ID:    21405
Date:        2009-04-21
Time:        09:00:26
User:        N/A
Computer:    MASKED
Description:
The process started at 09:00:26 failed to create System.PropertyBagData, no errors detected in the output.  The process exited with 0&lt;/pre&gt;
Command executed:    &quot;C:\WINNT\system32\cscript.exe&quot; /nologo &quot;NetworkAdapterCheck.vbs&quot; MASKEDCOMPUTER.DOMAIN 7 false true false Working Directory:    C:\Program Files\System Center Operations Manager 2007\Health Service State\Monitoring Host Temporary Files 1\50958\

One or more workflows were affected by this.

Workflow name: Microsoft.Windows.Server.2000.NetworkAdapter.NetworkAdapterConnectionHealth
Instance name: 7
Instance ID: {A6F89C78-1217-578E-B03D-5ED377A9A40B}
Management group: MASKED

For more information, see Help and Support Center at http://go.microsoft.com/fwlink/events.asp.
[/plain]
Always the "NetworkAdapterCheck.vbs". Always "The process exited with 0" which usually means that life is A-OK.

This <em>may</em> be a result of your AV-software blocking the scripts.
The first thing to do would be to exclude HealthService.exe and MonitoringHost.exe. If this doesn't work, try excluding the entire C:\Program Files\System Center Operations Manager 2007\Health Service State\ directory.

There is a <a title="MS Connect: failed to create System.PropertyBagData" href="https://connect.microsoft.com/feedback/ViewFeedback.aspx?FeedbackID=432627&amp;SiteID=446">bug-report on Microsoft Connect</a> that you can add your vote to if you cannot get rid of the problem. But ofcourse, if you have a solution, do post it here or on the bug-report. :D]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>120</wp:post_id>
		<wp:post_date>2009-04-21 08:37:27</wp:post_date>
		<wp:post_date_gmt>2009-04-21 07:37:27</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>failed-to-create-propertybagdata-opsmgr</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="errors"><![CDATA[Errors]]></category>
		<category domain="post_tag" nicename="opsmgr"><![CDATA[OpsMgr]]></category>
		<category domain="category" nicename="opsmgr2007"><![CDATA[OpsMgr 2007]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:comment>
			<wp:comment_id>8</wp:comment_id>
			<wp:comment_author><![CDATA[[ Teknoglot ] &raquo; NetworkAdapterCheck.vbs fails on Windows 2000]]></wp:comment_author>
			<wp:comment_author_email></wp:comment_author_email>
			<wp:comment_author_url>http://teknoglot.hartati.se/ms/opsmgr2007/networkadaptercheck-fails-on-win2k/</wp:comment_author_url>
			<wp:comment_author_IP>208.43.64.53</wp:comment_author_IP>
			<wp:comment_date>2009-04-26 18:26:32</wp:comment_date>
			<wp:comment_date_gmt>2009-04-26 17:26:32</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[[...] Server 2000 Operating System Management Pack för Operations Manager 2007 that is causing the failed to create System.PropertyBadData error i wrote about earlier. This information in also available on [...] ]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type>pingback</wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
	</item>
	<item>
		<title>NetworkAdapterCheck.vbs fails on Windows 2000</title>
		<link>http://www.teknoglot.se/ms/opsmgr2007/networkadaptercheck-fails-on-win2k/</link>
		<pubDate>Sun, 26 Apr 2009 10:21:18 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/?p=125</guid>
		<description></description>
		<content:encoded><![CDATA[Here's my summary of the problems with the NetworkAdapterCheck.vbs script in the Windows Server 2000 Operating System Management Pack för Operations Manager 2007 that is causing the <a title="failed to create System.PropertyBagData" href="http://teknoglot.hartati.se/ms/opsmgr2007/failed-to-create-propertybagdata-opsmgr/">failed to create System.PropertyBagData</a> error i wrote about earlier.
This information in also available on <a href="https://connect.microsoft.com/feedback/ViewFeedback.aspx?FeedbackID=432627&amp;SiteID=446">https://connect.microsoft.com/feedback/ViewFeedback.aspx?FeedbackID=432627&amp;SiteID=446</a>
<h3>Symptoms</h3>
This "research" comes from getting an obscene amounts of Script or Executable Failed to run in the Operations Console. Each time it was the NetworkAdapterCheck.vbs script that could not create PropertyBagData. The error message copied from one of the alerts looks like this:

[plain light="true"]
The process started at 14:29:26 failed to create System.PropertyBagData, no errors detected in the output. The process exited with 0

Command executed: &quot;C:WINNTsystem32cscript.exe&quot; /nologo &quot;NetworkAdapterCheck.vbs&quot; MASKEDCOMPUTERNAME 0 false true false
Working Directory: C:Program FilesSystem Center Operations Manager 2007Health Service StateMonitoring Host Temporary Files 2882781

One or more workflows were affected by this.

Workflow name: Microsoft.Windows.Server.2000.NetworkAdapter.NetworkAdapterConnectionHealth
Instance name: 0
Instance ID: {F4C478D3-38E5-8C29-3957-E3B7F486216E}
Management group: MASKED
[/plain]

This error repeats almost as often as the script is scheduled to run and appears on almost every Windows 2000 server.

<!--more-->
<h3>Cause?</h3>
I am not really sure, but after a quite a bit of troubleshooting I am pretty sure it all boils down to a malformed WMI-query. What I basically did was to extract the script from the MP and dry-run it to see if I could find anything obvious, which I didn't.
Since I didn't have a good debugging too available, like in PrimalScript, I added the VBS equivalent of old-school printf debugging. I basically added

[vb light="true"]wscript.echo &quot;Line XX:&quot; &amp; Err.Number[/vb]

after each object/function call in the Main Sub.
The problem seems to be at line 118:

[vb light="true"]Set WMISet = WMIGetInstance(&quot;winmgmts:\&quot; + TargetComputer + &quot;rootcimv2&quot;, query)[/vb]

At line 119 I had a debug line that never executes and it would seem like the script is unable to process the query and exits without any error codes.

The query variable contains the following:

[sql light="true"]Win32_NetworkAdapter Where DeviceID='0' And ( NetConnectionStatus = '0' )[/sql]

When I was debugging this I started the script like this:

[shell light="true"]cscript.exe /nologo &quot;NetworkAdapterCheck.vbs&quot; MASKED 0 false true false[/shell]

I did find that if I change the parameters to this:

[shell light="true"]cscript.exe /nologo &quot;NetworkAdapterCheck.vbs&quot; MASKED 0 false false false[/shell]

Then the script runs smoothly and produces an XML-output like this:

[xml light="true"]
&lt;Collection&gt;
&lt;DataItem type=&quot;System.PropertyBagData&quot; time=&quot;2009-04-22T15:03:44.6495202+02:00&quot; sourceHealthServiceId=&quot;C9F5A9F7-00A3-8A86-57B5-34FB634471A8&quot;&gt;
&lt;Property Name=&quot;State&quot; VariantType=&quot;8&quot;&gt;GOOD&lt;/Property&gt;
&lt;/DataItem&gt;
&lt;/Collection&gt;
[/xml]
<h3>Comments</h3>
There's quite the lot of similar errors posted on various forums on the internet but most of them ends up pointing towards the Antivirus Software as the perp and we have tried various exceptions on the server like excluding HealthExplorer.exe, MonitoringHost.exe and also the entire Health Service State folder with no improvement. But since I was able to run the scripts from other locations (not excluded) on the same server I find it hard to believe that the AV would be blocking it.]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>125</wp:post_id>
		<wp:post_date>2009-04-26 11:21:18</wp:post_date>
		<wp:post_date_gmt>2009-04-26 10:21:18</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>networkadaptercheck-fails-on-win2k</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="errors"><![CDATA[Errors]]></category>
		<category domain="post_tag" nicename="management-pack"><![CDATA[Management Pack]]></category>
		<category domain="post_tag" nicename="opsmgr"><![CDATA[OpsMgr]]></category>
		<category domain="category" nicename="opsmgr2007"><![CDATA[OpsMgr 2007]]></category>
		<category domain="post_tag" nicename="script"><![CDATA[Script]]></category>
		<wp:postmeta>
			<wp:meta_key>syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>jd_tweet_this</wp:meta_key>
			<wp:meta_value><![CDATA[no]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>MSMQ 3 MP for OpsMgr v.6.0.6587.0 Released</title>
		<link>http://www.teknoglot.se/ms/opsmgr2007/msmq-3-mp-for-opsmgr-v6065870-released/</link>
		<pubDate>Tue, 28 Apr 2009 14:30:18 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/?p=149</guid>
		<description></description>
		<content:encoded><![CDATA[<p>Last friday, 24/4 -09,&#160; Microsoft released an <a title="Message Queuing Management Pack for Operations Manager 2007" href="http://www.microsoft.com/downloads/details.aspx?FamilyId=1D2B4398-8BC2-4A43-850C-852EBB0D983B&amp;amp;displaylang=en&amp;displaylang=en">updated Management Pack for MSMQ 3.0</a>.</p>  <h4>Quick Details</h4>  <table style="height: 60px" cellspacing="0" cellpadding="0" width="469" border="0"><tbody>     <tr>       <td class="quickInfoName">File Name:</td>        <td class="quickInfoValue">Message Queuing System Center Operations Manager 2007 MP.MSI</td>     </tr>      <tr>       <td class="quickInfoName">Version:</td>        <td class="quickInfoValue">6.0.6587.0</td>     </tr>      <tr>       <td class="quickInfoName">Date Published:</td>        <td class="quickInfoValue">4/24/2009</td>     </tr>      <tr>       <td class="quickInfoName">Language:</td>        <td class="quickInfoValue">English</td>     </tr>      <tr>       <td class="quickInfoName">Download Size:</td>        <td class="quickInfoValue">502 KB</td>     </tr>   </tbody></table>  <h4>Release History</h4>  <ul>   <li>6/3/2008 - Initial Release, version 6.0.6278.23. Refer to the MP guide for further details. </li>    <li>4/24/2009 - Undated release, version 6.0.6587.0. Refer to the MP guide for further details. </li> </ul>  <p>The MP Guide does not really say much about what's updated and I don't know how much more than the reporting they have fixed. I can just state the fact that support for clustered MSMQ 3 instances is still missing.</p>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>149</wp:post_id>
		<wp:post_date>2009-04-28 15:30:18</wp:post_date>
		<wp:post_date_gmt>2009-04-28 14:30:18</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>msmq-3-mp-for-opsmgr-v6065870-released</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="management-pack"><![CDATA[Management Pack]]></category>
		<category domain="post_tag" nicename="msmq"><![CDATA[MSMQ]]></category>
		<category domain="post_tag" nicename="opsmgr"><![CDATA[OpsMgr]]></category>
		<category domain="category" nicename="opsmgr2007"><![CDATA[OpsMgr 2007]]></category>
		<wp:postmeta>
			<wp:meta_key>syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Windows Server 2008 NLB MP for OpsMgr released</title>
		<link>http://www.teknoglot.se/ms/opsmgr2007/windows-server-2008-nlb-m-for-opsmgr-released/</link>
		<pubDate>Wed, 29 Apr 2009 11:59:54 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/?p=153</guid>
		<description></description>
		<content:encoded><![CDATA[Don't know how I missed this when writing the last post, but Microsoft released the <a title="Windows Server 2008 Network Load Balancing for System Center Operations Manager 2007" href="http://www.microsoft.com/downloads/details.aspx?FamilyID=dc17e093-bdd7-4cb3-9981-853776ed90be&amp;displaylang=en">MP for Windows Server 2008 NLB </a>yesterday (28/4 -09). This is the initial release for Win2k8 NLB so I guess we just have to try it out then.
<h4>Quick Details</h4>
<table border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="quickInfoName">File Name:</td>
<td class="quickInfoValue">Microsoft Server 2008 Network Load Balancing System Center Operations Manager 2007 MP.msi</td>
</tr>
<tr>
<td class="quickInfoName">Version:</td>
<td class="quickInfoValue">6.0.6573.0</td>
</tr>
<tr>
<td class="quickInfoName">Date Published:</td>
<td class="quickInfoValue">4/28/2009</td>
</tr>
<tr>
<td class="quickInfoName">Language:</td>
<td class="quickInfoValue">English</td>
</tr>
<tr>
<td class="quickInfoName">Download Size:</td>
<td class="quickInfoValue">519 KB</td>
</tr>
</tbody></table>
<h4>Feature Summary</h4>
<ul>
	<li>Monitor the NLB Node status.</li>
	<li>Based on the status of individual cluster nodes, determine the overall state of the cluster.</li>
	<li>Where an integration management pack exists, determine the health state of a cluster node by looking at the health state of the load balanced application, such as IIS.</li>
	<li>Alert on errors and warnings that are reported by the NLB driver, such as an incorrectly configured NLB cluster.</li>
	<li>Take the node out of the NLB cluster if the underlying load-balanced application becomes unhealthy, and add the node back to the cluster when the application becomes healthy again.</li>
</ul>
Requires OpsMgr 2007 SP1 or later, the Base Operating System MP for 2008, the <a title="Support for running System Center Operations Manager 2007 Service Pack 1 and System Center Essentials 2007 Service Pack 1 on a Windows Server 2008-based computer" href="http://support.microsoft.com/kb/953141">QFEs for Windows Server 2008</a> and that you are not running the converted 2003 NLB MP. If you are running the old converted NLB MP, upgrade first. As an additional recommendation, Microsoft recommends in the MP Guide that you install the <a title="The WMI Provider Host program (Wmiprvse.exe) may crash on a Windows Server 2008-based computer that has the NLB feature installed2008" href="http://support.microsoft.com/kb/959493">QFE for wmiprvse.exe problems on Windows Server 2008</a>.

No support for Mixed-mode (2008 and 2003) clusters though.]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>153</wp:post_id>
		<wp:post_date>2009-04-29 12:59:54</wp:post_date>
		<wp:post_date_gmt>2009-04-29 11:59:54</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>windows-server-2008-nlb-m-for-opsmgr-released</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="management-pack"><![CDATA[Management Pack]]></category>
		<category domain="post_tag" nicename="opsmgr"><![CDATA[OpsMgr]]></category>
		<category domain="category" nicename="opsmgr2007"><![CDATA[OpsMgr 2007]]></category>
		<wp:postmeta>
			<wp:meta_key>jd_tweet_this</wp:meta_key>
			<wp:meta_value><![CDATA[yes]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>wp_jd_clig</wp:meta_key>
			<wp:meta_value><![CDATA[http://cli.gs/EzU96g]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_wp_old_slug</wp:meta_key>
			<wp:meta_value><![CDATA[windows-server-2008-nlb-for-opsmgr-released]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>&quot;Error doing IIS Discovery&quot; in OpsMgr</title>
		<link>http://www.teknoglot.se/ms/opsmgr2007/error-doing-iis-discovery-in-opsmgr/</link>
		<pubDate>Wed, 29 Apr 2009 10:37:27 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/?p=158</guid>
		<description></description>
		<content:encoded><![CDATA[I have seen this error popping up every now and then at multiple customer sites and haven't really been able to solve it yet. It does not look like I am alone either.
The error message usually looks like this:
[plain]Error doing IIS Discovery

Error: 0x80070002
Details: The system cannot find the file specified.

One or more workflows were affected by this.

Workflow name: Microsoft.Windows.InternetInformationServices.2003.DiscoverBase
Instance name: Microsoft.Windows.InternetInformationServices.2003.ServerRole
Instance ID: {A81E4808-4D05-9BFE-4043-DC668527F2D0}
Management group: MASKED[/plain]
Or...
[plain]Error doing IIS Discovery

Error: 0x80070006
Details: The handle is invalid.

One or more workflows were affected by this.

Workflow name: Microsoft.Windows.InternetInformationServices.2000.DiscoverWebSites26to50
Instance name: IIS Web Server
Instance ID: {D36DA76A-027F-8F3E-4160-115279A1E23A}
Management group: MASKED[/plain]
I have been trying to figure out what file is missing and/or if the "invalid handle" is related. Possibly a file-handle? Could be but not neccesary since these two errors occur on different servers with increasing repeat-count (atleast once-a-day). The IIS MP does call the IIS*.VBS Scripts in %windir%\System32 but <span style="text-decoration: underline;">as far as I can tell</span>, on the systems I have tried it on, the scritps return valid data. This does by no means mean that there is no error and evidently I am missing something. But what? Does anyone have a clue to this?
<h5>References and other victims:</h5>
<ul>
	<li><a href="http://www.google.com/search?hl=en&amp;q=%22Error+doing+IIS+Discovery%22&amp;btnG=Search">"Error Doing IIS Discovery"</a> on Google</li>
	<li><a href="http://www.codejnki.com/2008/10/scom-iis-discovery-probe-module-failed-execution/">"SCOM: IIS Discovery Probe Module Failed Execution"</a> on Codejnki's Blog</li>
	<li><a href="http://social.technet.microsoft.com/Forums/en/windowsserver2008r2webtechnologies/thread/127f2473-9eea-4248-b9c2-d0b1605ed945">"Error doing IIS Discovery Error: 0x80070006"</a> on TechNet Forums</li>
	<li><a href="http://www.digitalsupporttech.com/forum/user/viewthread?thread=693344">"IIS Discovery Probe Module Execution Failure"</a> on Digital Support Forum</li>
	<li><a href="http://www.eggheadcafe.com/software/aspnet/31903288/iis-discovery-probe-modul.aspx">"IIS Discovery Probe Module Execution Failure"</a> on EggHeadCafe</li>
	<li><a title="IISDiscoveryProbe Error - any ideas? in Operations Manager IIS Management Pack" href="http://www.microsoft.com/communities/newsgroups/en-us/default.aspx?dg=microsoft.public.opsmgr.iis&amp;tid=8d7de15a-3b54-4ea0-b2cc-30a23c361a35&amp;cat=F8CD68E8-5E44-9C7B-C39A-AB56E686F23F&amp;lang=en&amp;cr=US&amp;sloc=&amp;p=1">"IISDiscoveryProbe Error - any ideas?"</a> on <a href="http://www.microsoft.com/communities/newsgroups/en-us/default.aspx">Microsoft Discusson Groups</a></li>
</ul>
And no, neither of these provides even a hint to a working solution.]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>158</wp:post_id>
		<wp:post_date>2009-04-29 11:37:27</wp:post_date>
		<wp:post_date_gmt>2009-04-29 10:37:27</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>error-doing-iis-discovery-in-opsmgr</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="errors"><![CDATA[Errors]]></category>
		<category domain="post_tag" nicename="management-pack"><![CDATA[Management Pack]]></category>
		<category domain="post_tag" nicename="opsmgr"><![CDATA[OpsMgr]]></category>
		<category domain="category" nicename="opsmgr2007"><![CDATA[OpsMgr 2007]]></category>
		<wp:postmeta>
			<wp:meta_key>jd_tweet_this</wp:meta_key>
			<wp:meta_value><![CDATA[yes]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>wp_jd_clig</wp:meta_key>
			<wp:meta_value><![CDATA[http://cli.gs/qQJA3b]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Possible &quot;fix&quot; for no sound on Lenovo T61+Fedora11 x64</title>
		<link>http://www.teknoglot.se/linux/fedora-11/fix-no-sound-t61-fc11-x6/</link>
		<pubDate>Sat, 13 Jun 2009 20:48:34 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/?p=173</guid>
		<description></description>
		<content:encoded><![CDATA[Well, I wouldn't really call this a fix and I don't really know if I've got all facts for a decent how-too but this little manoeuvre helped me getting sound from the internal speakers on my Lenovo T61 in Fedora 11. Yah, that's AMD64/x64 by the way.

I found out after a bit of googling that sound really is working, but only when using the head-phone jack. So i tried it out and much to my amusement it was true. This means that the sound-card has been discovered and enabled.

Anyway. Opening a terminal and running <code>alsamixer -c0</code> will enable you to turn on the internal speakers.
In the mixer, step right until you get to "speaker" and you might find that it is muted by the <code>MM</code> above it. Press M and it will turn to <code>00</code>. Now check your master volume and start enjoying the sound... i hope.
If this doesn't work, you probably need to apply some patches and stuff found by... eh... google. ;)

Good luck!]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>173</wp:post_id>
		<wp:post_date>2009-06-13 21:48:34</wp:post_date>
		<wp:post_date_gmt>2009-06-13 20:48:34</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>fix-no-sound-t61-fc11-x6</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="drivers"><![CDATA[Drivers]]></category>
		<category domain="post_tag" nicename="fedora-11"><![CDATA[Fedora 11]]></category>
		<category domain="category" nicename="fedora-11"><![CDATA[Fedora 11]]></category>
		<category domain="post_tag" nicename="linux"><![CDATA[Linux]]></category>
		<category domain="post_tag" nicename="quick-fix"><![CDATA[Quick-fix]]></category>
		<category domain="post_tag" nicename="x64"><![CDATA[x64]]></category>
		<wp:postmeta>
			<wp:meta_key>jd_tweet_this</wp:meta_key>
			<wp:meta_value><![CDATA[yes]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>wp_jd_clig</wp:meta_key>
			<wp:meta_value><![CDATA[http://cli.gs/UYAQuv]]></wp:meta_value>
		</wp:postmeta>
		<wp:comment>
			<wp:comment_id>9</wp:comment_id>
			<wp:comment_author><![CDATA[el longo]]></wp:comment_author>
			<wp:comment_author_email>djlongo@gmail.com</wp:comment_author_email>
			<wp:comment_author_url>http://www.longovil.com</wp:comment_author_url>
			<wp:comment_author_IP>212.170.96.106</wp:comment_author_IP>
			<wp:comment_date>2009-07-31 08:19:06</wp:comment_date>
			<wp:comment_date_gmt>2009-07-31 07:19:06</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Muchas gracias!!! esto ha funcionado.
Thank you!!!  This has worked.]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>10</wp:comment_id>
			<wp:comment_author><![CDATA[Axel]]></wp:comment_author>
			<wp:comment_author_email>mammes@gmail.com</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>190.48.153.173</wp:comment_author_IP>
			<wp:comment_date>2009-08-09 16:18:30</wp:comment_date>
			<wp:comment_date_gmt>2009-08-09 15:18:30</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Thanks man, worked fine :)]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
	</item>
	<item>
		<title>MSMQ Management Pack: Subscript Out of Range</title>
		<link>http://www.teknoglot.se/ms/opsmgr2007/msmq-mp-subscriptoutofrange/</link>
		<pubDate>Wed, 24 Jun 2009 08:51:01 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/?p=182</guid>
		<description></description>
		<content:encoded><![CDATA[<span style="color: #800000;"><span style="text-decoration: underline;">UPDATE: This problem seems to be fixes in the latest update!</span></span>

The MSMQ Management Pack seems to have a few problems with it's discovery script that can lead to the following error showing up in the logs:

[plain]
The process started at 13:34:40 failed to create System.Discovery.Data. Errors found in output:

C:\Program Files\System Center Operations Manager 2007\Health Service State\Monitoring Host Temporary Files 49\9788\DiscoverQueues.vbs(107, 4) Microsoft VBScript runtime error: Subscript out of range: '[number: 0]'

Command executed: &quot;C:\WINDOWS\system32\cscript.exe&quot; /nologo &quot;DiscoverQueues.vbs&quot; {615D37C9-477D-62E2-0833-6ECBF0E89A87} {A176AC83-CC31-01C3-5DE9-E2DFF64E7CC7} &quot;MASKED.server.fqdn&quot; &quot;MSMQ&quot; &quot;true&quot; &quot;true&quot; &quot;False&quot; &quot;false&quot;
Working Directory: C:\Program Files\System Center Operations Manager 2007\Health Service State\Monitoring Host Temporary Files 49\9788\

One or more workflows were affected by this.

Workflow name: Microsoft.MSMQ.2003.DiscoverQueues

Instance name: MASKED.server.fqdn

Instance ID: {A176AC83-CC31-01C3-5DE9-E2DFF64E7CC7}

Management group: MASKED
[/plain]

This seems to be related to the discovery of public queues on <em>some</em> servers that has none. One quick fix, or rather work-around, is to override the discovery on these servers to set <code>DiscoverPublic</code> to <code>False</code>.
<img class="size-full wp-image-183" title="screenshot1245833173" src="http://www.teknoglot.se/wp/wp-content/uploads/2009/06/screenshot1245833173.png" alt="Screenshot of Override" width="626" height="26" />]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>182</wp:post_id>
		<wp:post_date>2009-06-24 09:51:01</wp:post_date>
		<wp:post_date_gmt>2009-06-24 08:51:01</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>msmq-mp-subscriptoutofrange</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="errors"><![CDATA[Errors]]></category>
		<category domain="post_tag" nicename="fixed"><![CDATA[Fixed]]></category>
		<category domain="post_tag" nicename="msmq"><![CDATA[MSMQ]]></category>
		<category domain="post_tag" nicename="opsmgr"><![CDATA[OpsMgr]]></category>
		<category domain="category" nicename="opsmgr2007"><![CDATA[OpsMgr 2007]]></category>
		<category domain="post_tag" nicename="quick-fix"><![CDATA[Quick-fix]]></category>
		<wp:postmeta>
			<wp:meta_key>jd_tweet_this</wp:meta_key>
			<wp:meta_value><![CDATA[yes]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>wp_jd_clig</wp:meta_key>
			<wp:meta_value><![CDATA[http://cli.gs/Lub4Q]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Why not use SQL Express? It’s for free!</title>
		<link>http://www.teknoglot.se/ms/sql2008/whynotusesqlexpress-itsforfree/</link>
		<pubDate>Fri, 21 Aug 2009 09:38:55 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/?p=195</guid>
		<description></description>
		<content:encoded><![CDATA[I get this question every now and then and every time I find myself completely flabbergasted and having to look things up once again. To avoid wasting my time on the same question once again and perhaps help others doing the same, here’s a little guidance.

Don’t get me wrong now.
SQL Express has it’s applications and for a free database server, it’s not half-bad. Small development sites, minor, not that extremely important systems with lower performance and feature demands, minor website databases et cetera could do well with SQL Express.

Here’s my list of questions you have to ask to find if SQL Express is the correct choice.
<ol>
	<li><strong>Do your applications support SQL Express?</strong>
If your application developers cannot say “Yes” to this, you’re out of luck. You could probably get their applications to run on SQL Express anyway, but application support if something goes bad will most likely be zilch.</li>
	<li><strong>Do your applications fit the hardware limitations?</strong>
SQL Express is limited to 1GB RAM, 1 CPU and 4GB of databases. 1GB of RAM seems a bit tight to me for any production data. Also, on SQL Express 2005, <a href="http://msdn.microsoft.com/en-us/library/ms345154%28SQL.90%29.aspx#sseover_topic4">according to Microsoft</a>, you cannot run parallel queries.
<em>”SQL Server Express can install and run on multiprocessor machines, but only a single CPU is used at any time. Internally, the engine limits the number of user scheduler threads to 1 so that only 1 CPU is used at a time. Features such as parallel query execution are not supported because of the single CPU limit.”
</em>If this is still true on SQL Express 2008, I don’t know and I haven’t found any information about it (yet).
When answering this question, remember to calculate expected growth and possibly new databases/applications too.</li>
	<li><strong>Do your applications use database replication?</strong>
If, so. Do the new server need to act as a publisher? If, yes, then you’re out of luck. SQL Express do handle database replication, but only as a subscriber. If you need to publish data, then you need a “bigger” SQL Edition.</li>
	<li><strong>Do you need Database Mail?</strong>
SQL Express does not have Database Mail. You have to find other ways to code your notifications. This question has raised counter-questions from customers as to “What would I need Database Mail for?”. It is, evidently a feature not used by many. Personally, I find it useful. <a href="http://claysql.blogspot.com/2009/02/send-database-mail-from-trigger.html">Clay McDonald has a nice blog-post</a> on how to make SQL-triggers send mail on, for instance, inserts into a table using Database Mail. You could of course have it send mail on deletions as well. In my mind, this might come in handy in user-databases in CRM- or HR-systems. Every time an employee gets deleted from the database, the HR-admin could receive a notification.</li>
	<li><strong>Do you need the SQL Agent?</strong>
Perhaps not. Maybe you feel comfortable with scheduling your database backups using the windows scheduler and homebrew scripts. Just make sure your monitoring software (or IT-personnel) discover when the script fails. An increasing amount of applications require the SQL Agent to schedule and monitor recurring tasks, like Microsoft's App-V. Without the SQL Agent, the databases would grow ad infinitum. How about index maintenance? This is also possible to go by using your own scripts and the windows scheduler. SQL Express can do most maintenance tasks you would need using scripts and T-SQL. The SQL Agent just makes it simpler and more manageable. Once again, double-check this with the application developer.</li>
	<li><strong>Do you application use SSIS/DTS-jobs?</strong>
This is not included in SQL Express. Maybe there’s a work-around, but I haven’t found it and I doubt it is supported by anyone.</li>
	<li><strong>Do you need to be able to troubleshoot performance problems?</strong>
You can do this on SQL Express with a great deal of knowledge and timers. The SQL-profiler, the Performance Data Collection and the Database Tuning Advisor makes it easier. Specifically, the SQL-profiler comes in really handy when you suspect the application (not the system) to be the bad guy since you can trace the queries and pin-point where the performance-hit resides. Using the SQL-profiler I have been able to optimise indexes to and thus making database servers go from a 98% CPU Load to 3% CPU Load. I have also been able to pin-point specific queries and use them as “evidence” that the problem is bad/sloppy code rather than problems with the database server. Also, using the SQL-profiler.</li>
</ol>
There’s more, of course, but these point are the most common pit-falls in my experience. As you can see, there’s three “do you need”-questions  and there are highly optional. Far from everyone use them and often because of lacking SQL Server knowledge. You don’t know what you can do. Still, the most important question is #1. Is SQL Express a supported database server for your applications. Hopefully, the developer knows the answer to this directly. No maybe’s. Yes or No.

Personally, I find that If you need a database server for production data, don’t go for SQL Express. Many customers have gone that way because “it’s free!” just to find themselves in the midst of a SQL Server upgrade and database migration a year later.]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>195</wp:post_id>
		<wp:post_date>2009-08-21 10:38:55</wp:post_date>
		<wp:post_date_gmt>2009-08-21 09:38:55</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>whynotusesqlexpress-itsforfree</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="checklist"><![CDATA[Checklist]]></category>
		<category domain="category" nicename="sql2008"><![CDATA[SQL 2008]]></category>
		<category domain="post_tag" nicename="sql-express-2005"><![CDATA[SQL Express 2005]]></category>
		<category domain="post_tag" nicename="sql-express-2008"><![CDATA[SQL Express 2008]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>jd_tweet_this</wp:meta_key>
			<wp:meta_value><![CDATA[yes]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>wp_jd_clig</wp:meta_key>
			<wp:meta_value><![CDATA[http://cli.gs/0vPV0]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>The TCP Port Check: Use with caution!</title>
		<link>http://www.teknoglot.se/ms/opsmgr2007/tcp-port-check-use-with-caution/</link>
		<pubDate>Thu, 27 Aug 2009 13:39:43 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/?p=202</guid>
		<description></description>
		<content:encoded><![CDATA[Just wanted to raise a word of caution about the TCP Port Check in Operations Manager 2007.

Some customers have notices the the system-logs on some Unix machines are completely swamped with "connection error", "TCP Connect failed", "TCP Session Lost" and similar and after a bit och research the problematic servers were narrowed down to those monitored by Operations Manager. Specifically, those who are targeted by a TCP Port Check.

It would seem like the TCP-connection never fully initializes on the target server. Kind of like knocking on your neighbours door and then hiding. Then when the door opens, no one is there.

Maybe there's a setting somewhere to modify how "deep" a Port Check should go before closing. Perhaps fully initializing and then sending a proper "Close" instead of just cutting the connection. In a few extreme cases we have noticed that the target server even goes so far as to start a session, but never ending it since there's no closure and finally having no sessions to spare for the real users. But on most servers it's just an annoyance since the "real" errors is very hard to be found in all the connection related logs.

Anyway. Just a good thing to keep in mind when running TCP Port Checks from Operations Manager 2007. Keep an eye on the logs when implementing the port checks.]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>202</wp:post_id>
		<wp:post_date>2009-08-27 14:39:43</wp:post_date>
		<wp:post_date_gmt>2009-08-27 13:39:43</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>tcp-port-check-use-with-caution</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="errors"><![CDATA[Errors]]></category>
		<category domain="post_tag" nicename="opsmgr"><![CDATA[OpsMgr]]></category>
		<category domain="category" nicename="opsmgr2007"><![CDATA[OpsMgr 2007]]></category>
		<category domain="post_tag" nicename="unix"><![CDATA[Unix]]></category>
		<wp:postmeta>
			<wp:meta_key>jd_tweet_this</wp:meta_key>
			<wp:meta_value><![CDATA[yes]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>wp_jd_clig</wp:meta_key>
			<wp:meta_value><![CDATA[http://cli.gs/TYMBy]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_wp_old_slug</wp:meta_key>
			<wp:meta_value><![CDATA[the-tcp-port-check-use-with-caution]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Replace/Change a Gateway Server</title>
		<link>http://www.teknoglot.se/ms/opsmgr2007/replacechange-a-gateway-server/</link>
		<pubDate>Thu, 24 Sep 2009 11:32:35 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/?p=207</guid>
		<description></description>
		<content:encoded><![CDATA[If you are looking into replacing an (or just switching to another primary) Operations Manager 2007 Gateway Server for any reason, there's a little more to consider than just right-clicking the clients and selecting "Change Primary Management Server" in the Operations Console.
You could end up with agents not being able to connect to the Management Group at all due to a small problem with the order in which Operations Manager do things.

Here's basically what happens:
<ul>
	<li>You tell Operations Manager to change Primary Management Server for AGENTX from GW1 to GW2.</li>
	<li>The SDK Service (i guess) tells GW1 that "You're no longer the Primary Management Server for AGENTX"</li>
	<li>GW1 acknowledges this and stops talking to AGENTX.  And I mean <em>Completely</em> stops talking to AGENTX.</li>
	<li>OpsMgr then tells GW2 to start accepting communication from AGENTX.</li>
	<li>OpsMgr tries to tell AGENTX that it should talk to GW2 since GW1 won't listen.</li>
</ul>
Spotted the problem?
This modus operandi probably works when agents are on the same network and in the same domain where fail-over is sort of automatic.  The problem we are facing now is that the server are telling the Gateway to stop accepting communications to and from the agent <em>before</em> the agent is notified that there is a new Gateway server to talk to. The agent will continue to talk to GW1 but will be completely ignored and you will probably start seeing events in the Operations Manager eventlog on GW1 with EventID 20000.

How do I get around this little <em>feature</em> then?

No matter if you found this article after running into the mentioned troubles or if you are googling ahead of time to be prepared, the fix is the same and consists of a few powershell scripts. These scripts are <a title="System Center Central" href="http://www.systemcentercentral.com/Forums/tabid/60/IndexID/19305/Default.aspx#vwcComments19305">out there</a> allready, but in different contexts, hence this post.
<h3>First step:  Install the new Gateway</h3>
<a title="Deploying Gateway Server in the Multiple Server, Single Management Group Scenario" href="http://technet.microsoft.com/en-us/library/bb432149.aspx">Documentation on this</a> from Microsoft is good enough, but here's the short version.
<ol>
	<li>Verify name resolution to and from Gateway server and Management Server</li>
	<li><a title="Authentication and Data Encryption for Windows Computers in Operations Manager 2007" href="http://technet.microsoft.com/en-us/library/bb735408.aspx">Create certificate</a> for the Gateway server</li>
	<li>Approve the Gateway server</li>
	<li>Install Gateway server</li>
	<li>Import certificates on Windows system</li>
	<li>Run MOMCertImport.exe on Gateway server to add the certificate into Gateway server configuration</li>
	<li>Wait</li>
</ol>
The wait is for the gateway server to get all needed configuration from RMS and to download all neccesary management packs, run all the discovery scripts and so on. When the Operations Manager event log has calmed down a bit, move to step two.
<h3>Second step: Configure Agent Failover</h3>
Connect to an Operations Manager Command Shell. Any will do, as long as it's connected to the correct Management Group.
Then run the following script:

[ps]
$primaryGW= Get-ManagementServer | where {$_.Name -eq 'GW2.domain.local'}
$failoverGw = Get-ManagementServer | where {$_.Name -eq 'GW1.domain.local'}
$agents = Get-Agent | where {$_.primarymanagementservername -eq 'GW1.domain.local'}
Set-ManagementServer -AgentManagedComputer: $agents -PrimaryManagementServer: $primaryGW -FailoverServer: $failoverGw
[/ps]

Remember to change "GW1.domain.local" to you OLD Gateway servername and "GW2.domain.local" to your NEW Gateway servername.
If you don't know powershell, this script basically configures all agents using the old Gateway to use the new one as primare, but keep the old one as a fail-over server. The Gateways will still get to know the changes before the agents, but since the old on is still listening to the agents (though, as the fail-over host) it will be able to tell them to go to the new one, GW2.]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>207</wp:post_id>
		<wp:post_date>2009-09-24 12:32:35</wp:post_date>
		<wp:post_date_gmt>2009-09-24 11:32:35</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>replacechange-a-gateway-server</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="how-to"><![CDATA[How-To]]></category>
		<category domain="post_tag" nicename="opsmgr"><![CDATA[OpsMgr]]></category>
		<category domain="category" nicename="opsmgr2007"><![CDATA[OpsMgr 2007]]></category>
		<category domain="category" nicename="powershell"><![CDATA[PowerShell]]></category>
		<category domain="post_tag" nicename="powershell"><![CDATA[PowerShell]]></category>
		<category domain="post_tag" nicename="script"><![CDATA[Script]]></category>
		<wp:postmeta>
			<wp:meta_key>jd_tweet_this</wp:meta_key>
			<wp:meta_value><![CDATA[yes]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>jd_twitter</wp:meta_key>
			<wp:meta_value><![CDATA[New post: #title# (#url#)]]></wp:meta_value>
		</wp:postmeta>
		<wp:comment>
			<wp:comment_id>11</wp:comment_id>
			<wp:comment_author><![CDATA[[ Teknoglot ] &raquo; Change Gateway Powershell Script]]></wp:comment_author>
			<wp:comment_author_email></wp:comment_author_email>
			<wp:comment_author_url>http://teknoglot.hartati.se/ms/opsmgr2007/change-gateway-powershell-script/</wp:comment_author_url>
			<wp:comment_author_IP>208.43.64.53</wp:comment_author_IP>
			<wp:comment_date>2010-03-31 15:30:58</wp:comment_date>
			<wp:comment_date_gmt>2010-03-31 14:30:58</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[[...] This script has pretty much already been covered in my previous post about Changing or Replacing an Operations Manager Gateway Server. [...] ]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type>pingback</wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
	</item>
	<item>
		<title>My impression of EXT4 -- WTH!?</title>
		<link>http://www.teknoglot.se/linux/my-impression-of-ext4-wth/</link>
		<pubDate>Thu, 17 Sep 2009 18:43:47 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/?p=209</guid>
		<description></description>
		<content:encoded><![CDATA[Ok, so I reinstalled my linux partition with Ubuntu 9.04 x64 and decided to try EXT4 on the root partition. Like, yesterday.
Managed to get the Citrix client running (way more easy on Ubuntu than Fedora, I'll be back on that) and all without too much fuzz.

First reboot gave me a "let's FSCK!". So I FSCK-ed and booted up to the desktop.

Second reboot gave me a "let's FSCK!". And I did. Booted to the desktop.

Third boot went smoothly, but all of a sudden all the icons decided to go AWOL. Rebooted again.

Fourth boot gave me a "let's FSCK!". I replied with "Well FSCK You!"

Fifth boot gave me a "let's FSCK!". I rebooted back to Windows 7.

Tonight I am reinstalling Ubuntu 9.04 x64 with EXT3.]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>209</wp:post_id>
		<wp:post_date>2009-09-17 19:43:47</wp:post_date>
		<wp:post_date_gmt>2009-09-17 18:43:47</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>my-impression-of-ext4-wth</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="linux"><![CDATA[Linux]]></category>
		<category domain="post_tag" nicename="linux"><![CDATA[Linux]]></category>
		<category domain="post_tag" nicename="rant"><![CDATA[Rant]]></category>
		<wp:postmeta>
			<wp:meta_key>jd_tweet_this</wp:meta_key>
			<wp:meta_value><![CDATA[yes]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>wp_jd_clig</wp:meta_key>
			<wp:meta_value><![CDATA[http://cli.gs/MV3rm]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>SQL ManagementPack Survey &#8211; Make your voice heard</title>
		<link>http://www.teknoglot.se/ms/opsmgr2007/sql-managementpack-survey-make-your-voice-heard/</link>
		<pubDate>Wed, 07 Oct 2009 13:24:37 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/ms/opsmgr2007/sql-managementpack-survey-make-your-voice-heard/</guid>
		<description></description>
		<content:encoded><![CDATA[<p>According to the <a href="http://blogs.technet.com/momteam/archive/2009/09/25/sql-management-pack-survey-live-on-connect.aspx">OpsMgr Team blog</a>, Microsoft wants to know what you think about their SQL Server MP. It’s really hard to come by a better opportunity to express your feelings and desires about monitoring SQL Server, so don’t miss this one out.</p>  <p><a title="http://blogs.technet.com/momteam/archive/2009/09/25/sql-management-pack-survey-live-on-connect.aspx" href="http://blogs.technet.com/momteam/archive/2009/09/25/sql-management-pack-survey-live-on-connect.aspx">http://blogs.technet.com/momteam/archive/2009/09/25/sql-management-pack-survey-live-on-connect.aspx</a></p>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>224</wp:post_id>
		<wp:post_date>2009-10-07 14:24:37</wp:post_date>
		<wp:post_date_gmt>2009-10-07 13:24:37</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>sql-managementpack-survey-make-your-voice-heard</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="management-pack"><![CDATA[Management Pack]]></category>
		<category domain="category" nicename="opsmgr2007"><![CDATA[OpsMgr 2007]]></category>
		<category domain="post_tag" nicename="sql-server"><![CDATA[SQL Server]]></category>
		<wp:postmeta>
			<wp:meta_key>jd_tweet_this</wp:meta_key>
			<wp:meta_value><![CDATA[yes]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>wp_jd_target</wp:meta_key>
			<wp:meta_value><![CDATA[http://teknoglot.hartati.se/ms/opsmgr2007/sql-managementpack-survey-make-your-voice-heard/]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>wp_jd_clig</wp:meta_key>
			<wp:meta_value><![CDATA[http://cli.gs/EHpTL]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Updated: Operations Manager 2007 R2 Management Pack</title>
		<link>http://www.teknoglot.se/ms/opsmgr2007/updated-operations-manager-2007-r2-management-pack/</link>
		<pubDate>Wed, 14 Oct 2009 10:29:00 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/ms/opsmgr2007/updated-operations-manager-2007-r2-management-pack/</guid>
		<description></description>
		<content:encoded><![CDATA[<p>Microsoft released an updated <acronym title="Management Pack">MP</acronym> (v6.1.7533.0, released on 10/8/2009) for monitoring the health the Operations Manager components.</p>  <p>Most significant updates, according to me, would seem to be:</p>  <blockquote>   <p>Fixed an issue that was previously preventing all rules related to agentless exception monitoring from generating alerts.</p> </blockquote>  <blockquote>   <p>Added the rule “Collects Opsmgr <acronym title="Software Development Kit">SDK</acronym> Service\Client Connections” to collect the number of connected clients for a given management group. This data is shown in the view “Console and SDK Connection Count” under the folder “Operations Manager\Management Server Performance”.</p> </blockquote>  <blockquote>   <p>Updated a number of monitors and rules to ensure that data is reported to the correct management group for multihomed agents.</p> </blockquote>  <blockquote>   <p>Fixed the configuration of the rule “IIS Discovery Probe Module Execution Failure” to so that the parameter replacement will now work correctly for alert suppression and generating the details of the alert’s description.</p> </blockquote>  <p>The rest is mostly polishing, fine-tuning and complementary updates. Nothing really ground-breaking here, but still a welcome update.</p>  <p>Download at: <a title="http://www.microsoft.com/downloads/details.aspx?FamilyID=61365290-3c38-4004-b717-e90bb0f6c148" href="http://www.microsoft.com/downloads/details.aspx?FamilyID=61365290-3c38-4004-b717-e90bb0f6c148">http://www.microsoft.com/downloads/details.aspx?FamilyID=61365290-3c38-4004-b717-e90bb0f6c148</a></p>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>225</wp:post_id>
		<wp:post_date>2009-10-14 11:29:00</wp:post_date>
		<wp:post_date_gmt>2009-10-14 10:29:00</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>updated-operations-manager-2007-r2-management-pack</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="management-pack"><![CDATA[Management Pack]]></category>
		<category domain="post_tag" nicename="opsmgr"><![CDATA[OpsMgr]]></category>
		<category domain="category" nicename="opsmgr2007"><![CDATA[OpsMgr 2007]]></category>
		<wp:postmeta>
			<wp:meta_key>syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Let&#039;s split!</title>
		<link>http://www.teknoglot.se/tb/lets_split/</link>
		<pubDate>Thu, 16 Apr 2009 08:27:06 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/?p=1</guid>
		<description></description>
		<content:encoded><![CDATA[Now would you look at that.

Since my old site, Tranquillity.se, got messy and unfocused I have now started a new one. That's right, you're looking at it.

Instead of blogging about mostly anything like I did before I have decided to split it into Three sites. This one for the Technical stuff, some other site I haven't set up yet, and a personal blogg for the... personal blogging... stuff.

When time gives, I will import the old tech-related posts from Tranquillity.se into this site but for now. Nothing yet so far.

Have a nice day!]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>381</wp:post_id>
		<wp:post_date>2009-04-16 03:27:06</wp:post_date>
		<wp:post_date_gmt>2009-04-16 08:27:06</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>lets_split</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="tb"><![CDATA[Technobabble]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_wp_old_slug</wp:meta_key>
			<wp:meta_value><![CDATA[hello-world]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_wp_old_slug</wp:meta_key>
			<wp:meta_value><![CDATA[lets_spli]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Cannot Delete Files with Long Paths?</title>
		<link>http://www.teknoglot.se/ms/cannot-delete-files-with-long-paths/</link>
		<pubDate>Wed, 21 Oct 2009 08:39:17 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/?p=171</guid>
		<description></description>
		<content:encoded><![CDATA[What do you do when you cannot delete a file or folder on a windows server?

Check the file permissions! And if that doesn’t help?

Check the share permissions! Yes, if it is a shared folder. And if that doesn’t help?

Check the file ownership! Great! But then what?

Well, the file could be in use, and then you would have to shut the locking process down and perhaps kick a user out. In a really bad scenario it could also be a symptom of a broken filesystem, a reserved filename (like “lpt1” or “PRN”) or even an invalid name (silly things like a space in the beginning or the end of a filename).
Another possible reason could actually be that the path to the file or folder is too long. You won’t actually get an error telling you that the filepath exceeds the 255 characters Windows can handle but a simple “Acces Denied”.

There are some, more or less tedious, work-arounds for the problem. Like renaming, starting from the root, all the directories to shorter ones or using the old DOS (8.3, like “dokume~1.doc”) names that windows can auto-generate for you. Personally, I have two favourite ways of handling this.
<ol>
	<li>Map the parent-directory of the file/folder you are trying to access/delete as a network drive and access your files that way.
This is particularly useful if the folder you are trying to access a <acronym title="Distributed File System">DFS</acronym>-share or perhaps a share on the central fileserver filepaths like “\\servername01\Central Projects\Central Services\IT Department\Develop Methods for Automatically Deploying New Central Servers\2.2.1 Auto-Deploying SQL-Server 2005 Cluster\Documents\Preparations\Whitepapers\SQL Server 2005 Failover Clustering White Paper.doc”</li>
	<li>Create a new share to a folder further down the hierarchy. This works locally too if you are logged on to, say, SRV01, you create a new share on “D:\Fileshares\Central Projects\Central Services\IT Department\Develop Methods for Automatically Deploying New Central Servers\” called “Autodeploymethods” and access it from “\\SRV01\Autodeploymethods\”. That way the filepath doesn’t exceed 255 characters.</li>
</ol>
Now. When designing fileservers, you really should think about how deep the filepaths may get. This is especially true on DFS-shares since you might have to deal with the full <acronym title="Fully Qualified Domain Name">FQDN</acronym> too, and not only the actual folder structure. Many big corporations I know uses “codes” for departments and assign a project ID (quite simply a number or maybe an abbreviation) to each project and uses theese for the fileshares too. Another scenario that could lead to similar problems are intranet sites where users can create and manage their own subsites and where filenames and folders are not stored in a database.

I have only seen this phenomena on Windows systems so far, and I’ve actually used a linux Live-CD on occasion when admin access is denied.
<blockquote>Read More:
<a href="http://support.microsoft.com/kb/320081">http://support.microsoft.com/kb/320081</a></blockquote>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>171</wp:post_id>
		<wp:post_date>2009-10-21 09:39:17</wp:post_date>
		<wp:post_date_gmt>2009-10-21 08:39:17</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>cannot-delete-files-with-long-paths</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="errors"><![CDATA[Errors]]></category>
		<category domain="post_tag" nicename="kb"><![CDATA[KB]]></category>
		<category domain="category" nicename="ms"><![CDATA[Microsoft]]></category>
		<category domain="post_tag" nicename="windows"><![CDATA[Windows]]></category>
		<category domain="category" nicename="win2008"><![CDATA[Windows 2008]]></category>
		<category domain="category" nicename="vista"><![CDATA[Windows Vista]]></category>
		<category domain="category" nicename="winxp"><![CDATA[Windows XP]]></category>
		<wp:postmeta>
			<wp:meta_key>jd_tweet_this</wp:meta_key>
			<wp:meta_value><![CDATA[yes]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Health Rollup not working in Exchange Management Pack</title>
		<link>http://www.teknoglot.se/ms/opsmgr2007/health-rollup-not-working-in-exchange-management-pack/</link>
		<pubDate>Wed, 14 Oct 2009 11:17:08 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/ms/opsmgr2007/health-rollup-not-working-in-exchange-management-pack/</guid>
		<description></description>
		<content:encoded><![CDATA[<p>I’ve wrestled a bit with a critical status on one of the Organization States at a clients site that wont go back to green despite all the underlying monitors have gone back to green. And apparently I am not alone on this one. Others, like me, has read and re-read the MP-guide i search for a monitor/rule/discovery for overrides forgotten, and I don’t know how many times I’ve made a small change and tried resetting the health once again. Anyhow.   <br /><a href="http://social.technet.microsoft.com/Profile/en-US/?user=Marius%20Sutara&amp;referrer=http%3a%2f%2fsocial.technet.microsoft.com%2fForums%2fen-US%2foperationsmanagergeneral%2fthread%2f6ad11b81-3304-40db-ae47-0f36add6e1e1&amp;rh=EQRzBI2S0js0uB72HghHQFW%2bBWkNhiVEQ9pGFs3h9c0%3d&amp;sp=forums">Marius Sutara</a> posted an <a href="http://social.technet.microsoft.com/Forums/en-US/operationsmanagergeneral/thread/6ad11b81-3304-40db-ae47-0f36add6e1e1">answer on TechNet forums</a> last week with a “fix” (-ish), or rather the acknowledgement that the problem is not a <acronym title="AKA. Human Error, 40cm from the screen">40c</acronym>. The problem might be related to other MP as well, but I’ve only seen it on the new Exchange MP so far. In that same post, Pete Zerger provided some links to two nifty little tools that will help you reset the health of the monitor.</p>  <p>In case you wonder why on earth I post when there’s allready a “solution” out there; Pagerank, baby!   <br />Not for me, but for the forum post making it show up earlier on google.</p>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>227</wp:post_id>
		<wp:post_date>2009-10-14 12:17:08</wp:post_date>
		<wp:post_date_gmt>2009-10-14 11:17:08</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>health-rollup-not-working-in-exchange-management-pack</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="errors"><![CDATA[Errors]]></category>
		<category domain="post_tag" nicename="exchange"><![CDATA[Exchange]]></category>
		<category domain="post_tag" nicename="management-pack"><![CDATA[Management Pack]]></category>
		<category domain="category" nicename="opsmgr2007"><![CDATA[OpsMgr 2007]]></category>
		<category domain="post_tag" nicename="technet"><![CDATA[TechNet]]></category>
		<wp:postmeta>
			<wp:meta_key>syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Microsoft Adds support for SUSE 11 in OpsMgr R2</title>
		<link>http://www.teknoglot.se/ms/opsmgr2007/microsoft-adds-support-for-suse-11-in-opsmgr-r2/</link>
		<pubDate>Fri, 16 Oct 2009 06:59:10 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/ms/opsmgr2007/microsoft-adds-support-for-suse-11-in-opsmgr-r2/</guid>
		<description></description>
		<content:encoded><![CDATA[<p>This update hasn’t showed up in the <acronym title="Management Pack">MP</acronym> Catalog yet, but the <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=4a41a8be-0a37-4bd2-b5b1-026468b317fb">System Center Operations Manager 2007 R2 Cross Platform Update can be downloaded here</a>.</p>  <p>Besides SUSE 11 support, here’s the short overview.</p>  <blockquote>   <p>The System Center Operations Manager 2007 R2 Cross Platform Update adds fixes for a defunct process issue on Unix/Linux Servers, as well as, adds support for SUSE Linux Enterprise Server 11 (both 32-bit and 64-bit versions) and Solaris Zone support.      <br /><b>Feature Summary:</b>       <br />The System Center Operations Manager 2007 R2 Cross Platform Update supports the monitoring of Unix/Linux Servers including: </p>    <ul>     <li>Monitoring of SUSE Linux Enterprise Server 11 servers (both 32-bit and 64-bit versions) </li>      <li>Support of Solaris Zones </li>      <li>Fix for defunct Process issue </li>      <li>The Cross Platform Agent may not discover soft partitions on Solaris systems. Therefore, the disk provider may be unloaded, and the Cross Platform Agent may stop collecting information from the system disks. </li>      <li>The Cross Platform Agent may not restart after the AIX server reboots. </li>   </ul>    <p>     <br />The latest versions of all the Operations Manager 2007 R2 Unix/Linux agents are included in this update.</p> </blockquote>  <p>Perfect timing, I must say, since I really need this today. :D</p>  <p><em><strong>Update:</strong></em>    <br />This is no small MP-update, which probably is the reason that we do not find it in the MP Catalog, but a ~250MB OpsMgr R2 Software Update. You need to run this on all Operations Manager Servers (RMS/MS, GW?) since it actually updates many of the agent Cross Platform binaries. It does add a new MP för SUSE 11 that you have to import from disk if you need it.</p>  <p>So, the installation goes somewhat like this:</p>  <ol>   <li>Install the Software Update (pick the right Architecture) on all OpsMgr R2 Servers</li>    <li>Import the SUSE 11 MP if necessary</li>    <li>Re-discover your Unix/Linux machines.</li> </ol>  <p>Files updated in this update for R2:</p>  <ul>   <li>.\Microsoft.Enterprisemanagement.UI.Administration.dll (Version 6.1.7043.1)</li>    <li>.\AgentManagement\UnixAgents\scx-1.0.4-248.aix.5.ppc.lpp.gz</li>    <li>.\AgentManagement\UnixAgents\scx-1.0.4-248.aix.6.ppc.lpp.gz</li>    <li>.\AgentManagement\UnixAgents\scx-1.0.4-248.hpux.11iv2.ia64.depot.Z</li>    <li>.\AgentManagement\UnixAgents\scx-1.0.4-248.hpux.11iv2.parisc.depot.Z</li>    <li>.\AgentManagement\UnixAgents\scx-1.0.4-248.hpux.11iv3.ia64.depot.Z</li>    <li>.\AgentManagement\UnixAgents\scx-1.0.4-248.hpux.11iv3.parisc.depot.Z</li>    <li>.\AgentManagement\UnixAgents\scx-1.0.4-248.rhel.4.x64.rpm</li>    <li>.\AgentManagement\UnixAgents\scx-1.0.4-248.rhel.4.x86.rpm</li>    <li>.\AgentManagement\UnixAgents\scx-1.0.4-248.rhel.5.x64.rpm</li>    <li>.\AgentManagement\UnixAgents\scx-1.0.4-248.rhel.5.x86.rpm</li>    <li>.\AgentManagement\UnixAgents\scx-1.0.4-248.sles.10.x64.rpm</li>    <li>.\AgentManagement\UnixAgents\scx-1.0.4-248.sles.10.x86.rpm</li>    <li>.\AgentManagement\UnixAgents\scx-1.0.4-248.sles.9.x86.rpm</li>    <li>.\AgentManagement\UnixAgents\scx-1.0.4-248.solaris.10.sparc.pkg.Z</li>    <li>.\AgentManagement\UnixAgents\scx-1.0.4-248.solaris.10.x86.pkg.Z</li>    <li>.\AgentManagement\UnixAgents\scx-1.0.4-248.solaris.8.sparc.pkg.Z</li>    <li>.\AgentManagement\UnixAgents\scx-1.0.4-248.solaris.9.sparc.pkg.Z</li> </ul>  <p>Files added:</p>  <ul>   <li>Microsoft.Linux.SLES.11.MP</li> </ul>  <p>All in all, the update contains the following fixes:</p>  <ul>   <li>KB969342</li>    <li>KB973583</li>    <li>Q954049</li>    <li>Q956240</li> </ul>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>228</wp:post_id>
		<wp:post_date>2009-10-16 07:59:10</wp:post_date>
		<wp:post_date_gmt>2009-10-16 06:59:10</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>microsoft-adds-support-for-suse-11-in-opsmgr-r2</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="management-pack"><![CDATA[Management Pack]]></category>
		<category domain="post_tag" nicename="opsmgr"><![CDATA[OpsMgr]]></category>
		<category domain="category" nicename="opsmgr2007"><![CDATA[OpsMgr 2007]]></category>
		<category domain="post_tag" nicename="suse-11"><![CDATA[SUSE 11]]></category>
		<category domain="post_tag" nicename="x-plat"><![CDATA[X-Plat]]></category>
		<wp:postmeta>
			<wp:meta_key>syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Installing SQL Reporting Services 2005 on Windows 2008 x64</title>
		<link>http://www.teknoglot.se/ms/sql2005/installing-sql-reporting-services-2005-on-windows-2008-x64/</link>
		<pubDate>Mon, 02 Nov 2009 13:33:27 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/ms/opsmgr2007/installing-sql-reporting-services-2005-on-windows-2008-x64/</guid>
		<description></description>
		<content:encoded><![CDATA[<p>Let’s say you have followed this guide: <a title="http://support.microsoft.com/kb/938245/" href="http://support.microsoft.com/kb/938245/">http://support.microsoft.com/kb/938245/</a></p>  <p>Still not working? The one thing I forgot, or rather did not find in any of the guides, was to change the website application pool to “Classic .NET AppPool”. It is actually noted in <a href="http://support.microsoft.com/kb/938245/">KB938245</a> but only after the installation, during the configuration. For some reason I have not been able to install Reporting Services 2005 on Windows 2008 without changing this prior to the installation.</p>  <p>Maybe I am doing it wrong but this seems to be working all right for me.</p>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>232</wp:post_id>
		<wp:post_date>2009-11-02 14:33:27</wp:post_date>
		<wp:post_date_gmt>2009-11-02 13:33:27</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>installing-sql-reporting-services-2005-on-windows-2008-x64</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="how-to"><![CDATA[How-To]]></category>
		<category domain="post_tag" nicename="iis7"><![CDATA[IIS7]]></category>
		<category domain="category" nicename="opsmgr2007"><![CDATA[OpsMgr 2007]]></category>
		<category domain="post_tag" nicename="reporting-services"><![CDATA[Reporting Services]]></category>
		<category domain="category" nicename="sql2005"><![CDATA[SQL 2005]]></category>
		<category domain="category" nicename="sql2008"><![CDATA[SQL 2008]]></category>
		<category domain="post_tag" nicename="x64"><![CDATA[x64]]></category>
		<wp:postmeta>
			<wp:meta_key>_syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Updated: MP for System Center Configurations Manager 2007 SP2 on x64</title>
		<link>http://www.teknoglot.se/ms/opsmgr2007/updated-mp-for-system-center-configurations-manager-2007-sp2-on-x64/</link>
		<pubDate>Tue, 03 Nov 2009 11:13:00 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/ms/opsmgr2007/updated-mp-for-system-center-configurations-manager-2007-sp2-on-x64/</guid>
		<description></description>
		<content:encoded><![CDATA[<p>Microsoft has released an updated <acronym title="Management Pack">MP</acronym> for <acronym title="System Center Configurations Manager">SCCM </acronym>SP2 (v6.0.6000.2, released on 10/28/2009) for OpsMgr R2.</p>  <p>The update basically contains support for x64 that was missin in the previous release.</p>  <blockquote>   <p>The Configuration Manager 2007 SP2 Management Pack adds support for monitoring Configuration Manager 2007 SP2 in a 64-bit environment with Operations Manager 2007 R2 or Operations Manager 2007 SP1 with hotfix (KB971541) installed. This enables the Configuration Manager 2007 SP2 Management Pack to work with either the 32-bit or the 64-bit Operations Manager 2007 agent. <font color="#800000">Except for the 64-bit support, the other features and guidance for Configuration Manager 2007 Management Packs remain intact</font>.</p> </blockquote>  <p><font size="1">(coloration added by me)</font></p>  <p>Read more and download here:    <br /><a title="http://www.microsoft.com/downloads/details.aspx?FamilyID=a8443173-46c2-4581-b3b8-ce67160f627b" href="http://www.microsoft.com/downloads/details.aspx?FamilyID=a8443173-46c2-4581-b3b8-ce67160f627b">http://www.microsoft.com/downloads/details.aspx?FamilyID=a8443173-46c2-4581-b3b8-ce67160f627b</a></p>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>233</wp:post_id>
		<wp:post_date>2009-11-03 12:13:00</wp:post_date>
		<wp:post_date_gmt>2009-11-03 11:13:00</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>updated-mp-for-system-center-configurations-manager-2007-sp2-on-x64</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="management-pack"><![CDATA[Management Pack]]></category>
		<category domain="post_tag" nicename="opsmgr"><![CDATA[OpsMgr]]></category>
		<category domain="category" nicename="opsmgr2007"><![CDATA[OpsMgr 2007]]></category>
		<category domain="post_tag" nicename="x64"><![CDATA[x64]]></category>
		<wp:postmeta>
			<wp:meta_key>syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>(re)Gain sysadmin access to SQL2005 or SQL2008</title>
		<link>http://www.teknoglot.se/ms/sql2005/regain-sysadmin-access-to-sql2005-or-sql2008/</link>
		<pubDate>Thu, 19 Nov 2009 13:08:10 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/?p=239</guid>
		<description></description>
		<content:encoded><![CDATA[In SQL Server 2005 and 2008 the local Administrators account is not sysadmin by default. This makes it even more important that the one setting up the Database also remembers to add a SQL Server admins group to the sysamin role. If this step is forgotten, the user installing the database server is the only one that will ever be sysadmin.

In some extreme cases I’ve seen situations where no one except some dude on vacation is sysadmin and there’s a bunch of applications that needs to be installed/upgraded. In these cases I have also been assigned Local Administrator rights on the server, but since the local Administrators group isn’t sysadmin either I still cannot login to the SQL server.
What to do!?

Thanks to <a href="http://blogs.msdn.com/raulga/archive/2007/07/12/disaster-recovery-what-to-do-when-the-sa-account-password-is-lost-in-sql-server-2005.aspx">Raul Carcia’s blog post</a> it’s not that a big deal. The instructions is written for SQL Server 2005, but works equally fine on SQL Server 2008 and the only requirement is that you are a local server administrator.
Here’s what to do:
<ol>
	<li>Open the <em>SQL Server Configuration Manager.</em></li>
	<li>In <em>SQL Server Services</em>, open the properties for the SQL Server instance you need access to.</li>
	<li>In the <em>Advanced</em> tab, locate <em>Startup Parameters</em>.</li>
	<li>Add “;-m” to the end of that line.</li>
	<li>Press OK and restart the SQL Server into “Maintenance Mode” or “Single User Mode” if you like. (check that a restart is OK first ;))</li>
	<li>Open a command prompt (right-click, “Run as Administrator” in Windows 2008) and go to C:\Program Files\Microsoft SQL Server\100\Tools\Binn\
<span style="font-size: xx-small;">(C:\Program Files\Microsoft SQL Server\90\Tools\Binn\ for SQL2005</span>)</li>
	<li>Execute [plain]sqlcmd /A /E /S&amp;lt;SERVER\INSTANCE&amp;gt;[/plain] (use . for local default instance and .\INSTANCE for local named instance)</li>
	<li>In the CLI, execute:
[plain]EXEC sp_addsrvrolemember 'DOMAIN\yourusername', 'sysadmin';
GO[/plain]</li>
	<li>Return to the <em>SQL Server Configuration Manager</em> and restore the <em>Startup Parameters</em> to it’s previous settings.</li>
	<li>Restart the SQL Server instance to allow users to access it again.</li>
</ol>
Now, you should be able to login to the SQL server with sysadmin rights using your current user. This would also be a good point in time to actually establish a SQL Server Admins group (local or domain) to add to the sysadmin role to avoid having others to the above steps when you, yourself, happens to be on vacation. ;)

As Raul Carcia point out in his original post, this is really a disaster recovery procedure and there’s definitely nothing sneaky about it since it leaves quite alot of trails in the event logs.

All in all, a Great article by <a href="http://blogs.msdn.com/raulga/">Raul</a> and all credit should go his way.]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>239</wp:post_id>
		<wp:post_date>2009-11-19 14:08:10</wp:post_date>
		<wp:post_date_gmt>2009-11-19 13:08:10</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>regain-sysadmin-access-to-sql2005-or-sql2008</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="how-to"><![CDATA[How-To]]></category>
		<category domain="category" nicename="opsmgr2007"><![CDATA[OpsMgr 2007]]></category>
		<category domain="category" nicename="sql2005"><![CDATA[SQL 2005]]></category>
		<category domain="category" nicename="sql2008"><![CDATA[SQL 2008]]></category>
		<category domain="post_tag" nicename="sql-server"><![CDATA[SQL Server]]></category>
		<category domain="post_tag" nicename="sql-server-2005"><![CDATA[SQL Server 2005]]></category>
		<category domain="post_tag" nicename="sql-server-2008"><![CDATA[SQL Server 2008]]></category>
		<wp:postmeta>
			<wp:meta_key>_syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:comment>
			<wp:comment_id>12</wp:comment_id>
			<wp:comment_author><![CDATA[Sam T]]></wp:comment_author>
			<wp:comment_author_email>samuel.tegenfeldt@hartati.se</wp:comment_author_email>
			<wp:comment_author_url>http://</wp:comment_author_url>
			<wp:comment_author_IP>192.176.230.1</wp:comment_author_IP>
			<wp:comment_date>2010-04-09 13:59:55</wp:comment_date>
			<wp:comment_date_gmt>2010-04-09 12:59:55</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[I have noticed that my blog changes some of the characters in the posted code. If the code doesn't work when copy-pasted, try writing it manually.]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>13</wp:comment_id>
			<wp:comment_author><![CDATA[Sam T]]></wp:comment_author>
			<wp:comment_author_email>samuel.tegenfeldt@hartati.se</wp:comment_author_email>
			<wp:comment_author_url>http://</wp:comment_author_url>
			<wp:comment_author_IP>192.176.230.1</wp:comment_author_IP>
			<wp:comment_date>2010-05-12 09:49:11</wp:comment_date>
			<wp:comment_date_gmt>2010-05-12 08:49:11</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[I updated the command so they are copy/pastable. I have also noticed that the sqlcmd command don't work on all servers, so I changed that too. :)]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
	</item>
	<item>
		<title>Linux Discovery &#8211; Not Enough Entropy</title>
		<link>http://www.teknoglot.se/linux/sles/linux-discovery-not-enough-entropy/</link>
		<pubDate>Wed, 02 Dec 2009 11:37:08 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/?p=243</guid>
		<description></description>
		<content:encoded><![CDATA[Here’s a little trouble-shooting guide for discovering Linux systems from OpsMgr R2 when getting the following error from the wizard:

[xml]&lt;stdout&gt;Generating certificate with hostname=&quot;COMPUTERNAME&quot;

[/home/serviceb/TfsCoreWrkSpcRedhat/source/code/tools/scx_ssl_config/scxsslcert.cpp:198]

Failed to allocate resource of type random data: Failed to get random data - not enough entropy

&lt;/stdout&gt;&lt;stderr&gt;error: %post(scx-1.0.4-248.i386) scriptlet failed, exit status 1

&lt;/stderr&gt;&lt;returnCode&gt;1&lt;/returnCode&gt;

&lt;DataItem type=&quot;Microsoft.SSH.SSHCommandData&quot; time=&quot;2009-08-05T11:15:01.5800358-04:00&quot; sourceHealthServiceId=&quot;0EB1D6DA-202C-7FC5-3D46-BDBB9208547D&quot;&gt;&lt;SSHCommandData&gt;&lt;stdout&gt;Generating certificate with hostname=&quot;COMPUTERNAME&quot;

[/home/serviceb/TfsCoreWrkSpcRedhat/source/code/tools/scx_ssl_config/scxsslcert.cpp:198]

Failed to allocate resource of type random data: Failed to get random data - not enough entropy

&lt;/stdout&gt;&lt;stderr&gt;error: %post(scx-1.0.4-248.i386) scriptlet failed, exit status 1

&lt;/stderr&gt;&lt;returnCode&gt;1&lt;/returnCode&gt;&lt;/SSHCommandData&gt;&lt;/DataItem&gt;

[/xml]

But first, a little background on the actual “problem”. To generate the certificate, the <em>entropy</em> needs to be high enough to generate random data for the certificate creation. Without the certificate, the OpsMgr agent won’t be able to open up communications with the <acronym title="Management Server">MS</acronym>. So, what creates this entropy we need? Bluntly put, a selection of hardware components that are likely to produce non-predictable data. Like a keyboard, mouse and a monitor or videocard. Of course, there’s a lot more to it, but we really don’t need to know this. What <em>we</em> need to know is that there has to be a “bit bucket” of more than 256bytes of entropy for the certificate creation process to succeed. We also need to know that more enterprise-ish servers, like rack- or blade-servers tend to be void of things like directly attached keyboards, mouses and monitors that the linux kernel needs to be able to generate entropy. And herein lies the problem. If you have a new server that is not in full service (likely since we are trying to deploy the monitoring on it) which means that there’s not much random data flowing through the hardware and there’s no keyboard or mouse or monitor connected to it there is quite the risk that the system entropy is going to be very low. Of the linux systems that I have been deploying OpsMgr agents to, about half have failed because of “Not enough entropy”. So, here’s the steps I usually takes to ensure that discovery works. I use <a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html">PuTTY</a> to connect to the soon-to-be-monitored servers. This guide also assumes that you have SU rights on the system since all of these steps (except #1) needs it.
<ol>
	<li>Check you current entropy
[plain]cat /proc/sys/kernel/random/entropy_avail[/plain]


Is it less than, or close to, 256? It probably is. If you don’t feel like connecting a mouse and start wiggling it around—not really feasible in a data center—and see if the entropy increases, you can generate your own random data.</li>
	<li>Generate you own random data.
Be advised that this forced entropy will not be as random as the system-created on and thus not as secure. How much more insecure it is, I don’t know, and quite frankly I prefer to have my systems monitored yet slightly less secure than not monitored at all. Anyway, you can force your own random data by running:
[plain]dd if=/dev/urandom of=~/.rnd bs=1 count=1024[/plain]


This creates a .rnd file with 1024B of random data that the certificate creation process will use instead of the system entropy if the file exists.</li>
	<li>Uninstall and re-discover
The first failed attempt of discovery will most likely leave a non-working agent installation that we have to remove. Otherwise we will just be stuck with an “Access Denied” error. Run:
[plain]rpm –e scx[/plain]


Now, try to discover the system again.</li>
	<li>Failed again?
Try generating the certificate manually by running:
[plain]/opt/microsoft/scx/bin/tools/scxsslconfig -f –v
/opt/microsoft/scx/bin/tools/scxadmin –restart[/plain]


Retry discovery again.</li>
	<li>Still fails?
Uninstall the agent once more as instructed in step 3.</li>
</ol>
Stese steps have solved my problems 100% on both SUSE and RedHat and hopefully they will help you too.

Interestingely enough, these problems seems to be connected to some changes in the 2.6 kernel and basically everything that uses SSL-ish certificates will be affected. Even though the symptoms may be a bit more subtle, like time-outs and disconnects. For “headless” servers like those I usually to administer where the random data tend to be much lower, there’s even specialised hardware whose sole purpose is to generate random data, like the <a href="http://www.entropykey.co.uk/">Entropy Key</a>. I have also been told that new servers is likely to be equipped with entropy chipsets to make sure that there’s chaos enough to avoid these new-found oddities.
<blockquote>Sources:
<a title="http://social.technet.microsoft.com/Forums/en-US/crossplatformsles/thread/f94ec905-23ac-4444-b9f8-644fec3ae357" href="http://social.technet.microsoft.com/Forums/en-US/crossplatformsles/thread/f94ec905-23ac-4444-b9f8-644fec3ae357">http://social.technet.microsoft.com/Forums/en-US/crossplatformsles/thread/f94ec905-23ac-4444-b9f8-644fec3ae357</a>

<a title="http://www.askrenzo.com/oracle/SCOM/SCOM_discovering_nodes.html" href="http://www.askrenzo.com/oracle/SCOM/SCOM_discovering_nodes.html">http://www.askrenzo.com/oracle/SCOM/SCOM_discovering_nodes.html
</a></blockquote>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>243</wp:post_id>
		<wp:post_date>2009-12-02 12:37:08</wp:post_date>
		<wp:post_date_gmt>2009-12-02 11:37:08</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>linux-discovery-not-enough-entropy</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="how-to"><![CDATA[How-To]]></category>
		<category domain="post_tag" nicename="linux"><![CDATA[Linux]]></category>
		<category domain="post_tag" nicename="opsmgr"><![CDATA[OpsMgr]]></category>
		<category domain="category" nicename="opsmgr2007"><![CDATA[OpsMgr 2007]]></category>
		<category domain="category" nicename="sles"><![CDATA[SLES]]></category>
		<category domain="post_tag" nicename="troubleshooting"><![CDATA[TroubleShooting]]></category>
		<category domain="post_tag" nicename="x-plat"><![CDATA[X-Plat]]></category>
		<wp:postmeta>
			<wp:meta_key>syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:comment>
			<wp:comment_id>14</wp:comment_id>
			<wp:comment_author><![CDATA[Sam T]]></wp:comment_author>
			<wp:comment_author_email>samuel.tegenfeldt@hartati.se</wp:comment_author_email>
			<wp:comment_author_url>http://</wp:comment_author_url>
			<wp:comment_author_IP>192.176.230.1</wp:comment_author_IP>
			<wp:comment_date>2009-12-18 13:04:32</wp:comment_date>
			<wp:comment_date_gmt>2009-12-18 12:04:32</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Apparently, 256 bytes of entropy wasn't enough. Just deployed a system with 2kB entropy and still had to do step 2 and 3.
It does work on RedHat Enterprise Linux 5.4 too... nice to have that tested. :)]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>15</wp:comment_id>
			<wp:comment_author><![CDATA[michael]]></wp:comment_author>
			<wp:comment_author_email>mikenuhawk@gmail.com</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>82.147.189.116</wp:comment_author_IP>
			<wp:comment_date>2010-03-14 00:41:51</wp:comment_date>
			<wp:comment_date_gmt>2010-03-13 23:41:51</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Thank you for this news, I was searching something similar the past week.]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>16</wp:comment_id>
			<wp:comment_author><![CDATA[Mike]]></wp:comment_author>
			<wp:comment_author_email>nikstein@gmail.com</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>82.147.187.77</wp:comment_author_IP>
			<wp:comment_date>2010-03-22 15:07:28</wp:comment_date>
			<wp:comment_date_gmt>2010-03-22 14:07:28</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Thanks for a wonderful post, l ve been looking for such information, I will join jour rss feed now.]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
	</item>
	<item>
		<title>Updated MSMQ Management Pack v6.0.6615.0!</title>
		<link>http://www.teknoglot.se/ms/opsmgr2007/updated-msmq-management-pack/</link>
		<pubDate>Wed, 23 Dec 2009 08:57:38 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/ms/opsmgr2007/updated-msmq-management-pack/</guid>
		<description></description>
		<content:encoded><![CDATA[<p>Microsoft has released an update to the MSMQ (version 3) management pack.</p>  <blockquote>   <p>System Center Pack for: Message Queuing 3.0      <br />Version: 6.0.6615.0       <br />Released on: 12/14/2009</p>    <p>     <br />Message Queuing (also known as MSMQ) is a server application that enables applications to communicate across heterogeneous networks and systems that may be temporarily offline or otherwise inaccessible. Instead of an application communicating with a service on another computer, it sends its information to Message Queuing, which sends the information to a Message Queuing service on the target computer where it is made available to the other application. Message Queuing provides guaranteed delivery, efficient routing, security, and priority based messaging.</p> </blockquote>  <p>Now, what’s really interesting is what you will find in the MP Guide under “Supported Configurations”.</p>  <blockquote>   <p>The Message Queuing Management Pack for Operations Manager 2007 is designed to monitor Message Queuing version 3 only.</p>    <p>The Message Queuing Management Pack supports the following platforms:</p>    <p>· Windows Server 2003</p>    <p>· Windows XP</p>    <p><font color="#800000">The Message Queuing Management Pack also supports monitoring clustered MSMQ components</font>.</p> </blockquote>  <p>Text coloration is obviously added by me to highlight the interesting part. ;)</p>  <p>Finally MSMQ monitoring seems to be cluster aware, which might mean that the home-made pack i did to have those (numerous) queues covered could be passed on to the scrap-heap. This is also confirmed under “Changes in This Update”.</p>  <blockquote>   <p>The December 2009 update to this management pack includes the following change:</p>    <p>· Fixed a problem when working with an instance of MSMQ in a Cluster. The MP is now able to discover and monitor public and private queues in a cluster.</p>    <p>· Fixed a problem when discovering the local and cluster instance of MSMQ. The MP is now able to discover and monitor both instances.</p> </blockquote>  <p>The confusing double RunAs profiles seems to have been cleaned up too (you only have to worry about one now) as well as fixing some sloppy mistakes in the previous scripts (no Option Explicit? C’mon Microsoft! You <em>write</em> the best practices, try to stick to them.) and generally improving display and documentation.</p>  <p>Gonna import this to our staging environment today and let it roll during the holidays.</p>  <p>Cheers! Oh, and happy holidays!</p>  <blockquote>   <p>Download and documentation:      <br /><a title="http://www.microsoft.com/downloads/details.aspx?FamilyId=1D2B4398-8BC2-4A43-850C-852EBB0D983B&amp;displaylang=en&amp;displaylang=en" href="http://www.microsoft.com/downloads/details.aspx?FamilyId=1D2B4398-8BC2-4A43-850C-852EBB0D983B&amp;displaylang=en&amp;displaylang=en">http://www.microsoft.com/downloads/details.aspx?FamilyId=1D2B4398-8BC2-4A43-850C-852EBB0D983B&amp;displaylang=en&amp;displaylang=en</a></p></blockquote>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>251</wp:post_id>
		<wp:post_date>2009-12-23 09:57:38</wp:post_date>
		<wp:post_date_gmt>2009-12-23 08:57:38</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>updated-msmq-management-pack</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="management-pack"><![CDATA[Management Pack]]></category>
		<category domain="post_tag" nicename="msmq"><![CDATA[MSMQ]]></category>
		<category domain="post_tag" nicename="opsmgr"><![CDATA[OpsMgr]]></category>
		<category domain="category" nicename="opsmgr2007"><![CDATA[OpsMgr 2007]]></category>
		<wp:postmeta>
			<wp:meta_key>syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>ESENT Error When Modifying OpsMgr Agent</title>
		<link>http://www.teknoglot.se/ms/opsmgr2007/esent-error-when-modifying-opsmgr-agent/</link>
		<pubDate>Fri, 19 Mar 2010 09:34:17 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/ms/opsmgr2007/esent-error-when-modifying-opsmgr-agent/</guid>
		<description></description>
		<content:encoded><![CDATA[<p>Getting “ESENT Kerys are required to install this application” when you are trying to modify/change an agent installation?</p>  <p><a href="http://www.teknoglot.se/wp/wp-content/uploads/2010/03/image.png"><img title="image" style="border-right: 0px; border-top: 0px; display: block; float: none; margin-left: auto; border-left: 0px; margin-right: auto; border-bottom: 0px" height="172" alt="image" src="http://www.teknoglot.se/wp/wp-content/uploads/2010/03/image_thumb.png" width="368" border="0" /></a></p>  <p>This seems to be&#160; most common on Windows 2008 and i guess it’s because of the AUC and the fact that opening the Control Panel isn’t running in administrative mode.</p>  <p>To work around this you need to run the msiexec command on the correct installation GUID from an administrative command prompt.</p>  <p>Besides running through the registry to find the GUID, one of the easier ways is this:</p>  <ol>   <li>Open an administrative command prompt.</li>    <li>run <strong>wmic product</strong></li>    <li>Locate your product by its name, the GUID (looks a bit like this {25097770-2B1F-49F6-AB9D-1C708B96262A}) directly after that is the one you want. Copy it.</li>    <li>run <strong>msiexec /i &lt;PASTEYOURGUIDHERE&gt;</strong></li>    <li>Modify the agent as pleased</li> </ol>  <p>That’s pretty much it. Good luck.</p>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>260</wp:post_id>
		<wp:post_date>2010-03-19 10:34:17</wp:post_date>
		<wp:post_date_gmt>2010-03-19 09:34:17</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>esent-error-when-modifying-opsmgr-agent</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="errors"><![CDATA[Errors]]></category>
		<category domain="post_tag" nicename="how-to"><![CDATA[How-To]]></category>
		<category domain="post_tag" nicename="opsmgr"><![CDATA[OpsMgr]]></category>
		<category domain="category" nicename="opsmgr2007"><![CDATA[OpsMgr 2007]]></category>
		<category domain="post_tag" nicename="windows"><![CDATA[Windows]]></category>
		<category domain="post_tag" nicename="windows-installer"><![CDATA[Windows Installer]]></category>
		<category domain="post_tag" nicename="wmi"><![CDATA[WMI]]></category>
	</item>
	<item>
		<title>Change Gateway Powershell Script</title>
		<link>http://www.teknoglot.se/ms/opsmgr2007/change-gateway-powershell-script/</link>
		<pubDate>Wed, 31 Mar 2010 14:27:08 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/ms/opsmgr2007/change-gateway-powershell-script/</guid>
		<description></description>
		<content:encoded><![CDATA[This script has pretty much already been covered in my previous post about <a href="http://teknoglot.hartati.se/ms/opsmgr2007/replacechange-a-gateway-server/">Changing or Replacing an Operations Manager Gateway Server</a>.

This time I’ve basically put parameter support in it to make it easier to use.

Here’s the script anyway.

[ps]

Param($OldGW,$NewGW)

$OldMS= Get-ManagementServer | where {$_.Name -eq $OldGW}
$NewMS = Get-ManagementServer | where {$_.Name -eq $NewGW}
$agents = Get-Agent | where {$_.PrimaryManagementServerName -eq $OldGW}
$agents = $agents
&quot;Moving &quot; + $agents.count + &quot; agents from &quot; + $OldMS.Name + &quot; to &quot; + $NewMS.Name
Start-Sleep -m 200
Set-ManagementServer -AgentManagedComputer: $agents -PrimaryManagementServer: $NewMS -FailoverServer: $OldMS

[/ps]

To use it, create a textfile called ChangeGW.ps1 and paste the code into it. Save the file somewhere neat (maybe C:\Scripts\) for easy access. If you don't feel like copy/pasting, you can <a href="http://teknoglot.hartati.se/ms/opsmgr2007/change-gateway-powershell-script/attachment/changegw/">download the script here</a>.

To use it, open the Operations Manager Command Shell and type:
<strong>C:\Scripts\ChangeGW.ps1 &lt;old.gatewayserver.dns.name&gt; &lt;new.gatewayserver.dns.name&gt;</strong>

For example:

[plain]
C:\Scripts\ChangeGW.ps1 gwserver01.domainname.local gwserver02.domainname.local
[/plain] ]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>261</wp:post_id>
		<wp:post_date>2010-03-31 15:27:08</wp:post_date>
		<wp:post_date_gmt>2010-03-31 14:27:08</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>change-gateway-powershell-script</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="opsmgr"><![CDATA[OpsMgr]]></category>
		<category domain="category" nicename="opsmgr2007"><![CDATA[OpsMgr 2007]]></category>
		<category domain="category" nicename="powershell"><![CDATA[PowerShell]]></category>
		<category domain="post_tag" nicename="powershell"><![CDATA[PowerShell]]></category>
		<category domain="post_tag" nicename="script"><![CDATA[Script]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>MSMQ 4 and MSMQ 5 MP for OpsMgr Released! (finally)</title>
		<link>http://www.teknoglot.se/ms/opsmgr2007/msmq-4-and-msmq-5-mp-for-opsmgr-released-finally/</link>
		<pubDate>Tue, 06 Apr 2010 11:09:57 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/?p=268</guid>
		<description></description>
		<content:encoded><![CDATA[<p>After a long wait (definitely more than 90 days) the management packs for MSMQ 4 (Windows 2008) and MSMQ 5 (Windows 2008 R2) are finally released.</p>  <p>Both seem to be fully Cluster aware and pretty much holds the same monitoring as the the latest MSMQ 3 MP.</p>  <h3>Message Queuing 4.0 Management Pack for Operations Manager 2007</h3>  <p></p>  <blockquote>   <p><strong>Quick Details</strong></p>    <p>Version: 6.0.6700.83</p>    <p>Date Published: 4/5/2010</p>    <p>Language: English</p> </blockquote>  <p>Download here: <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=cfc103b8-7185-4721-8098-110885fe9e9e&amp;displaylang=en">http://www.microsoft.com/downloads/details.aspx?FamilyID=cfc103b8-7185-4721-8098-110885fe9e9e&amp;displaylang=en</a></p>  <h3>Message Queuing 5.0 Management Pack for Operations Manager 2007</h3>  <blockquote>   <p><strong>Quick Details</strong></p>    <p>Version: 6.0.6700.88</p>    <p>Date Published: 4/5/2010</p>    <p>Language: English</p> </blockquote>  <p>Download here: <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=28349b78-8329-44aa-8a1f-81f4e3f84d0c&amp;displaylang=en">http://www.microsoft.com/downloads/details.aspx?FamilyID=28349b78-8329-44aa-8a1f-81f4e3f84d0c&amp;displaylang=en</a></p>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>268</wp:post_id>
		<wp:post_date>2010-04-06 12:09:57</wp:post_date>
		<wp:post_date_gmt>2010-04-06 11:09:57</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>msmq-4-and-msmq-5-mp-for-opsmgr-released-finally</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="management-pack"><![CDATA[Management Pack]]></category>
		<category domain="post_tag" nicename="msmq"><![CDATA[MSMQ]]></category>
		<category domain="category" nicename="opsmgr2007"><![CDATA[OpsMgr 2007]]></category>
		<wp:comment>
			<wp:comment_id>17</wp:comment_id>
			<wp:comment_author><![CDATA[Tweets that mention [ Teknoglot ] » MSMQ 4 and MSMQ 5 MP for OpsMgr Released! (finally) -- Topsy.com]]></wp:comment_author>
			<wp:comment_author_email></wp:comment_author_email>
			<wp:comment_author_url>http://topsy.com/trackback?utm_source=pingback&amp;utm_campaign=L2&amp;url=http://teknoglot.hartati.se/ms/opsmgr2007/msmq-4-and-msmq-5-mp-for-opsmgr-released-finally/</wp:comment_author_url>
			<wp:comment_author_IP>208.74.66.43</wp:comment_author_IP>
			<wp:comment_date>2010-04-06 20:09:36</wp:comment_date>
			<wp:comment_date_gmt>2010-04-06 19:09:36</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[[...] This post was mentioned on Twitter by Services Ready, astromek. astromek said: New post: #MSMQ 4 and #MSMQ 5 MP for #OpsMgr Released! (finally) (http://tinyurl.com/ykame2z) [...] ]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type>pingback</wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
	</item>
	<item>
		<title>&quot;Load Balancing&quot; Powershell Script for Operations Manager</title>
		<link>http://www.teknoglot.se/ms/opsmgr2007/loadbalancing-ps-script-opsmgr/</link>
		<pubDate>Thu, 15 Apr 2010 13:27:37 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/?p=273</guid>
		<description></description>
		<content:encoded><![CDATA[I've been looking for at way to evenly distribute agents between Gateway Servers (or Management Servers for that matter, but I'll stick to GWs this time) for some time but haven't really got to fixing it myself until now.

The situation is basically that we're monitoring customers through gateway servers connected to our central Operations Manager environment. To have a bit of redundancy we always put two (or more) gateway servers per site (or customer, really) and they, in turn, talks to a couple of central management servers. I guess a drawing would be nice, but I have no Visio on this computer. The gateways are manually configured to talk to different management servers and have the others configured for fail-over (through powershell) and since we're talking about no more than a few handfuls (say 20-ish) it's not a problem handling it that way.

Agents, on the other hand, are a different matter. Even though we try to spread them out somewhat evenly at deployment between the gateway servers at each site we still end up looking at a 3:2 ratio after a while and since agents do not automatically fail-over between gateway servers we need a way to fix that too.
So I wrote a little powershell script that takes a bunch of gateway servers (or management servers) as parameters, gathers all connected agents, spreads the agents evenly between the servers and configures the others as fail-over servers while at it.

It's all pretty crude, but it works and you can download it from here: <a rel="attachment wp-att-274" href="http://teknoglot.hartati.se/ms/opsmgr2007/loadbalancing-ps-script-opsmgr/attachment/distributeagents/">DistributeAgents.ps1</a>
Save it somewhere on disk and call it from the Operations Manager Shell like this:

[plain]C:\DistributeAgents.ps1 gateway01.customer.local,gateway02.customer.local,gateway03.customer.local[/plain]

Yes, you should replace "C:\" with whatever path you decided to save the script to and "gatewayXX.customer.local" with a real servername. ;)

Ok, I'm a powershell freshman and I'm pretty sure you could do this a prettier way, but here's the script:

[ps]
Param([array]$CSVServerList)

$arrServerObject = @()
$arrAgentObject = @()

foreach($Server in $CSVServerList)
{
	$arrServerObject += Get-ManagementServer | where {$_.Name -eq $Server}
	echo &quot;Looking for $Server&quot;
}
$ServerCount = $arrServerObject.Count
if ($ServerCount -gt 1)
{
	echo &quot;Found $ServerCount management servers&quot;
} else {
	echo &quot;Found only 1 (or less) management servers. Aborting...&quot;
	Exit
}

echo &quot;Getting agents...&quot;
foreach ($Server in $arrServerObject)
{
	$arrAgentObject += Get-Agent | where {$_.PrimaryManagementServerName -eq $Server.Name}
}
$AgentCount = $arrAgentObject.Count
if ($AgentCount -gt 1)
{
	echo &quot;Found $AgentCount agents&quot;
	Start-Sleep -m 200
} else {
	echo &quot;Found only 1 (or less) agents. Aborting...&quot;
	Exit
}
$i = 0
foreach ($Agent in $arrAgentObject)
{
	if ($i -ge $ServerCount)
	{
		$i = 0
	}
	$arrTemp = @($arrServerObject | Where-Object {$_ -ne $arrServerObject[$i]})
	# $FailoverServers = $arrTemp -join &quot;,&quot;
	Set-ManagementServer -AgentManagedComputer: $Agent -PrimaryManagementServer: $arrServerObject[$i] -FailoverServer: $arrTemp

	$arrTemp = $null
	$i++
}

[/ps]

I have used it on a couple of occasions now and have only discovered a problem with an error when one of the servers don't have any agents at all (probably a new one), but the script still works so I haven't really dived into it.
Now, as with all scripts you download on the 'net it's up to you to test it in a lab before shooting wildly among your in-production systems. I really can't give any warranties that it won't FSU royally at your place.]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>273</wp:post_id>
		<wp:post_date>2010-04-15 14:27:37</wp:post_date>
		<wp:post_date_gmt>2010-04-15 13:27:37</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>loadbalancing-ps-script-opsmgr</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="opsmgr"><![CDATA[OpsMgr]]></category>
		<category domain="category" nicename="opsmgr2007"><![CDATA[OpsMgr 2007]]></category>
		<category domain="category" nicename="powershell"><![CDATA[PowerShell]]></category>
		<category domain="post_tag" nicename="powershell"><![CDATA[PowerShell]]></category>
		<category domain="post_tag" nicename="script"><![CDATA[Script]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:comment>
			<wp:comment_id>18</wp:comment_id>
			<wp:comment_author><![CDATA[INF]]></wp:comment_author>
			<wp:comment_author_email>infrastructure@teluq.uquebec.ca</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>132.214.111.205</wp:comment_author_IP>
			<wp:comment_date>2010-05-29 16:55:10</wp:comment_date>
			<wp:comment_date_gmt>2010-05-29 15:55:10</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Nice script, they should really include something similar in the product itself as an alternative to AD-Managed. I did one myself that simple verify if the clients have a failover server and set one if necessary as a scheduled task. But was missing the load balancing part.
Thanks !]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
	</item>
	<item>
		<title>Installing Linux Integration Services v2.1 on Red Hat ES 5</title>
		<link>http://www.teknoglot.se/linux/redhat-es/install-linuxis21-rhes5/</link>
		<pubDate>Tue, 31 Aug 2010 11:06:04 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/?p=291</guid>
		<description></description>
		<content:encoded><![CDATA[Ok, so I got the task to install the Linux Integration Service for Hyper-V R2 on a RedHat Enterprise Server 5. Something that turned out to be a bit more to handle than I would have thought. So here's a little How-To.
<h3>Preparations</h3>
Read the documentation provided in the Linux Integration Services download. Much of the information in this article is in there, but some parts are not. Otherwise I would not have bothered writing about it. ;)

I'm not going to go through the OS installation process here, but make sure to select the "Software Development" packages since you will be needing it. In case you missed it, you can install them later by running these commands.

[plain]# yum groupinstall &quot;Development Tools&quot;
# yum install kernel-headers[/plain]

I'm not actually sure that you need to run the kernel-headers install manually or if it's included in the "Development Tools" package.

The first gotcha i ran into was the fact that the link to the Linux Integration Services--previously known as Linux Integration Components or LinuxIC--on RedHat's information pages gave me a 404 and a redirect to a bing-search that returned the exact same 404. The page have simply been removed by Microsoft without any form of redirection to the new page. Anyway, a search on <a href="http://download.microsoft.com">http://download.microsoft.com</a> for "Linux Integration Components" do return the new page, and that's where I learned about the new name.
<em>Thank you for making it easy for us Microsoft!
</em>Here's a direct link to the search on the current name: <a href="http://www.microsoft.com/downloads/en/results.aspx?freetext=linux+integration+services&amp;displaylang=en&amp;stype=s_basic">http://www.microsoft.com/downloads/en/results.aspx?freetext=linux+integration+services&amp;displaylang=en&amp;stype=s_basic</a>
And here's a direct link to the actual download page: <a href="http://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=eee39325-898b-4522-9b4c-f4b5b9b64551">http://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=eee39325-898b-4522-9b4c-f4b5b9b64551</a>

This download contains an ISO file that you can mount using the Hyper-V- or VMM-console, or you can do as I did and download the ISO to the virtual machine, mount it locally, copy the files and unmount it. Like this.

[plain]
# mkdir /mnt/ISO
# mount -o loop /root/LinuxIC\ v21.iso /mnt/ISO
# mkdir /opt/linux_ic_v21_rtm
# cp /mnt/ISO/* -R /opt/linux_ic_v21_rtm/
# umount /mnt/ISO
[/plain]

You probably have to be root to do this by the way.
With that done, let's get to the installation.
<h3>Installation</h3>
As root, do the following:

[plain]
# export PATH=$PATH:/sbin
# cd /opt/linux_ic_v21_rtm/
# make
# make install
# reboot
[/plain]

Why the export PATH command? Apparently, on RHES5, /sbin is not in the PATH by default and this is something that the make scripts are completely unaware of. The "make install" will try to run "depmod" which will fail since it's not in the default path. You could also add "PATH=$PATH/sbin" to the root users ~/.bashrc which will put it back in the PATH but only for the root user, but I don't know if that's recommended.
And, yes. You DO have to reboot after the install.

If you are running RHES5 64bit you also have to install the "adjtimex" package. It is in the RHN repository but also on the RHES5 Installation CD in case you have no internet connection. Install it with yum like this:

[plain]# yum install adjtimex[/plain]

And from the CD (mount it first) like this:

[plain]# rpm –ivh /mnt/cdrom/Server/adjtimex-1.20-2.1.x86_64.rpm[/plain]

And that's basically it for the installation.
<h3>Verification</h3>
How do you know that the driver are installed?

After the reboot, try running "modinfo vmbus" which should return something like this:

[plain]# modinfo vmbus
filename:       /lib/modules/2.6.18-194.11.1.el5/kernel/drivers/vmbus/vmbus.ko
version:        2.1.25
license:        GPL
srcversion:     3C1899C419665CB2514F2D0
depends:
vermagic:       2.6.18-194.11.1.el5 SMP mod_unload gcc-4.1
parm:           vmbus_irq:int
parm:           vmbus_loglevel:int[/plain]

Try that with netvsc, storvsc and blkvsc too (replace the <em>vmbus</em> part) and you should get something similar. If you don't, the installation did not succeed.
The documentation also tells us to check that the components are running with "/sbin/lsmod | grep vsc" which should return:

[plain]# /sbin/lsmod | grep vsc
blkvsc                 70184  3
storvsc                64264  0
netvsc                 73504  0
vmbus                  88304  3 blkvsc,storvsc,netvsc
scsi_mod              196953  6 scsi_dh,sg,blkvsc,storvsc,libata,sd_mod[/plain]

The numbers will probably differ from installation to installation depending on blocksizes and allocation.
<h3>Configuration</h3>
Configuration is pretty straight-forward so I'll keep this short.

When you install the drivers you will get a new network card called <strong>seth0</strong>, which I presume stands for Synthetic ETHernet. There's nothing magic about it regarding configuration and "system-configuration-network" will work just fine.

The drivers will also give you a couple of SCSI-devices (if you have one attached) with the regular <strong>/dev/sd*</strong> naming. Simply configure these using fdisk or whatever GUI you might prefer.

There is also a note in the documentation about changing the grub configuration in the "Additional Information..." section. Do read that section.
<h3>Additional Comments</h3>
One thing I tend to do now that disk space is dirt cheap is to copy all ISO-files I use locally instead of mounting them when needed through Hyper-V. Simply because you can bet your insert-shorter-word-for-buttocks that the day you need it again, someone has been kind enough to have done som spring-cleaning or it's locked by another machine in the cluster. If you have it locally and followed my instructions in the "Preparation" section, you will allready have a /mnt/ISO directory. Only thing you'll have to do is

[plain]
# mount -o loop /path/to/your.iso /mnt/ISO
[/plain]

And there you have it. Just remember to unmount it when you're done.

I also almost never use the Hyper-V remote connection interface thingy since it will give you a GUI and the mouse just won't work. If you haven't configured a network card yet though, you could connect through Hyper-V and hit <em>Ctrl+Alt+F1</em> to get a command prompt. Unfortunatly cut/paste don't work here, but you could run <em>system-configuration-network</em>, assign an IP-address and then connect with an SSH client. I prefer PuTTY to a degree that I usually install the ported version on my Linux desktops aswell.

And I never logon using root. People should know this, but it should be stressed anyway. Always logon as regular user and <em>su</em> or <em>sudo</em> when needed. I can't understand why RHES has root-login enabled by default in the SSH-server config.

Good luck!]]></content:encoded>
		<excerpt:encoded><![CDATA[Ok, so I got the task to install the Linux Integration Service for Hyper-V R2 on a RedHat Enterprise Server 5. Something that turned out to be a bit more to handle than I would have thought. So here's a little How-To.]]></excerpt:encoded>
		<wp:post_id>291</wp:post_id>
		<wp:post_date>2010-08-31 12:06:04</wp:post_date>
		<wp:post_date_gmt>2010-08-31 11:06:04</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>install-linuxis21-rhes5</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="how-to"><![CDATA[How-To]]></category>
		<category domain="category" nicename="hyper-v"><![CDATA[Hyper-V]]></category>
		<category domain="post_tag" nicename="hyper-v"><![CDATA[Hyper-V]]></category>
		<category domain="post_tag" nicename="linux"><![CDATA[Linux]]></category>
		<category domain="post_tag" nicename="redhat"><![CDATA[RedHat]]></category>
		<category domain="category" nicename="redhat-es"><![CDATA[RedHat ES]]></category>
		<category domain="post_tag" nicename="rhes5"><![CDATA[RHES5]]></category>
		<wp:postmeta>
			<wp:meta_key>_syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:comment>
			<wp:comment_id>19</wp:comment_id>
			<wp:comment_author><![CDATA[dundy]]></wp:comment_author>
			<wp:comment_author_email>dundy_shibby@hotmail.com</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>208.234.56.198</wp:comment_author_IP>
			<wp:comment_date>2010-12-30 15:27:47</wp:comment_date>
			<wp:comment_date_gmt>2010-12-30 14:27:47</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[I'm new at linux and here at my job we have an application running on a physical linux server. We need to virtualize this machine to decomission the box and save money on hardware. I contacted the people the develop the software and they configured the linux box, but when I logged on to install the LIC i keep getting errors everywhere. I thought it might have been that they did not install the software development package. So after searching the internets I found your page, problem is that when I run # yum groupinstall "Development Tools" I get another error. Is there anyway i can run this as a package from the cd with #rpm?]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>36</wp:comment_id>
			<wp:comment_author><![CDATA[Sam T]]></wp:comment_author>
			<wp:comment_author_email>sam@hartati.se</wp:comment_author_email>
			<wp:comment_author_url>http://teknoglot.se</wp:comment_author_url>
			<wp:comment_author_IP>192.176.230.1</wp:comment_author_IP>
			<wp:comment_date>2011-02-16 10:39:56</wp:comment_date>
			<wp:comment_date_gmt>2011-02-16 09:39:56</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Just noticed that the blog didn't send any emails.
I've added a few responsed to you question, maybe they will help?]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>19</wp:comment_parent>
			<wp:comment_user_id>1</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>33</wp:comment_id>
			<wp:comment_author><![CDATA[Sam T]]></wp:comment_author>
			<wp:comment_author_email>sam@hartati.se</wp:comment_author_email>
			<wp:comment_author_url>http://teknoglot.se</wp:comment_author_url>
			<wp:comment_author_IP>192.176.230.1</wp:comment_author_IP>
			<wp:comment_date>2011-02-15 15:58:09</wp:comment_date>
			<wp:comment_date_gmt>2011-02-15 14:58:09</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[I am not a friend of YUM/RPM actually (being a debian-ish person) but you probably could to that.
I believe these packages are available on the RHES CD/DVD but I am afraid I don't know out of memory how to add it as a repository.

I'll have to google on that. :)]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>1</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>34</wp:comment_id>
			<wp:comment_author><![CDATA[Sam T]]></wp:comment_author>
			<wp:comment_author_email>sam@hartati.se</wp:comment_author_email>
			<wp:comment_author_url>http://teknoglot.se</wp:comment_author_url>
			<wp:comment_author_IP>192.176.230.1</wp:comment_author_IP>
			<wp:comment_date>2011-02-15 16:01:46</wp:comment_date>
			<wp:comment_date_gmt>2011-02-15 15:01:46</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Back again:
You should be able to install these tools by adding the installation media as a local repository.
Here's a nice comment about it:
http://www.cyberciti.biz/faq/rhel-centos-fedora-linux-yum-command-howto/#comment-41499]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>1</wp:comment_user_id>
		</wp:comment>
	</item>
	<item>
		<title>SNMP GET Errors in OpsMgr EventLog</title>
		<link>http://www.teknoglot.se/ms/opsmgr2007/snmp-get-errors-in-eventlog/</link>
		<pubDate>Thu, 02 Sep 2010 21:28:07 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/?p=306</guid>
		<description></description>
		<content:encoded><![CDATA[I've been building a little SNMP Management Pack in the past few days to discover and monitor a bunch of PowerWare UPS's, which turned out to take quite a lot more energy and time than expected. Mostly due to the facts that I am really bad with SNMP and how it works, I've never really looked into the inner working of building an SNMP management pack and also because we ran into a couple of errors preventing the discovery process to work alright.

To make it clear right away, this is not going to be a "Building an SNMP Management Pack Tutorial" since there's plentiful good ones out there already, and to be extra helpful I'm gonna include a few links right away:
<ul>
	<li><a title="SNMP Setup and Simple Custom SNMP Discovery" href="http://www.systemcentercentral.com/BlogDetails/tabid/143/IndexID/66140/Default.aspx">SNMP Setup and Simple Custom SNMP Discovery</a> - Pretty much the basics</li>
	<li><a title="SNMP Management Pack Example: NetApp Management Pack for SCOM 2007 R2 part 4" href="http://www.systemcentercentral.com/BlogDetails/tabid/143/IndexID/58919/Default.aspx">SNMP Management Pack Example: NetApp Management Pack</a> - Part 4 actually, but has the links to the other parts</li>
	<li><a title="Creating SNMP Probe Based Monitors" href="http://www.systemcentercentral.com/Details/tabid/147/IndexID/58815/Default.aspx">Creating SNMP Probe Based Monitors</a> - No custom discovery, but a good and simple guide to SNMP Probes</li>
</ul>
It's the second, the NetApp one, I've used as a guide to building the UPS management pack since it goes through the process of building your own filtered discovery using SystemOID to identify your hardware-classes and then building the monitors on top of those.
<h2>Let's get to it</h2>
When building the discovery of my hardware classes I ran into problems. The discovery simply did not work. At first I got some strange errors about "invalid queries", something that turned out to be related to me reading two guides--seriously though, pick one guide that is closest to what you want to achieve and stick to it--and mixing up the XPathQuery variables. Silly me.
I got those errors to go away and I was able to get a few objects to my base-class, but none of the hardware classes who was populated through the return value of an SNMP OID got discovered.
The only error I got this time was the following:<span style="font-family: Consolas, Monaco, 'Courier New', Courier, monospace; font-size: small;"><span style="line-height: 18px; white-space: pre;">
</span></span>

[plain]Log Name:      Operations Manager
Source:        Health Service Modules
Date:          2010-09-02 11:19:12
Event ID:      11001
Task Category: None
Level:         Error
Keywords:      Classic
User:          N/A
Computer:      CENSORED
Description:
Error sending an SNMP GET message to IP Address XX.XX.XX.XX, Community String:=CENSORED, Status 0x6c.

One or more workflows were affected by this.

Workflow name: CENSORED.MP.CLASS.DISCOVERY
Instance name: CENSORED_DEVICENAME
Instance ID: {5C7EFB30-D885-8843-0DD7-EA86B4FD2311}
Management group: CENSORED
[/plain]
<div>I went through all the other logical steps of troubleshooting an error like that which include double-checking firewall settings, OIDs, IP-addresses, allowed hosts and so forth. It wasn't until I loaded the <a title="EATON Protocol Library" href="http://www.networkupstools.org/protocols/eaton/">PowerMIB</a> into a MIB Browser installed on the proxy machine (in this case a Management Server) I realized that there was no problem sending an SNMP GET to the UPS from that server. I launched Wireshark and had it listen to SNMP traffic between the UPS and the Management Server. The thing that struck me right-away was the fact that I could see the a bunch of "SNMP Get-Request" but no "SNMP Get-Response" which means that Operations Manager did send an SNMP GET but there was no response.</div>
<div>After a bit of intense staring i noticed what you see in the screenshot.</div>
<div></div>
<div><img class="alignnone size-full wp-image-307" title="SNMP Error in Wireshark" src="http://www.teknoglot.se/wp/wp-content/uploads/2010/09/snmp_error_wireshark.png" alt="SNMP Error in Wireshark" width="622" height="138" /></div>
<div>

</div>
<div>For some reason Operations Manager does not care about what SNMP version you configure when you do the initial discovery of a network device. Even if you do specify SNMP v1, you probes may very well be using SNMP v2c instead and in many cases that will result in these SNMP GET errors in the Operations Manager event log.</div>
<div>To avoid this, you haves to specify which SNMP version to use in your System.SnmpProbe according to the information provided here: <a href="http://msdn.microsoft.com/en-us/library/ee809331.aspx">http://msdn.microsoft.com/en-us/library/ee809331.aspx</a></div>
<div>Since I am such a nice guy, here's an example of the working probe with the added line highlighted.</div>
<div>[xml highlight="4"]
&lt;IsWriteAction&gt;false&lt;/IsWriteAction&gt;
&lt;IP&gt;$Config/IP$&lt;/IP&gt;
&lt;CommunityString&gt;$Config/CommunityString$&lt;/CommunityString&gt;
&lt;Version&gt;1&lt;/Version&gt;
&lt;SnmpVarBinds&gt;
	&lt;SnmpVarBind&gt;
		&lt;OID&gt;1.3.6.1.4.1.534.1.1.1.0&lt;/OID&gt;
		&lt;Syntax&gt;0&lt;/Syntax&gt;
		&lt;Value VariantType=&quot;8&quot;&gt;&lt;/Value&gt;
	&lt;/SnmpVarBind&gt;
	&lt;SnmpVarBind&gt;
		&lt;OID&gt;1.3.6.1.4.1.534.1.1.2.0&lt;/OID&gt;
		&lt;Syntax&gt;0&lt;/Syntax&gt;
		&lt;Value VariantType=&quot;8&quot;&gt;&lt;/Value&gt;
	&lt;/SnmpVarBind&gt;
	&lt;SnmpVarBind&gt;
		&lt;OID&gt;1.3.6.1.4.1.534.1.1.3.0&lt;/OID&gt;
		&lt;Syntax&gt;0&lt;/Syntax&gt;
		&lt;Value VariantType=&quot;8&quot;&gt;&lt;/Value&gt;
	&lt;/SnmpVarBind&gt;
&lt;/SnmpVarBinds&gt;
[/xml]

That's it. Working perfectly now.

Best of luck to you too.

</div>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>306</wp:post_id>
		<wp:post_date>2010-09-02 22:28:07</wp:post_date>
		<wp:post_date_gmt>2010-09-02 21:28:07</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>snmp-get-errors-in-eventlog</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="post_tag" nicename="errors"><![CDATA[Errors]]></category>
		<category domain="post_tag" nicename="management-pack"><![CDATA[Management Pack]]></category>
		<category domain="post_tag" nicename="opsmgr"><![CDATA[OpsMgr]]></category>
		<category domain="category" nicename="opsmgr2007"><![CDATA[OpsMgr 2007]]></category>
		<category domain="post_tag" nicename="troubleshooting"><![CDATA[TroubleShooting]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_syntaxhighlighter_encoded</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_wp_old_slug</wp:meta_key>
			<wp:meta_value><![CDATA[]]></wp:meta_value>
		</wp:postmeta>
		<wp:comment>
			<wp:comment_id>20</wp:comment_id>
			<wp:comment_author><![CDATA[Rikard Ronnkvist]]></wp:comment_author>
			<wp:comment_author_email>rikard@ronnkvist.nu</wp:comment_author_email>
			<wp:comment_author_url></wp:comment_author_url>
			<wp:comment_author_IP>81.227.15.17</wp:comment_author_IP>
			<wp:comment_date>2010-09-03 05:40:55</wp:comment_date>
			<wp:comment_date_gmt>2010-09-03 04:40:55</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[Why not look in to xSnmp and extending that one instead?

http://www.manage-x.net/]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>0</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
		<wp:comment>
			<wp:comment_id>21</wp:comment_id>
			<wp:comment_author><![CDATA[Sam T]]></wp:comment_author>
			<wp:comment_author_email>samuel.tegenfeldt@hartati.se</wp:comment_author_email>
			<wp:comment_author_url>http://</wp:comment_author_url>
			<wp:comment_author_IP>192.176.230.1</wp:comment_author_IP>
			<wp:comment_date>2010-09-03 10:43:25</wp:comment_date>
			<wp:comment_date_gmt>2010-09-03 09:43:25</wp:comment_date_gmt>
			<wp:comment_content><![CDATA[It is a viable option unless you want to fully understand the basics.
Using xSNMP would, however, still do not change the fact that when you are building a custom datasource with a System.SnmpProbe module you still need to take notice about which SNMP version you need to use if the device only supports version 1.
Without defining 1 the SNMP GET error would still occur.

Apart from that, the xSNMP Suite is awsome and we are using it to monitor other network devices. :D]]></wp:comment_content>
			<wp:comment_approved>1</wp:comment_approved>
			<wp:comment_type></wp:comment_type>
			<wp:comment_parent>20</wp:comment_parent>
			<wp:comment_user_id>0</wp:comment_user_id>
		</wp:comment>
	</item>
	<item>
		<title>I&#039;m moving (finally)</title>
		<link>http://www.teknoglot.se/tb/im-moving-finally/</link>
		<pubDate>Tue, 01 Feb 2011 11:10:52 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://teknoglot.hartati.se/?p=376</guid>
		<description></description>
		<content:encoded><![CDATA[If you're seeing this, the move went OK. :P

Anyway, I have tried to make sure that all the links, images and urls are still intact and that people are automatically redirected to the correct address on the new site too. I think I got it right, but who knows?

Still fiddling with the themes thought.

Sorry for the inconvenience!

ps. Post from the old site is a jump ahead.

<!--more-->

Hi all,

I'm finally getting my <a title="aka. ass" href="http://en.wikipedia.org/wiki/Donkey">male donkey</a> out of the wagon and has started moving this blog to a new self-hosted server.

The current host is cheap and delivers quite the good service, but since I already have servers running 24/7 at home, with attached electric bills, and more than enough bandwidth for a couple of websites I find it silly paying for yet-another hosting solution.

Also, it is a good time to do some spring-cleaning and actually start using that teknoglot.se domain i bought some time ago. :P

Hopefully, the transition will go mostly unnoticed apart from the automatic redirect (301 - Permanently moved) to the new domain.]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>376</wp:post_id>
		<wp:post_date>2011-02-01 12:10:52</wp:post_date>
		<wp:post_date_gmt>2011-02-01 11:10:52</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>im-moving-finally</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="tb"><![CDATA[Technobabble]]></category>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Move complete, welcome to teknoglot.se!</title>
		<link>http://www.teknoglot.se/tb/move-complete-welcome-to-teknoglot-se/</link>
		<pubDate>Fri, 04 Feb 2011 13:07:41 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://www.teknoglot.se/?p=439</guid>
		<description></description>
		<content:encoded><![CDATA[Oh my God, I actually moved my blog for real. I think I've been putting this upp for nearly half a year now and even though I actually went and bought a "real" domain-name for it.

But now it'd done. The server is now self-hosted and self-maintained. Now, that obviously gives me a bit more to do, but on the other hand. I can fix any problems myself and not have to create tickets and hope someone responding to them knows what they're talking about.

The design is mostly borrowed, for now, but it works and I hope I did all the HTACCESS rules on the old server correct so that they forward all the old links to the same post on the new one.

So, welcome!]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>439</wp:post_id>
		<wp:post_date>2011-02-04 14:07:41</wp:post_date>
		<wp:post_date_gmt>2011-02-04 13:07:41</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>move-complete-welcome-to-teknoglot-se</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="tb"><![CDATA[Technobabble]]></category>
		<wp:postmeta>
			<wp:meta_key>_wp_old_slug</wp:meta_key>
			<wp:meta_value><![CDATA[]]></wp:meta_value>
		</wp:postmeta>
		<wp:postmeta>
			<wp:meta_key>_edit_last</wp:meta_key>
			<wp:meta_value><![CDATA[1]]></wp:meta_value>
		</wp:postmeta>
	</item>
	<item>
		<title>Sluggish performance on teknoglot</title>
		<link>http://www.teknoglot.se/tb/sluggish-performance-on-teknoglot/</link>
		<pubDate>Tue, 19 Apr 2011 21:14:02 +0000</pubDate>
		<dc:creator>ilex</dc:creator>
		<guid isPermaLink="false">http://www.teknoglot.se/tb/sluggish-performance-on-teknoglot/</guid>
		<description></description>
		<content:encoded><![CDATA[<p>I, as well as others, have noticed some slow performance from my blog lately and I just wanted to let you know that the root cause have been identified as a bug in on of the crypto libs on the server. <br>
I haven't found a working solution yet but are trying to keep an eye on the site regularly to be able to bounce the problematic services when they start to act up. <br>
Hopefully there will be a fix available soon. </p>
<p>Sorry for any inconvenience in the meantime. </p>]]></content:encoded>
		<excerpt:encoded><![CDATA[]]></excerpt:encoded>
		<wp:post_id>451</wp:post_id>
		<wp:post_date>2011-04-19 22:14:02</wp:post_date>
		<wp:post_date_gmt>2011-04-19 21:14:02</wp:post_date_gmt>
		<wp:comment_status>open</wp:comment_status>
		<wp:ping_status>open</wp:ping_status>
		<wp:post_name>sluggish-performance-on-teknoglot</wp:post_name>
		<wp:status>publish</wp:status>
		<wp:post_parent>0</wp:post_parent>
		<wp:menu_order>0</wp:menu_order>
		<wp:post_type>post</wp:post_type>
		<wp:post_password></wp:post_password>
		<wp:is_sticky>0</wp:is_sticky>
		<category domain="category" nicename="tb"><![CDATA[Technobabble]]></category>
		<category domain="post_tag" nicename="teknoglot"><![CDATA[Teknoglot]]></category>
	</item>
</channel>
</rss>
