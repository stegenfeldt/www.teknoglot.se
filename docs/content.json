{"meta":{"title":"teknoglot:","subtitle":null,"description":"Techspeak for the socially diminished.","author":"Samuel Tegenfeldt","url":"https://www.teknoglot.se"},"pages":[{"title":"About","date":"2016-05-17T22:20:57.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"About/index.html","permalink":"https://www.teknoglot.se/About/index.html","excerpt":"","text":"Who‚Äôs stegenfeldt?A System Management consultant at Atea Sverige AB, Swedish, focusing mainly on System Center Operations Manager, System Center Service Manager some Microsoft SQL Server and OP5.Besides doing consulting I am also an MCT and are holding both the official System Center Operations Manager courses at Cornerstone and Global Knowledge and holds customized classes at customer sites. The content of this site consists of my own personal opinions (and occasionally the opinions of others) and does not officially represent my employer‚Äôs view in anyway. Included content is especially not intended to convey the views of Atea Sverige AB. Please visit www.atea.com for official information. In addition, the thoughts and opinions of participants often change, and as a weblog, this is intended to provide a semi-permanent point in time snapshot. You should not consider out of date posts to reflect participants current thoughts and opinions."}],"posts":[{"title":"#OpsMgr 1801 Upgrade - The Fail Anthology","slug":"om1801-upgrade-gotchas","date":"2018-08-27T13:42:17.000Z","updated":"2018-08-28T13:28:13.636Z","comments":true,"path":"ms/opsmgr2016/om1801-upgrade-gotchas/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2016/om1801-upgrade-gotchas/","excerpt":"A Collection of OpsMgr Upgrade Fails I‚Äôll be frank on this one; Microsoft really dropped the ball on the 1801 setup program. No upgrade or update has been this ridden with faults and obscure errors, not even the infamous SCOM 2007 SP1 setup. And this is not only errors that will abort the installation, they will actively remove your existing SCOM Components and cause a restore, either from snapshot/checkpoint or from backup. MAKE SURE YOUR BACKUPS ARE WORKING!!! Rollbacks don‚Äôt work in 1801, at all. You have been warned. Here‚Äôs my list of the issues I‚Äôve seen and wrestled so far. .NET 3.5 Pre-requisites Although neither SCOM 2016 nor 1801 actually has a .NET 3.5 requirement, the setup think it does. The Prerequisute checker isn‚Äôt aware though, meaning it will happily try to upgrade and then fail. And, boy, does it fail spectacularly! When the upgrade failes, it‚Äôs supposed to perform a rollback, and reading the setup log it actually do try. Unfortunatly, the ‚Äúrollback‚Äù will remove any existing SCOM Roles in the server. O_o Yes, thats right. Your Management Server is no longer a Management Server! Workaround Make sure all SCOM Management Servers have .NET Framework 3.5 installed before attempting an upgrade.","text":"A Collection of OpsMgr Upgrade Fails I‚Äôll be frank on this one; Microsoft really dropped the ball on the 1801 setup program. No upgrade or update has been this ridden with faults and obscure errors, not even the infamous SCOM 2007 SP1 setup. And this is not only errors that will abort the installation, they will actively remove your existing SCOM Components and cause a restore, either from snapshot/checkpoint or from backup. MAKE SURE YOUR BACKUPS ARE WORKING!!! Rollbacks don‚Äôt work in 1801, at all. You have been warned. Here‚Äôs my list of the issues I‚Äôve seen and wrestled so far. .NET 3.5 Pre-requisites Although neither SCOM 2016 nor 1801 actually has a .NET 3.5 requirement, the setup think it does. The Prerequisute checker isn‚Äôt aware though, meaning it will happily try to upgrade and then fail. And, boy, does it fail spectacularly! When the upgrade failes, it‚Äôs supposed to perform a rollback, and reading the setup log it actually do try. Unfortunatly, the ‚Äúrollback‚Äù will remove any existing SCOM Roles in the server. O_o Yes, thats right. Your Management Server is no longer a Management Server! Workaround Make sure all SCOM Management Servers have .NET Framework 3.5 installed before attempting an upgrade. Up-to-date Linux/Unix Management Packs (or worse, newer) Oh, yes. If you have Linux management packs that are newer than what‚Äôs included in the 1801 setup, this will fail the setup. Causing the same defunct ‚Äúroll-back‚Äù that will uninstall your Management Server, but only after it mucks about in your databases for a bit. You‚Äôll need to restore databases from backup after this. Workaround There‚Äôs a few ways to get around this, all done before attempting the upgrade: Downgrade your cross-platform management packs (yuck!) Import the version shipped with the setup (in the ManagementPack subfolder). Remove all Cross-platform management packs. Updated OMS Management Pack (7.2.12026.0, released 2018-07-25) This is really the same fault as with the cross-platform management packs, but since this is announced without any other notices other than ‚Äúimport if you need to‚Äù I decided to put this in a separate part. Here‚Äôs the release blog and the SCOM 2016 version of the updated OMS MP. Once again, the setup is unable to handle that already existing management packs is newer than what‚Äôs provided with the 1801 setup. Instead of skipping, it will fail the installation with a, you guessed it, uninstalled Management Server and semi-upgraded databases as the result. Hello backup, old friend. In the OpsMgrSetupWizard.log file you‚Äôll spot something similar to this: [11:27:09]: Info: :Info:FirstManagementServer: Importing Management Pack: Microsoft System Center Advisor[11:27:09]: Always: :ImportManagementPack: Loading management pack C:\\install\\OM1801\\Setup\\AMD64\\..\\..\\ManagementPacks\\Microsoft.SystemCenter.Advisor.mpb. 11:27:09[11:27:10]: Error: :ImportManagementPack: Error: Unable to load management pack C:\\install\\OM1801\\Setup\\AMD64\\..\\..\\ManagementPacks\\Microsoft.SystemCenter.Advisor.mpb[11:27:10]: Error: :: Verification failed with 3 errors:-------------------------------------------------------Error 1:Found error in 2|Microsoft.SystemCenter.Advisor|7.2.12026.0|Microsoft.SystemCenter.Advisor|| with message:Version 7.3.13142.0 of the management pack is not upgrade compatible with older version 7.2.12026.0. Compatibility check failed with 2 errors:-------------------------------------------------------Error 2:Found error in 1|Microsoft.SystemCenter.Advisor/31bf3856ad364e35|1.0.0.0|Microsoft.SystemCenter.Advisor.Settings|| with message:Publicly accessible ClassProperty (PortalLink) has been removed in the newer version of this management pack.-------------------------------------------------------Error 3:Found error in 1|Microsoft.SystemCenter.Advisor/31bf3856ad364e35|1.0.0.0|Microsoft.SystemCenter.Advisor.Settings|| with message:Publicly accessible ClassProperty (OmsBladeLink) has been removed in the newer version of this management pack.-------------------------------------------------------[11:27:10]: Error: :ImportManagementPack: Unknown Error. System.ArgumentException : The requested management pack is not valid. See inner exception for details.Parameter name: managementPack[11:27:10]: Always: :FirstManagementServer: Failed to load MP C:\\install\\OM1801\\Setup\\AMD64\\..\\..\\ManagementPacks\\Microsoft.SystemCenter.Advisor.mpb. We will retry. Workaround As with the cross-platform management packs, you basically have two options: Downgrade to the setup-provided version of the management pack Remove the OMS/Advisor management packs alltogether. Operations Manager Reporting Upgrade When the setup checks for existing products to upgrade, it successfully finds your Operations Manager Reporting (OMRS) installation. Great, you are now able to tick that checkbox that allow you to continue the upgrade. Unfortunately, the actual upgrade seems to be utterly unable to spot it, fails on upgrade and will ‚Äúroll back‚Äù the installation. Since setup believes that there never was an OMRS on the server, it will return to that state. Meaning, you no longer have an Operations Manager Reporting Server! (yay) This one is not as critical as the others as you can simply install OMRS again, using the 1801 setup. Workaround Install the SCOM 2016 console on the OMRS before attempting your upgrade. Yeah, I know, this is stupid. Final thoughts What the üí©‚ùóÔ∏è‚ùì What the hell is going on at Microsoft right now? I‚Äôve been a strong supporter of System Center Operations Manager as one of, if not the, best and solid Infrastructure and application monitoring solution currently available. Especially on Windows and Microsoft-heavy platforms. The upgrades and installations have been getting more and more solid and easy to perform. It‚Äôs often been a case of ‚Äúverify backups, hit play, wait‚Äù. Up until 1801, that is. And it‚Äôs not like in the old days, where an upgrade failure resulted in a slight headache and a bit of troubleshooting to find that little bit of config the documentation failed to mention. No, this one actively corrupts and removes your existing SCOM components, leaving you with the only option to restore from backups or start from scratch. Ugh!","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2016","slug":"ms/opsmgr2016","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2016/"}],"tags":[{"name":"OpsMgr 1801","slug":"OpsMgr-1801","permalink":"https://www.teknoglot.se/tag/OpsMgr-1801/"},{"name":"OpsMgr 2016","slug":"OpsMgr-2016","permalink":"https://www.teknoglot.se/tag/OpsMgr-2016/"},{"name":"Upgrade","slug":"Upgrade","permalink":"https://www.teknoglot.se/tag/Upgrade/"},{"name":"Issues","slug":"Issues","permalink":"https://www.teknoglot.se/tag/Issues/"},{"name":"Rant","slug":"Rant","permalink":"https://www.teknoglot.se/tag/Rant/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2016","slug":"ms/opsmgr2016","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2016/"}]},{"title":"#MSIgnite 2017: BRK1039 - Windows Server Software Defined","slug":"MSIgnite-2017-BRK1039-Windows-Server-Software-Defined","date":"2017-09-26T08:23:13.000Z","updated":"2017-09-28T22:16:40.000Z","comments":true,"path":"Events/MSIgnite-2017/MSIgnite-2017-BRK1039-Windows-Server-Software-Defined/","link":"","permalink":"https://www.teknoglot.se/Events/MSIgnite-2017/MSIgnite-2017-BRK1039-Windows-Server-Software-Defined/","excerpt":"BRK1039 - Windows Server Software DefinedThe fastest route to the benefits of hyper-converged infrastructure WinSrv 2016, ‚ÄúMost cloud ready OS‚Äù, ‚ÄúSecurity‚Äù etc Talking about how WS2016 makes it possible to define Network, Compute and Storage in software, as virtual machines/Applicances. WSSDMicrosoft defines reference architecture, Solution vendors make and certify hardware packages, customers use and get rekommendations from Microsoft and vendors. Benefits Pre-validated Partner validated against reference architecture Time to value Up and running quickly Optimized OOB Less guesswork Tuned for the hardware solution Hardware Choice Select best match from vendors Converged StorageVMs on SMB3 on S2D on SOFS Cluster","text":"BRK1039 - Windows Server Software DefinedThe fastest route to the benefits of hyper-converged infrastructure WinSrv 2016, ‚ÄúMost cloud ready OS‚Äù, ‚ÄúSecurity‚Äù etc Talking about how WS2016 makes it possible to define Network, Compute and Storage in software, as virtual machines/Applicances. WSSDMicrosoft defines reference architecture, Solution vendors make and certify hardware packages, customers use and get rekommendations from Microsoft and vendors. Benefits Pre-validated Partner validated against reference architecture Time to value Up and running quickly Optimized OOB Less guesswork Tuned for the hardware solution Hardware Choice Select best match from vendors Converged StorageVMs on SMB3 on S2D on SOFS Cluster Hyper-ConvergedVM on S2D SOFS ClusterSimpler management and deployment, all contained in each ‚Äúbox‚Äù. Cloud-Inspored Infrastructure Functionality Hyper-Converged Standard Hyper-Converged Premium Converged SDS Security Y Y Y SDN N Y N Networking Y Y Y Compute Y Y N Storage Y Y Y Server Y Y Y Key Use Cases Low-cost high-performance storage FileServer, Hyper-V, Databases, Media streaming, High-throughput data ingestion Infrastructure for VM Enterprise Apps, VDI, Hosting, IT Infrastructure aka Fabric SQL Server Databases Backup/Archive Some of the examples given in this section looks less like Hyper-Converged and more like a tad smarter file clusters. WSSD reference architecture Design Overview Hardware Requirements Expansion Server Hardware Server and Cluster Configuration Net Configuration Storage Configuration Security Configuration Then, from requested or required workload, decide what offering (Hyper-Converged Infrastructure or Converged) and design to use. Quality-Assurance - End to End Comp and System Certification IHV &amp; Server Vendor Win2016 Logo + SDDC Qualifiers Solution Validation Solution Vendor reference architecture Stress Quality-Assurance PCS - Private Cloud SimulatorCool, but can I run it myself? It is a public tool, but it might need a partner login to access, speaker was unsure. Speaker also suggested that, while it is possible for us to use the tool, it is not developed as a load-tester for any other than the WSSD solution developers. It would probably be better for us to stick to tools like VMFleet. Automated DeploymentThis is offered by WSSD Partner, although Microsoft has a DSC-kit prepared. Customer ‚Äúdemo‚Äù Moving from Server Cluster + iSCSI Mostly File Servers and SQL Maxed out at 15000 IOPS Latency spikes of 50-100ms (ouch) Went to: S2D Hyper-Converged Infrastructure Hyper-V + Storage on the same node Simple Fault tolerant Good performance Lower costs Opted for DataOn S2d-3216 Tested with VMFleet 2225479 IOPS 6,6MB/s throughput 0.99 Microsoft latency These tested numbers have held true when in production as well. Personal ReflectionsAgain, very little real world talk. It‚Äôs all happy-sunshine-candyland. I have customers that are testing HCI, and from them I know that there is some things you really have to think about to succeed. It would be nice to hear what parts of the WSSD-rollout was super easy and a little on what popped up as ‚Äúgotchas‚Äù. All these IOPS gains; are they from the S2D clusters or mainly from going from SAS/SATA to SSD? Not sure what kind of disks they had before and what performance the could have gotten from simply upgrading their storage.","categories":[{"name":"Events","slug":"Events","permalink":"https://www.teknoglot.se/topics/Events/"},{"name":"MSIgnite 2017","slug":"Events/MSIgnite-2017","permalink":"https://www.teknoglot.se/topics/Events/MSIgnite-2017/"}],"tags":[{"name":"MSIgnite","slug":"MSIgnite","permalink":"https://www.teknoglot.se/tag/MSIgnite/"},{"name":"Presentation Notes","slug":"Presentation-Notes","permalink":"https://www.teknoglot.se/tag/Presentation-Notes/"},{"name":"Hyper-Converged","slug":"Hyper-Converged","permalink":"https://www.teknoglot.se/tag/Hyper-Converged/"},{"name":"WSSD","slug":"WSSD","permalink":"https://www.teknoglot.se/tag/WSSD/"}],"keywords":[{"name":"Events","slug":"Events","permalink":"https://www.teknoglot.se/topics/Events/"},{"name":"MSIgnite 2017","slug":"Events/MSIgnite-2017","permalink":"https://www.teknoglot.se/topics/Events/MSIgnite-2017/"}]},{"title":"#MSIgnite 2017: GS01 - Microsoft for the Modern Data Estate","slug":"MSIgnite-2017-GS01-Microsoft-for-the-Modern-Data-Estate","date":"2017-09-25T13:34:36.000Z","updated":"2017-09-28T17:25:58.000Z","comments":true,"path":"Events/MSIgnite-2017/MSIgnite-2017-GS01-Microsoft-for-the-Modern-Data-Estate/","link":"","permalink":"https://www.teknoglot.se/Events/MSIgnite-2017/MSIgnite-2017-GS01-Microsoft-for-the-Modern-Data-Estate/","excerpt":"GS01 - Microsoft for the modern data estateSep 25, 2:15 pm ‚Äì 3:30 pm Quick Notes Massive and growing amounts of data. Companies that out-develop themselves. Some companies have learned to leverage and gain from the data, like Honeywell, DocuSign and Jet. Hybrid is the way to go. Quick hands-up: Almost no companies believe all-public is even possible Almost all see a hybrid solution is the thing. SQL 2017 GA 2017-10-02: Available on: Windows Linux Docker Kubernetes‚Ä¶ *applause* Gives superb compatibility over many platforms and distributions. 2+ million docker pulls. Lots of focus on performance and security. has the smallest amount of vulnerabilities. Only commercial dB with AI built in. R and Python support OOB. BI included in license; web, desktop and mobile. Support for graph data and queries. Advanced machine learning with R + Python. Native TSQL scoring. Adaptive query processing and Automatic plan correction. Special pricing (30%) for SQL on Red hat Azure SQL Managed Instance Like a SQL instance on premise, in the cloud. without the server. Easy to migrate as it‚Äôs the same thing. Management using the same tools as always. SQL SA customers get discounts on Azure SQL. Other stuff Vulnerability assessment for GDPR. Intelligent insights into performance.","text":"GS01 - Microsoft for the modern data estateSep 25, 2:15 pm ‚Äì 3:30 pm Quick Notes Massive and growing amounts of data. Companies that out-develop themselves. Some companies have learned to leverage and gain from the data, like Honeywell, DocuSign and Jet. Hybrid is the way to go. Quick hands-up: Almost no companies believe all-public is even possible Almost all see a hybrid solution is the thing. SQL 2017 GA 2017-10-02: Available on: Windows Linux Docker Kubernetes‚Ä¶ *applause* Gives superb compatibility over many platforms and distributions. 2+ million docker pulls. Lots of focus on performance and security. has the smallest amount of vulnerabilities. Only commercial dB with AI built in. R and Python support OOB. BI included in license; web, desktop and mobile. Support for graph data and queries. Advanced machine learning with R + Python. Native TSQL scoring. Adaptive query processing and Automatic plan correction. Special pricing (30%) for SQL on Red hat Azure SQL Managed Instance Like a SQL instance on premise, in the cloud. without the server. Easy to migrate as it‚Äôs the same thing. Management using the same tools as always. SQL SA customers get discounts on Azure SQL. Other stuff Vulnerability assessment for GDPR. Intelligent insights into performance. DEMO: Patient intake, millisecond calculation of estimated stay based on history of patient and similar cases. Azure DB for MySQL and PostgreSQL. Supports HA etc.","categories":[{"name":"Events","slug":"Events","permalink":"https://www.teknoglot.se/topics/Events/"},{"name":"MSIgnite 2017","slug":"Events/MSIgnite-2017","permalink":"https://www.teknoglot.se/topics/Events/MSIgnite-2017/"}],"tags":[{"name":"MSIgnite","slug":"MSIgnite","permalink":"https://www.teknoglot.se/tag/MSIgnite/"},{"name":"Presentation Notes","slug":"Presentation-Notes","permalink":"https://www.teknoglot.se/tag/Presentation-Notes/"},{"name":"SQL 2017","slug":"SQL-2017","permalink":"https://www.teknoglot.se/tag/SQL-2017/"},{"name":"Machine Learning","slug":"Machine-Learning","permalink":"https://www.teknoglot.se/tag/Machine-Learning/"},{"name":"SQL on Linux","slug":"SQL-on-Linux","permalink":"https://www.teknoglot.se/tag/SQL-on-Linux/"}],"keywords":[{"name":"Events","slug":"Events","permalink":"https://www.teknoglot.se/topics/Events/"},{"name":"MSIgnite 2017","slug":"Events/MSIgnite-2017","permalink":"https://www.teknoglot.se/topics/Events/MSIgnite-2017/"}]},{"title":"#MSIgnite 2017: TK01 - Create a Modern Workplace with Microsoft 365","slug":"MSIgnite-2017-TK01-Create-a-Modern-Workplace-with-Microsoft-365","date":"2017-09-25T10:17:15.000Z","updated":"2017-09-28T17:25:58.000Z","comments":true,"path":"Events/MSIgnite-2017/MSIgnite-2017-TK01-Create-a-Modern-Workplace-with-Microsoft-365/","link":"","permalink":"https://www.teknoglot.se/Events/MSIgnite-2017/MSIgnite-2017-TK01-Create-a-Modern-Workplace-with-Microsoft-365/","excerpt":"TK01 - Create a modern workplace with Microsoft 365Sep 25, 10:45 am ‚Äì 12:15 pm UNSTRUCTURED NOTES AWARENESS NOTICE!Also written on phone, will come back and refine Arrived late due to escalators being bottlenecks.Something about 3d objects in office, PowerPoint.Showing a photo with mixed reality, rotating 3d-space. OfficeWindows Inkdeleting stuff with pen, highlights etcSeems fairly intuitive. Would like to test soon. Wordaccessibility, colour blindness, proofing with patterns.language improvements. suggestions about better wordings. ExcelConnects to external data sources, trying to figure out context and provide help.","text":"TK01 - Create a modern workplace with Microsoft 365Sep 25, 10:45 am ‚Äì 12:15 pm UNSTRUCTURED NOTES AWARENESS NOTICE!Also written on phone, will come back and refine Arrived late due to escalators being bottlenecks.Something about 3d objects in office, PowerPoint.Showing a photo with mixed reality, rotating 3d-space. OfficeWindows Inkdeleting stuff with pen, highlights etcSeems fairly intuitive. Would like to test soon. Wordaccessibility, colour blindness, proofing with patterns.language improvements. suggestions about better wordings. ExcelConnects to external data sources, trying to figure out context and provide help. TeamworkTeams and Groups Seen as the starting point for teams New back end for Skype Teams become the core client, eventually replacing Skype for business client. SharePoint and OneDrive Mobile-ready, responsive, webpages from SharePoint Integrates with PowerApps and Flow Files on demand, access files without the need for local space. Mobile outlook some sort of ‚Äúhelp‚Äù to flag messages that might be fraudulent Cortana intelligence to find stuff, like good times for meetings @mentions in office comments Surface hub whiteboard with intelligent canvas recognizes shapes, convert rectangles to tables, edit columns and rows, multiple editors realtime Teams Now with guest access! Access control and MFA Team meetings, recorded and replayable OneDrive OneDrive integrated into Windows kernel Status icons provide information about online status of files Yammer With stream, realtime translations etc Yammer comments within stream with analytics Windows Auto Pilot configures security profiles, networks, settings, profiles etc Better Windows analytics, AI backed. improves categorization and troubleshooting Cloud based, no need for corporate network connection Upgrade analysis, Windows, apps, and office plugins. Other notes simpler migration of programs to Azure apps Windows desktop bridge for backwards compatibility MS Security graph GDPR Compliance Manager analyses and gives a compliance score based on policies. Also, New features Azure Advanced Threat Protection","categories":[{"name":"Events","slug":"Events","permalink":"https://www.teknoglot.se/topics/Events/"},{"name":"MSIgnite 2017","slug":"Events/MSIgnite-2017","permalink":"https://www.teknoglot.se/topics/Events/MSIgnite-2017/"}],"tags":[{"name":"MSIgnite","slug":"MSIgnite","permalink":"https://www.teknoglot.se/tag/MSIgnite/"},{"name":"Presentation Notes","slug":"Presentation-Notes","permalink":"https://www.teknoglot.se/tag/Presentation-Notes/"},{"name":"Office 365","slug":"Office-365","permalink":"https://www.teknoglot.se/tag/Office-365/"},{"name":"Microsoft 265","slug":"Microsoft-265","permalink":"https://www.teknoglot.se/tag/Microsoft-265/"},{"name":"Yammer","slug":"Yammer","permalink":"https://www.teknoglot.se/tag/Yammer/"},{"name":"Technical Keynote","slug":"Technical-Keynote","permalink":"https://www.teknoglot.se/tag/Technical-Keynote/"},{"name":"Microsoft Teams","slug":"Microsoft-Teams","permalink":"https://www.teknoglot.se/tag/Microsoft-Teams/"},{"name":"SharePoint","slug":"SharePoint","permalink":"https://www.teknoglot.se/tag/SharePoint/"},{"name":"Advanced Threat Protection","slug":"Advanced-Threat-Protection","permalink":"https://www.teknoglot.se/tag/Advanced-Threat-Protection/"},{"name":"OneDrive","slug":"OneDrive","permalink":"https://www.teknoglot.se/tag/OneDrive/"},{"name":"Windows","slug":"Windows","permalink":"https://www.teknoglot.se/tag/Windows/"}],"keywords":[{"name":"Events","slug":"Events","permalink":"https://www.teknoglot.se/topics/Events/"},{"name":"MSIgnite 2017","slug":"Events/MSIgnite-2017","permalink":"https://www.teknoglot.se/topics/Events/MSIgnite-2017/"}]},{"title":"#MSIgnite 2017: KEY01 - Vision Keynote","slug":"MSIgnite-2017-KEY01-Vision-Keynote","date":"2017-09-25T08:05:33.000Z","updated":"2017-09-28T17:25:58.000Z","comments":true,"path":"Events/MSIgnite-2017/MSIgnite-2017-KEY01-Vision-Keynote/","link":"","permalink":"https://www.teknoglot.se/Events/MSIgnite-2017/MSIgnite-2017-KEY01-Vision-Keynote/","excerpt":"KEY01 - Vision KeynoteSep 25, 9:00 am ‚Äì 10:00 am UNSTRUCTURED NOTES! Also, mixed Swedish and English, sorry for that.Will update at a later time O365, all in one place‚Ä¶Live s√§ndning med AI √∂vers√§ttning.What‚Äôs the actual purpose of technology, why do we do this? How can we use it to do better. how to ensure privacy while at it.how do we give the power of technology to everyone?Assume everything will be multi device.serverless computing, edge distribution, management.Empower, Engage, Optimize, Transform. Microsoft 365 (not Office).Mixed reality. Holo lens, Oasis Headsets.Holo lens cameras for presentation, on github.Notes saved with spatial information for review.Microsoft mixed reality headsets.Conversations can be replayed and reviewed in teams. Microsoft graph is extensible, for example with LinkedIn.Outlook connected LimkedIn, better searches for‚Ä¶ everything?Bing for business, can search graph as well.Nice integration with any applications extending graph. Pairs well with machine learning and AI/Fuzzy Search to parse both data and meta data on context. Admin portal gives insight and analytics into what‚Äôs searched for further optimization. Also connects with Cortana. Business applicationsDynamics 365. Also extends graph.AI First. Virtual Agent demo. App&amp;Infra / AIAzure. Intelligent Cloud, intelligent creativity.Machine reading and comprehension. Quantum computing‚Ä¶ ?MS seems to be trying hard to build one.VS gets tools for developing and debugging and testing qbits.","text":"KEY01 - Vision KeynoteSep 25, 9:00 am ‚Äì 10:00 am UNSTRUCTURED NOTES! Also, mixed Swedish and English, sorry for that.Will update at a later time O365, all in one place‚Ä¶Live s√§ndning med AI √∂vers√§ttning.What‚Äôs the actual purpose of technology, why do we do this? How can we use it to do better. how to ensure privacy while at it.how do we give the power of technology to everyone?Assume everything will be multi device.serverless computing, edge distribution, management.Empower, Engage, Optimize, Transform. Microsoft 365 (not Office).Mixed reality. Holo lens, Oasis Headsets.Holo lens cameras for presentation, on github.Notes saved with spatial information for review.Microsoft mixed reality headsets.Conversations can be replayed and reviewed in teams. Microsoft graph is extensible, for example with LinkedIn.Outlook connected LimkedIn, better searches for‚Ä¶ everything?Bing for business, can search graph as well.Nice integration with any applications extending graph. Pairs well with machine learning and AI/Fuzzy Search to parse both data and meta data on context. Admin portal gives insight and analytics into what‚Äôs searched for further optimization. Also connects with Cortana. Business applicationsDynamics 365. Also extends graph.AI First. Virtual Agent demo. App&amp;Infra / AIAzure. Intelligent Cloud, intelligent creativity.Machine reading and comprehension. Quantum computing‚Ä¶ ?MS seems to be trying hard to build one.VS gets tools for developing and debugging and testing qbits.","categories":[{"name":"Events","slug":"Events","permalink":"https://www.teknoglot.se/topics/Events/"},{"name":"MSIgnite 2017","slug":"Events/MSIgnite-2017","permalink":"https://www.teknoglot.se/topics/Events/MSIgnite-2017/"}],"tags":[{"name":"MSIgnite","slug":"MSIgnite","permalink":"https://www.teknoglot.se/tag/MSIgnite/"},{"name":"Presentation Notes","slug":"Presentation-Notes","permalink":"https://www.teknoglot.se/tag/Presentation-Notes/"}],"keywords":[{"name":"Events","slug":"Events","permalink":"https://www.teknoglot.se/topics/Events/"},{"name":"MSIgnite 2017","slug":"Events/MSIgnite-2017","permalink":"https://www.teknoglot.se/topics/Events/MSIgnite-2017/"}]},{"title":"Set-SCOMMaintenanceMode Deluxe ed. [#opsmgr #powershell]","slug":"Set-SCOMMaintenanceModeDeluxe","date":"2016-10-12T22:21:03.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2012/Set-SCOMMaintenanceModeDeluxe/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2012/Set-SCOMMaintenanceModeDeluxe/","excerpt":"Untimely, perhapsWhile most of us are waiting for SCOM 2016 RTM to be generally available i‚Äôve completely forgot to blog about my little Set-SCOMMaintenanceModeDeluxe.ps1 script I wrote a while ago. It is pretty much a small extension to the regular Set-SCOMMaintenanceMode cmdlet that allows you to set Computers, Groups or specific Windows Services into maintenance mode.I have yet to make it a proper module (although I have promised myself to do so) so you‚Äôd still have to manually download the script and execute it the old-fashioned way. I‚Äôve uploaded it as a public gist on github, so feel free to add adapt it to your needs. Here‚Äôs the gist","text":"Untimely, perhapsWhile most of us are waiting for SCOM 2016 RTM to be generally available i‚Äôve completely forgot to blog about my little Set-SCOMMaintenanceModeDeluxe.ps1 script I wrote a while ago. It is pretty much a small extension to the regular Set-SCOMMaintenanceMode cmdlet that allows you to set Computers, Groups or specific Windows Services into maintenance mode.I have yet to make it a proper module (although I have promised myself to do so) so you‚Äôd still have to manually download the script and execute it the old-fashioned way. I‚Äôve uploaded it as a public gist on github, so feel free to add adapt it to your needs. Here‚Äôs the gist","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2012","slug":"ms/opsmgr2012","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2012/"}],"tags":[{"name":"Powershell","slug":"Powershell","permalink":"https://www.teknoglot.se/tag/Powershell/"},{"name":"OpsMgr 2012 R2","slug":"OpsMgr-2012-R2","permalink":"https://www.teknoglot.se/tag/OpsMgr-2012-R2/"},{"name":"Gist","slug":"Gist","permalink":"https://www.teknoglot.se/tag/Gist/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2012","slug":"ms/opsmgr2012","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2012/"}]},{"title":"Resize all images in a Word document with #vbs #macro","slug":"Resize-all-images-in-a-Word-document-with-vbs-macro","date":"2016-07-05T20:08:26.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"code/vbs/Resize-all-images-in-a-Word-document-with-vbs-macro/","link":"","permalink":"https://www.teknoglot.se/code/vbs/Resize-all-images-in-a-Word-document-with-vbs-macro/","excerpt":"TLDRQuick and dirty macro to resize all images in a word document to 145 mm. I am lazy like that. Get the gist of it here. The ‚ÄúWhy‚ÄùOk, so. I am a consultant, as you may know. And as a consultant, people pay me to do stuff and expect me to be efficient and deliver with high quality.Part of that entails writing documentation containing how I do stuff, where I do it and often why I do it.This documentation is expected to be detailed enough to make sure my customers will be able to follow the steps and produce a copy of my work. Most of the timethese document are a big part of the disaster recovery processes and might have to be executed by the on-call staff with no previous knowledge of the product. This means screenshots. Lots of screenshots.And while templates are nice and help me out a lot, the screenshots have to be from the actual installation and not some copy-pasta from a previous assignment.To help me out, I use the excellent free program Greenshot to quickly generate screenshots into a WIP-folder (or directly into Word if that is appropriate) and that makes it possible tograb snapshots of the process without having to pause all the time to PrtScn-Alt+Tab-Ctrl+V-Crop-Ctrl+C-Alt+Tab-Ctrl+C. I simply press PrtScn and go on with the installation. Being a bit pedantic, doesn‚Äôt help me out here though as I find myself selecting and resizing all the images in the Word document I have produced. This is a very time-consuming process and not the most exact one either.I want all images to be of scaled, if necessary, to an equal maximum width that fits comfortably withing the margins of the document template my company has prepared for me. So I created a fairly simple macro to do it for me. The ‚ÄúHow‚ÄùIf you are un-familiar with macros in Word, you will find them under the ‚ÄúView‚Äù tab.Clicking on ‚ÄúMacros‚Äù will give you the option to execute the ones you have, or you can create your own using VBA (Visual Basic for Applications).To create one, select where you want it saved (normal.dotx in my case, as I want it readily available) and enter a name for it.This will bring up the Visual Basic for Applications IDE, where you can write your own fun stuff.","text":"TLDRQuick and dirty macro to resize all images in a word document to 145 mm. I am lazy like that. Get the gist of it here. The ‚ÄúWhy‚ÄùOk, so. I am a consultant, as you may know. And as a consultant, people pay me to do stuff and expect me to be efficient and deliver with high quality.Part of that entails writing documentation containing how I do stuff, where I do it and often why I do it.This documentation is expected to be detailed enough to make sure my customers will be able to follow the steps and produce a copy of my work. Most of the timethese document are a big part of the disaster recovery processes and might have to be executed by the on-call staff with no previous knowledge of the product. This means screenshots. Lots of screenshots.And while templates are nice and help me out a lot, the screenshots have to be from the actual installation and not some copy-pasta from a previous assignment.To help me out, I use the excellent free program Greenshot to quickly generate screenshots into a WIP-folder (or directly into Word if that is appropriate) and that makes it possible tograb snapshots of the process without having to pause all the time to PrtScn-Alt+Tab-Ctrl+V-Crop-Ctrl+C-Alt+Tab-Ctrl+C. I simply press PrtScn and go on with the installation. Being a bit pedantic, doesn‚Äôt help me out here though as I find myself selecting and resizing all the images in the Word document I have produced. This is a very time-consuming process and not the most exact one either.I want all images to be of scaled, if necessary, to an equal maximum width that fits comfortably withing the margins of the document template my company has prepared for me. So I created a fairly simple macro to do it for me. The ‚ÄúHow‚ÄùIf you are un-familiar with macros in Word, you will find them under the ‚ÄúView‚Äù tab.Clicking on ‚ÄúMacros‚Äù will give you the option to execute the ones you have, or you can create your own using VBA (Visual Basic for Applications).To create one, select where you want it saved (normal.dotx in my case, as I want it readily available) and enter a name for it.This will bring up the Visual Basic for Applications IDE, where you can write your own fun stuff. This little macro of mine is saved as a .bas file, which means I can import it into VBA by right-clicking the navigation and selecting ‚ÄúImport file‚Ä¶‚Äù.By doing that, and saving my changes, it is now available to me in any other word document, given that I saved it into the global template. The MacroI‚Äôve put it up on a public gist for anyone interested.It is, currently, very specific for my templates but it‚Äôs very easy to modify it to set images to a different size than 145 mm wide.Give it a little love, and we could add options for width as well, but I dont need that right now. And for those who don‚Äôt want to travel all the way to Github, here‚Äôs the script in it‚Äôs current form.","categories":[{"name":"Code","slug":"code","permalink":"https://www.teknoglot.se/topics/code/"},{"name":"VBS","slug":"code/vbs","permalink":"https://www.teknoglot.se/topics/code/vbs/"}],"tags":[{"name":"VBScript","slug":"VBScript","permalink":"https://www.teknoglot.se/tag/VBScript/"},{"name":"Macro","slug":"Macro","permalink":"https://www.teknoglot.se/tag/Macro/"},{"name":"Word","slug":"Word","permalink":"https://www.teknoglot.se/tag/Word/"},{"name":"Office","slug":"Office","permalink":"https://www.teknoglot.se/tag/Office/"}],"keywords":[{"name":"Code","slug":"code","permalink":"https://www.teknoglot.se/topics/code/"},{"name":"VBS","slug":"code/vbs","permalink":"https://www.teknoglot.se/topics/code/vbs/"}]},{"title":"PoSH Grid Dashboard for RDSH [#opsmgr]","slug":"PoSH-Grid-Dashboard-for-RDSH","date":"2016-06-13T22:01:27.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2012/PoSH-Grid-Dashboard-for-RDSH/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2012/PoSH-Grid-Dashboard-for-RDSH/","excerpt":"TLDRCustomer wanted to see all RDS Host servers in a view with their current total session count. Decided to use a powershell grid dashboard, and share the script. Here‚Äôs the gist of it: SCOM_RDSH_TotalSession_PoSHWidget.ps1 How ToKeeping it fairly short this time. Pre-requisites are: System Center 2012 R2 with UR2 or later Microsoft RDS Management Pack Microsoft Windows Core OS Management Pack Create a dashboard Rightclick and create a new view somewhere, make it a Dashboard View Enter Name and Description Select Grid type, and layout","text":"TLDRCustomer wanted to see all RDS Host servers in a view with their current total session count. Decided to use a powershell grid dashboard, and share the script. Here‚Äôs the gist of it: SCOM_RDSH_TotalSession_PoSHWidget.ps1 How ToKeeping it fairly short this time. Pre-requisites are: System Center 2012 R2 with UR2 or later Microsoft RDS Management Pack Microsoft Windows Core OS Management Pack Create a dashboard Rightclick and create a new view somewhere, make it a Dashboard View Enter Name and Description Select Grid type, and layout Add a widget Click cog on grid view Select Powershell Grid Widget Set Name and Description Paste your script into the script box Save The Script# Based on https://gallery.technet.microsoft.com/Retrieve-Performance-Data-c4595e2a#contentfunction Add-Criteria()&#123; param($criteria,$clause) if ($criteria -ne $null) &#123;$criteria += \" AND $clause\"&#125; else &#123;$criteria = $clause&#125; return($criteria)&#125;$rdsClass = Get-SCOMClass -Name \"Microsoft.Windows.Server.2012.R2.RemoteDesktopServicesRole.Service.RDSessionHost\"$rdsHosts = Get-SCOMMonitoringObject -Class $rdsClass | Sort-Object -Property '[Microsoft.Windows.Computer].PrincipalName'$rdsTotalSessionRule = Get-SCOMRule -Name \"Microsoft.Windows.Server.2012.R2.RemoteDesktopServicesRole.Service.RDSessionHost.PerformanceCollection.TotalSessions\"$objectName = \"Terminal Services\"$counterName = \"Total Sessions\"$InstanceName = \"\"$i=0foreach ($rdsHost in $rdsHosts) &#123; # Build performance criteria if ($rdsClass -ne $null) &#123; $criteria = Add-Criteria -criteria $criteria -clause \"MonitoringClassId = '&#123;$($rdsClass.Id)&#125;'\" &#125; if ($rdsHost -ne $null) &#123; $criteria = Add-Criteria -criteria $criteria -clause \"MonitoringObjectFullName = '$($rdsHost.FullName)'\" &#125; if ($objectName -ne $null) &#123; $criteria = Add-Criteria -criteria $criteria -clause \"ObjectName = '$objectName'\" &#125; if ($counterName -ne $null) &#123; $criteria = Add-Criteria -criteria $criteria -clause \"CounterName = '$counterName'\" &#125; #$criteria # Get Performance reader object. $perfReader = (Get-SCOMManagementGroup).GetMonitoringPerformanceDataReader($criteria) while ($perfReader.Read()) &#123; $perfData = $perfReader.GetMonitoringPerformanceData() $perfValueReader = $perfData.GetValueReader(((Get-Date).AddMinutes(-180)),(Get-Date)) $perfValues = @() while ($perfValueReader.Read()) &#123; $perfValues += $perfValueReader.GetMonitoringPerformanceDataValue() &#125; $perfValue = $perfValues | Sort-Object -Property TimeSampled | select -Last 1 $dataObject = $ScriptContext.CreateInstance(\"xsd://stegenfeldt/nullschema\") $dataObject = $ScriptContext.CreateFromObject($rdsHost, \"Id=Id,Health=HealthState,Host=Path\", $null) $dataObject[\"Time Sampled\"] = $perfValue.TimeSampled $dataObject[\"Total Sessions\"] = $perfValue.SampleValue $ScriptContext.ReturnCollection.Add($dataObject) &#125; $criteria = $null ++$i&#125;","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2012","slug":"ms/opsmgr2012","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2012/"}],"tags":[{"name":"Powershell","slug":"Powershell","permalink":"https://www.teknoglot.se/tag/Powershell/"},{"name":"OpsMgr 2012 R2","slug":"OpsMgr-2012-R2","permalink":"https://www.teknoglot.se/tag/OpsMgr-2012-R2/"},{"name":"HowTo","slug":"HowTo","permalink":"https://www.teknoglot.se/tag/HowTo/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2012","slug":"ms/opsmgr2012","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2012/"}]},{"title":"In transit, again","slug":"in-transit-again","date":"2016-06-01T19:03:35.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"tb/in-transit-again/","link":"","permalink":"https://www.teknoglot.se/tb/in-transit-again/","excerpt":"We‚Äôre moving!Yep. Again. Although, it‚Äôs been a year or two since the last time. The reason(s)Ok, so I‚Äôve using Wordpress for quite a long time now and it‚Äôs been good. Mostly.It‚Äôs a fairly solid platform and has a whole slew of feautures that work nicely. Before Wordpress I used Textpattern, a very slimmed, minimalistic authoring experience and my first contact with textile andsimilar markup/writing/notation languages. For those unaware, textile is not unlike markdown.Or should we say that markdown is not unlike textile? Considering that textile was invented by Dean Allen two years before markdown.Anyhow. Both work pretty much as good as the other, allowing the author to write in any text-editor, using easily readable and fairly logical formatting. Before that I used Movable Type, and prior to that either Dreamweaver or‚Ä¶ well, notepad or vim. Problem with all of those platforms, however, is that they require dynamically generated webpages and technologies like PHP, Perl, .NET, Java and whatnot.That, in itself, has been a very minor issue until lately. Sure, it requires servers with logics, engines, add-ons, execution rights to the local filesystem etc, butstill a minor nuisance. Mostly a financial nuisance really as active servers tend to cost money while finding static hosting for free is still pretty easy.Hell! I could put a webserver on a RaspberryPi and get good performance for a small-ish blog like mine if all I am using is static content. But, again. Not a major problem in itself. The main instigating factors to move away from Wordpress are the increasing size of the package, the lack of personal control,the lack of ease to extend my platform due to ever-expanding APIs and the fact that it is so popular that every ‚Äúhacker‚Äù and it‚Äôs mother knows how to find exploits on it.My webhost, NFSN has been very good at detecting probing and brute-force attempts and automatically block public access to stuff like the login-pages and XML-RPC interfaces when that happens.I am just so sick and tired of having to constantly be on top of it with software updates, plugin updates, theme updates, security updates, spam-filtering, re-enabling the login page‚Ä¶ Back to the basicsTeknoglot.se will be served statically from now on, and it will be hosted for free on Github Pages.Using Hexo.io I can write my posts using markdown, then with a simple hexo generate --deploy generate and update the static files and publish them.No login pages to hack, no dynamic pages to exploit, no server security to worry about.","text":"We‚Äôre moving!Yep. Again. Although, it‚Äôs been a year or two since the last time. The reason(s)Ok, so I‚Äôve using Wordpress for quite a long time now and it‚Äôs been good. Mostly.It‚Äôs a fairly solid platform and has a whole slew of feautures that work nicely. Before Wordpress I used Textpattern, a very slimmed, minimalistic authoring experience and my first contact with textile andsimilar markup/writing/notation languages. For those unaware, textile is not unlike markdown.Or should we say that markdown is not unlike textile? Considering that textile was invented by Dean Allen two years before markdown.Anyhow. Both work pretty much as good as the other, allowing the author to write in any text-editor, using easily readable and fairly logical formatting. Before that I used Movable Type, and prior to that either Dreamweaver or‚Ä¶ well, notepad or vim. Problem with all of those platforms, however, is that they require dynamically generated webpages and technologies like PHP, Perl, .NET, Java and whatnot.That, in itself, has been a very minor issue until lately. Sure, it requires servers with logics, engines, add-ons, execution rights to the local filesystem etc, butstill a minor nuisance. Mostly a financial nuisance really as active servers tend to cost money while finding static hosting for free is still pretty easy.Hell! I could put a webserver on a RaspberryPi and get good performance for a small-ish blog like mine if all I am using is static content. But, again. Not a major problem in itself. The main instigating factors to move away from Wordpress are the increasing size of the package, the lack of personal control,the lack of ease to extend my platform due to ever-expanding APIs and the fact that it is so popular that every ‚Äúhacker‚Äù and it‚Äôs mother knows how to find exploits on it.My webhost, NFSN has been very good at detecting probing and brute-force attempts and automatically block public access to stuff like the login-pages and XML-RPC interfaces when that happens.I am just so sick and tired of having to constantly be on top of it with software updates, plugin updates, theme updates, security updates, spam-filtering, re-enabling the login page‚Ä¶ Back to the basicsTeknoglot.se will be served statically from now on, and it will be hosted for free on Github Pages.Using Hexo.io I can write my posts using markdown, then with a simple hexo generate --deploy generate and update the static files and publish them.No login pages to hack, no dynamic pages to exploit, no server security to worry about. Hexo is built using node.js, which I have installed for other reasons anyway, and since the actual website is build from a git repository I obviously have proper versioning on everything I do per default. There‚Äôs obviously not as many plugins, helpers, themes and features available as in Wordpress. And blogging will require some command-line stuff.But I am totally fine with that. I means I can write offline, generate offline to preview. And when finished, push to the public repo. But, comments?Using Disqus. All client-side.You need javascript, obviously, but I don‚Äôt see me losing many readers for that to be frank. ;) The kinksNo, not the band. The stuff I have missed while migrating the posts from Wordpress to Hexo.Here‚Äôs what to expect. Permalinks may not workI have done my best to ensure that my old permalink structure from the old site is intact.Hexo have some limitations to categories though, meaning that I cannot yet have two main categories on the same post.This do affect those articles that were available through both /code/posh/my-post, /ms/scom2012/my-post.For those, I have had to pick one to be main and rely on tags to group stuff more freely. Code-highlight artefactsWordpress highlight plugins and markdown have different syntax, and the migration plugin did not handle that.This means that you might find a few [powershell], [sql] or [plain] tags littered throughout the post for a while.If you spot one, do comment to let me know. But I will try to convert them all as I find them. Images and galleriesNot sure I ever used a gallery, but some images may be missing as I have to migrate them manually and I am absolutely certain that I have missed at least one. Maybe two. ^That‚Äôs ^a ^joke. Once again, if you find a missing one you are welcome to post a comment to let me know. SeriesNope, no such thing in Hexo at the moment.May be able to use some other structure, but for now it will be normal posts with links. Probably missing a few there as well. Post tabsAlso not available in Hexo.I have converted those posts to regular posts. I am working on a proper TOC to make them easier to browse. LinksAs with the images, links I have created manually may point to old wordpress folders and have to be redirected.I know for a fact that I have missed a few. GraphicsUsing a new theme will take a few adaptations to logos and other graphics.This will change over time, so don‚Äôt laugh too hard. The Last WordThings be wonky. Have patience. Thanks!","categories":[{"name":"Technobabble","slug":"tb","permalink":"https://www.teknoglot.se/topics/tb/"}],"tags":[{"name":"Teknoglot","slug":"Teknoglot","permalink":"https://www.teknoglot.se/tag/Teknoglot/"},{"name":"Hexo","slug":"Hexo","permalink":"https://www.teknoglot.se/tag/Hexo/"},{"name":"Wordpress","slug":"Wordpress","permalink":"https://www.teknoglot.se/tag/Wordpress/"}],"keywords":[{"name":"Technobabble","slug":"tb","permalink":"https://www.teknoglot.se/topics/tb/"}]},{"title":"Event Id 4001 ‚Äì ‚ÄúCannot Add Type‚Äù in [#SQL] MP 6.6.4.0 for [#OpsMgr2012]","slug":"Event-Id-4001-‚Äì-‚ÄúCannot-Add-Type‚Äù-in-SQL-MP-6-6-4-0-for-OpsMgr2012","date":"2016-02-15T11:22:28.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2012/Event-Id-4001-‚Äì-‚ÄúCannot-Add-Type‚Äù-in-SQL-MP-6-6-4-0-for-OpsMgr2012/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2012/Event-Id-4001-‚Äì-‚ÄúCannot-Add-Type‚Äù-in-SQL-MP-6-6-4-0-for-OpsMgr2012/","excerpt":"Was troubleshooting this little error message for a customer after deploying the SQL Server Management Pack version 6.6.4.0. The event is the generic ‚ÄúHealth Service Script‚Äù with id 4001. Management Group: REDACTED. Script: Main Module: CPUUsagePercentDataSource.ps1 :Computer Name = &quot;REDACTED.redacted.com&quot; WMI = &quot;ComputerManagement11&quot; Service Name = &quot;MSSQLSERVER&quot; SQL Instance Name = &quot;MSSQLSERVER&quot;Error occured during CPU Usage for SQL Instances data source executing.Computer: REDACTEDReason: Cannot add type. Compilation errors occurred.Position:256Offset:21Detailed error output: Cannot add type. Compilation errors occurred.--------(0) : No source files specified(1) : using System;--------(0) : Source file &quot;C:\\Windows\\TEMP\\njdqtgfb.0.cs&quot; could not be found(1) : using System; There are some known errors to the 6.6.4.0 version of the SQL management packs, and one of them does mention ‚ÄúCannot add type. Compilation errors occured.‚ÄùIn a thread on the Technet Forums it was suggested that it has to do with rights, but focusing mainly on the SQL instance. What caught our eyes, however, was the fact that the script is using the C:\\Windows\\TEMP folder instead of its private one. And this seems to be because it is using a few .Net components that do some sort of JIT compilation.We took a quick look using procmon, filtered on C:\\Windows\\TEMP\\ and yes indeed. The monitoring account used is trying to create and delete its temporary files in that very folder. A wild work-around appears!The work-around is simple, but cumbersome. Just make sure that the assigned RunAs account have read/write/delete rights on C:\\Windows\\TEMP.Now you just have to manage this on all your SQL-servers! (yaaaay)","text":"Was troubleshooting this little error message for a customer after deploying the SQL Server Management Pack version 6.6.4.0. The event is the generic ‚ÄúHealth Service Script‚Äù with id 4001. Management Group: REDACTED. Script: Main Module: CPUUsagePercentDataSource.ps1 :Computer Name = &quot;REDACTED.redacted.com&quot; WMI = &quot;ComputerManagement11&quot; Service Name = &quot;MSSQLSERVER&quot; SQL Instance Name = &quot;MSSQLSERVER&quot;Error occured during CPU Usage for SQL Instances data source executing.Computer: REDACTEDReason: Cannot add type. Compilation errors occurred.Position:256Offset:21Detailed error output: Cannot add type. Compilation errors occurred.--------(0) : No source files specified(1) : using System;--------(0) : Source file &quot;C:\\Windows\\TEMP\\njdqtgfb.0.cs&quot; could not be found(1) : using System; There are some known errors to the 6.6.4.0 version of the SQL management packs, and one of them does mention ‚ÄúCannot add type. Compilation errors occured.‚ÄùIn a thread on the Technet Forums it was suggested that it has to do with rights, but focusing mainly on the SQL instance. What caught our eyes, however, was the fact that the script is using the C:\\Windows\\TEMP folder instead of its private one. And this seems to be because it is using a few .Net components that do some sort of JIT compilation.We took a quick look using procmon, filtered on C:\\Windows\\TEMP\\ and yes indeed. The monitoring account used is trying to create and delete its temporary files in that very folder. A wild work-around appears!The work-around is simple, but cumbersome. Just make sure that the assigned RunAs account have read/write/delete rights on C:\\Windows\\TEMP.Now you just have to manage this on all your SQL-servers! (yaaaay)","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2012","slug":"ms/opsmgr2012","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2012/"}],"tags":[],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2012","slug":"ms/opsmgr2012","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2012/"}]},{"title":"OpsMgr 2012 R2 UR4 - Field Notes [#opsmgr]","slug":"opsmgr-2012-r2-ur4-field-notes","date":"2014-10-30T10:41:47.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2012/opsmgr-2012-r2-ur4-field-notes/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2012/opsmgr-2012-r2-ur4-field-notes/","excerpt":"Quick and unrefined notes on Update Roll-up 4 for System Center 2012 R2 -Operations Manager PreparationThe usual routine applies. Check the KB for instructions and take not ofknown issues. Check if Kevin Holman has written something about it. As thisis an update roll up, I pre-emptively expect that gotchas in UR3 mayapply. Remember to open the update catalog in IE as the downloader is notworking in other browsers. Download, unpack, toss what languages that does not apply to your organization. It is advised to disable any mail-generating alert subscriptions during theupgrade process to avoid unnecessary spammage. Issues - So Far[updated: 2014-11-03] Got a few problems with cross-platform monitoring templates not working after the update. This was due to missing files in the update package. Make sure you download the updated version! Have not updated a customer using gateways yet, so unless theyhave fixed the issues in UR3, expect an update to this section soon. Planning","text":"Quick and unrefined notes on Update Roll-up 4 for System Center 2012 R2 -Operations Manager PreparationThe usual routine applies. Check the KB for instructions and take not ofknown issues. Check if Kevin Holman has written something about it. As thisis an update roll up, I pre-emptively expect that gotchas in UR3 mayapply. Remember to open the update catalog in IE as the downloader is notworking in other browsers. Download, unpack, toss what languages that does not apply to your organization. It is advised to disable any mail-generating alert subscriptions during theupgrade process to avoid unnecessary spammage. Issues - So Far[updated: 2014-11-03] Got a few problems with cross-platform monitoring templates not working after the update. This was due to missing files in the update package. Make sure you download the updated version! Have not updated a customer using gateways yet, so unless theyhave fixed the issues in UR3, expect an update to this section soon. PlanningAs with all update roll-ups, you‚Äôve got a number of MSP files to install onthe different server roles, some SQL-scripts for the OpsDB and OpsDW and a fewupdated management packs. I‚Äôve updated the components in the following order. Management Servers (and consoles installed on them) SQL-Scripts Management Packs (might need an updated console for this) Consoles Gateway Servers Web Console Agents As usual, the first management server update takes the longest as that‚Äôswhen the process is updating the databases. You absolutely must wait for it tocomplete before updating anything else. Feel free to prepare the othermanagement servers by copying installations files, logging in and starting upyour command prompts as admin. I never update more than one management server atthe time anyway. Less to worry about that way. InstallationManagement ServersOpen a command prompt (powershell will work just fine) as Administrator andexecute the MSP-file. First management server will take some time, so bepatient. If a management server has multiple roles, you can update those whilelogged in as well. SQL-ScriptsThe installation package will unpack these scripts under %SystemDrive%\\Program Files\\System Center 2012 R2\\Operations Manager\\Server\\SQL Script for Update Rollups. Run the UR_Datawarehouse.sql one on the OpsDW first, then theUpdate_rollup_mom_db.sql on OpsDB. If you‚Äôre getting deadlocks, try again. Ifthat don‚Äôt help, stop the management server services and try again. Do notcontinue with the next script ‚Äãuntil you‚Äôve succeeded with the first. If you‚Äôve installed UR3, the OpsDW-script is pretty quick (not sure ifit‚Äôs changed at all) and the OpsDB is a bit less prone to deadlocks. Management PacksJust import the management packs from the %SystemDrive%\\Program Files\\SystemCenter 2012 R2\\Operations Manager\\Server\\Management Packs for Update Rollupsfolder. Might have to retry as the console can do a little poor job ofcalculating the dependencies. ConsoleThe easiest one, just install the MSP-file. GatewayInstallation is a breeze. Make sure to check %SystemDrive%\\Program Files\\System Center Operations Manager\\Gateway\\AgentManagement\\&lt;architecture&gt; for updatedagent files. If not, copy from same folder on any management server. Web ConsoleInstallation is very simple. Install the MSP from an administrative commandprompt. If you‚Äôre affected by KB911722 and need the web console fixes, youneed to edit %windir%\\Microsoft.NET\\Framework64\\v2.0.50727\\CONFIG\\web.configby adding the following line: &lt;machineKey validationKey=&quot;AutoGenerate,IsolateApps&quot; decryptionKey=&quot;AutoGenerate,IsolateApps&quot; validation=&quot;3DES&quot; decryption=&quot;3DES&quot;/&gt; AgentsNormal update procedure applies. Use ‚ÄúPending Management‚Äù, SCCM, manualinstallations or whatever method you‚Äôd like. SummaryIf you already have UR3, this one is very quick. If you are updating a freshinstallation, wait a day or your management group may end up uninitialized forreasons. Remember to enable your subscriptions when done. GLHF!","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2012","slug":"ms/opsmgr2012","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2012/"}],"tags":[{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"},{"name":"Field Notes","slug":"Field-Notes","permalink":"https://www.teknoglot.se/tag/Field-Notes/"},{"name":"Update Rollup","slug":"Update-Rollup","permalink":"https://www.teknoglot.se/tag/Update-Rollup/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2012","slug":"ms/opsmgr2012","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2012/"}]},{"title":"SquaredUp Installation - Manual? Pfffft! [#opsmgr #squaredup]","slug":"squaredup-installation","date":"2014-09-09T14:38:36.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2012/squaredup-installation/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2012/squaredup-installation/","excerpt":"Story-timeI saw SquaredUp some year or two ago while googling about on behalf of a customer looking for a dashboard kind of thingy. It looked good and fairly simple, but for some reason it never clicked with the customer and we ended up going for some custom-made dashboards with a little scripting and some DB-queries. I kind of liked the look of their product though and have kept an eye on them now and then.Fast-forward to may 21st this year and the release of version 1.8 and a whole slew of nifty little features. What specifically piqued my interest was the linked dashboards, SharePoint integration and the included SLA and Map plugins. This basically ticked a lot of boxes many of my customers have looked for and something we‚Äôve normally been looking into‚Ä¶ err‚Ä¶ other products for. That, coupled with some new videos on their Youtube-channel, a few well-placed tweets and a little mail-correspondence had me setting it up in my portable little lab. One of the interesting points is how, supposedly easy, it is to set the portal up. So I reset my lab ‚Äì PDT is just wonderful ‚Äì and decided to go for the hail-dummy approach. No manual, no preparations, no check-lists‚Ä¶ Next-next-next then hopefully a working portal. The InstallationFirst, download the installation file (yes, singular) through the link you‚Äôve got in your email and save it somewhere proper. Doubleclicked the installation packaged and it now tells me it will install a few pre-requisites and configure the website for me. Next! The EULA I am sure each one of you are reading. Next! Installing, or rather configuring, IIS and pre-requisites for me. Very nice. Next!","text":"Story-timeI saw SquaredUp some year or two ago while googling about on behalf of a customer looking for a dashboard kind of thingy. It looked good and fairly simple, but for some reason it never clicked with the customer and we ended up going for some custom-made dashboards with a little scripting and some DB-queries. I kind of liked the look of their product though and have kept an eye on them now and then.Fast-forward to may 21st this year and the release of version 1.8 and a whole slew of nifty little features. What specifically piqued my interest was the linked dashboards, SharePoint integration and the included SLA and Map plugins. This basically ticked a lot of boxes many of my customers have looked for and something we‚Äôve normally been looking into‚Ä¶ err‚Ä¶ other products for. That, coupled with some new videos on their Youtube-channel, a few well-placed tweets and a little mail-correspondence had me setting it up in my portable little lab. One of the interesting points is how, supposedly easy, it is to set the portal up. So I reset my lab ‚Äì PDT is just wonderful ‚Äì and decided to go for the hail-dummy approach. No manual, no preparations, no check-lists‚Ä¶ Next-next-next then hopefully a working portal. The InstallationFirst, download the installation file (yes, singular) through the link you‚Äôve got in your email and save it somewhere proper. Doubleclicked the installation packaged and it now tells me it will install a few pre-requisites and configure the website for me. Next! The EULA I am sure each one of you are reading. Next! Installing, or rather configuring, IIS and pre-requisites for me. Very nice. Next! Quick summary before actual installation. Next! This step actually requires a little action on your part. In this installation, the default setting ‚Äúlocalhost‚Äù would actually work but I prefer to actually configure these things properly. I only have a single Management Server in this lab, so testing a load-balanced highly available scenario was not possible. Enter Management Server name, then Next! After a slight case of progress-bar the installation is now complete. Click link and exit the installer. Time spent so far is less than ten minutes, probably closer to five.Now it‚Äôs time to login using your normal SCOM credentials. First login will bring you to the Activation Screen. Simply paste the activation key from the email and Activate. This requires a working internet connection. That‚Äôs it! Well‚Ä¶ not really. Navigating the portal I noticed that the spark-lines aren‚Äôt showing, and hitting the ‚ÄúView Performance‚Äù link on an object view gives me a ‚ÄúLogin failed for user‚Ä¶‚Äù error. I know I saw something about configuring the Data Warehouse in the email, so I check the blissfully simple Settings panel. Followed the instructions to configure the security of the OperationsManagerDW database for the SquaredUp web application, and that‚Äôs really it. Portal is up and running, spark-lines working. Ready to go. ConclusionI wish more products and ‚Äúadd-ons‚Äù to SCOM were this easy to install. No extra databases, no extra permissions, no extra infrastructure. I would like to try it out in a larger environment and see what the load on the website, the databases and the data access service will be. It would also be necessary to verify that it works properly when the management servers are behind a load balancer and maybe even putting the SquaredUp portal behind one itself. Since there is not a lot of configuration to be done and no database, it should work. We‚Äôll see. Next up will be fiddling about with custom dashboards, maps, and generally figuring out what else we can do.","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2012","slug":"ms/opsmgr2012","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2012/"}],"tags":[{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"},{"name":"Field Notes","slug":"Field-Notes","permalink":"https://www.teknoglot.se/tag/Field-Notes/"},{"name":"SquaredUp","slug":"SquaredUp","permalink":"https://www.teknoglot.se/tag/SquaredUp/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2012","slug":"ms/opsmgr2012","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2012/"}]},{"title":"OpsMgr 2012 R2 UR3 - Field Notes [#opsmgr]","slug":"opsmgr2012r2ur3-field-notes","date":"2014-09-02T09:30:18.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2012/opsmgr2012r2ur3-field-notes/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2012/opsmgr2012r2ur3-field-notes/","excerpt":"Quick and unrefined notes on Update Roll-up 3 for System Center 2012 R2 - Operations Manager. PreparationUsual routine, check the KB for instructions and known issues. Double-check with Holman‚Äôs blog and take note of any irregularities.Download, curse your favourite deity and re-try in IE. Unpack the CAB-files (why do you keep putting them in CAB-files?) and throw away all the unnecessary language-specific console patches. Notify affected parts of the organisation, I‚Äôve had the benefit to work with good release managers at all clients so far, so no biggie. Then try to close as many consoles as possible to avoid any blocks in database. Make sure you have the credentials for the Data Access service account at hand. Issues - So Far(updated 2014-09-02) The SQL Script for the OpsDW was deadlocked at all sites and customers without exception. It‚Äôs easily fixed by stopping the management server services. A few dashboards (the 2012 versions) went blank. Self-healed after some aggregation job over night. From what I‚Äôve noticed, only the SLA Dashboards are affected but never all of them. Agents behind daisy-chained Gateways is not identified as in need of an update. ‚ÄúRepairing‚Äù them from the Console is one work-around that seems to work consistently. A few agents that was updated using Windows Update did not report as updated. Repair fixed that nuisance. Had to flush the cache on a few Gateways to avoid heartbeat failures from their agents. Only daisy-chained ones if I recall correctly. Planning","text":"Quick and unrefined notes on Update Roll-up 3 for System Center 2012 R2 - Operations Manager. PreparationUsual routine, check the KB for instructions and known issues. Double-check with Holman‚Äôs blog and take note of any irregularities.Download, curse your favourite deity and re-try in IE. Unpack the CAB-files (why do you keep putting them in CAB-files?) and throw away all the unnecessary language-specific console patches. Notify affected parts of the organisation, I‚Äôve had the benefit to work with good release managers at all clients so far, so no biggie. Then try to close as many consoles as possible to avoid any blocks in database. Make sure you have the credentials for the Data Access service account at hand. Issues - So Far(updated 2014-09-02) The SQL Script for the OpsDW was deadlocked at all sites and customers without exception. It‚Äôs easily fixed by stopping the management server services. A few dashboards (the 2012 versions) went blank. Self-healed after some aggregation job over night. From what I‚Äôve noticed, only the SLA Dashboards are affected but never all of them. Agents behind daisy-chained Gateways is not identified as in need of an update. ‚ÄúRepairing‚Äù them from the Console is one work-around that seems to work consistently. A few agents that was updated using Windows Update did not report as updated. Repair fixed that nuisance. Had to flush the cache on a few Gateways to avoid heartbeat failures from their agents. Only daisy-chained ones if I recall correctly. PlanningUR3 is like most update roll-ups you‚Äôve seen so far. There‚Äôs a bunch of msp files you install on the different server roles, a few SQL-scripts for the OpsDB and the OpsDW and some updated core management packs. I have used the following order and that has worked quite nicely. Management Servers (and locally installed consoles) SQL-Scripts Management Packs1 Consoles2 Gateway Servers2 Web Console2 Agents2 The first management server takes the longest time as it will update the databases as well and you must wait for it to complete before hitting any extra management servers. Otherwise the databases isn‚Äôt marked as updated and multiple installations will try to update the same stuff at the same time, and that‚Äôs generally bad. I‚Äôd recommend to never update more than one management server at the same time, although it is possible. InstallationManagement ServersFairly straight-forward. Run the msp-file for the server update in an administrative command prompt and follow the wizard. First server takes a while (anything from 10-40 minutes depending on management group size and load in my experience). When that‚Äôs done, move on to the next management server. If your management servers have multiple roles, like Console, Web Console or Reporting, go ahead and update those at once. SQL-ScriptsThe scripts are unpacked by the setup. You will find them under %SystemDrive%\\Program Files\\System Center 2012 R2\\Operations Manager\\Server\\SQL Script for Update Rollups. Do OpsDW first using the UR_Datawarehouse.sql script, then go for OpsDB using Update_rollup_mom_db.sql. I‚Äôve gotten the deadlock error on all installations so far and the best way to avoid that is to stop the management server services for this part. It‚Äôs absolutely crucial to have the scripts run to successful completion before running the next or moving on to any other server roles. ConsoleNothing out of the ordinary here, make sure you run the Console msp in an administrative command prompt. Management PacksThe updated core management packs are unpacked into %SystemDrive%\\Program Files\\System Center 2012 R2\\Operations Manager\\Server\\Management Packs for Update Rollups. Import them using one of the updated consoles. GatewayNext-next-next if running as administrator. Take effort to verify that the agent updates has been distributed into the %SystemDrive%\\Program Files\\System Center Operations Manager\\Gateway\\AgentManagement\\&lt;architecture&gt; folder. If not, copy them from the same folder from any of the management servers. Web ConsoleNo problems so far as long as you run the Web Console msp as administrator. AgentsUpdate them as usual, using ‚ÄúPending Management‚Äù, windows update, manual installation, SCCM or whatever method you usually employ. Agent version will not be updated in the Console, but it will be visible under Monitoring/Operations Manager/Agent Management/Agents by Version. SummaryFairly simple update, the SQL Scripts can catch your off-guard if you do not know about them. Had some issues with Gateways, but it‚Äôs a pretty quick update in most environments. Have not experienced any reboots or service outages on updated systems. GLHF! *1. You‚Äôre going to need at least one updated console to import the MP-updates. ‚Ü©2. These can all be executed in parallel, agents behind Gateways will obviously need to be updated after the gateway. ‚Ü© ‚Ü© ‚Ü© ‚Ü©","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2012","slug":"ms/opsmgr2012","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2012/"}],"tags":[{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"},{"name":"Field Notes","slug":"Field-Notes","permalink":"https://www.teknoglot.se/tag/Field-Notes/"},{"name":"Update Rollup","slug":"Update-Rollup","permalink":"https://www.teknoglot.se/tag/Update-Rollup/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2012","slug":"ms/opsmgr2012","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2012/"}]},{"title":"Cloudflare as Dynamic DNS [#cloudflare #mikrotik #script]","slug":"cloudflare-dynamic-dns-mikrotik","date":"2014-08-25T11:37:36.000Z","updated":"2018-08-28T12:36:56.478Z","comments":true,"path":"mikrotik/cloudflare-dynamic-dns-mikrotik/","link":"","permalink":"https://www.teknoglot.se/mikrotik/cloudflare-dynamic-dns-mikrotik/","excerpt":"BackgroundI have, for a time, been using CloudFlare for CDN, Optimizations and DNS Management for this and a few other domains. At the same time, I‚Äôve been using DynDNS to provide name resolution to my home network/lab. Browsing around the CloudFlare JSON API I noticed that I can update DNS records through some fairly simple HTTP GET requests, and since the RouterOS (the operating system used by Mikrotik‚Äôs routerboards) has support for some pretty decent scripting I decided to let my router update CloudFlare for some custom and free dynamic DNS resolution. AttributionMy current script is a modified version of a script developed by Konstantin Antselovich. Original script: http://konstant1n.livejournal.com/9759.html Original Author website: http://konstantin.antselovich.com/ Thanks! How you do itWhat you need RouterOS v6+ for HTTPS support Cloudflare API key, aka ‚ÄúToken‚Äù, found at the account page Cloudflare DNS Zone name Cloudflare Record Id (more on that later) Cloudflare subdomain name Name of the external router interface","text":"BackgroundI have, for a time, been using CloudFlare for CDN, Optimizations and DNS Management for this and a few other domains. At the same time, I‚Äôve been using DynDNS to provide name resolution to my home network/lab. Browsing around the CloudFlare JSON API I noticed that I can update DNS records through some fairly simple HTTP GET requests, and since the RouterOS (the operating system used by Mikrotik‚Äôs routerboards) has support for some pretty decent scripting I decided to let my router update CloudFlare for some custom and free dynamic DNS resolution. AttributionMy current script is a modified version of a script developed by Konstantin Antselovich. Original script: http://konstant1n.livejournal.com/9759.html Original Author website: http://konstantin.antselovich.com/ Thanks! How you do itWhat you need RouterOS v6+ for HTTPS support Cloudflare API key, aka ‚ÄúToken‚Äù, found at the account page Cloudflare DNS Zone name Cloudflare Record Id (more on that later) Cloudflare subdomain name Name of the external router interface Getting the Record IdTo get the record id of the DNS record you want to update, I used the _rec_load_all_ function of the API. And since I‚Äôm a windows admin, I use powershell for that. $cfDomain = \"homelab\"$cfToken = \"&lt;your API Key/Token&gt;\"$cfZone = \"example.com\"$cfEmail = \"&lt;your CF email address&gt;\"$apiLoadAllRecordsURI = \"https://www.cloudflare.com/api_json.html?a=rec_load_all&amp;tkn=$cfToken&amp;email=$cfEmail&amp;z=$cfZone\"$restRequest = Invoke-RestMethod -Uri $apiLoadAllRecordsURI$restRequest.response.recs.objs | ?&#123;$_.display_name -eq $cfDomain&#125; | fl -Property rec_id,name,display_name,type,ttl,service_mode That should, given that you‚Äôve replaced all the example variables produce something like this: rec_id : 16606003name : homelab.example.comdisplay_name : homelabtype : Attl : 1service_mode : 0 And with that done, you should have everything necessary for the RouterOS script. Building the ScriptI‚Äôm not going to go into the syntax of ros scripts, but I‚Äôll try to explain the different building block to some degree. Defining our variablesFirst, we‚Äôll define out variables used for the script. The global $hostname variable is actually redundant as I could derive the FQDN from $CFDomain and $CFZone, but it‚Äôs used in other scripts in my router so it‚Äôs included for that purpose alone. ######## Set and collect general variables #########:global hostname &quot;homelab.example.com&quot;:global resolvedIP &quot;&quot;:global externalIP &quot;&quot;:global WANInterface &quot;eth1-ext-internet&quot;######## Set CloudFlare variables #################:local CFemail &quot;&lt;same email as in the powershell script&quot;:local CFtkn &quot;&lt;your API key/token&gt;&quot;:local CFzone &quot;example.com&quot;:local CFid &quot;16606003&quot;:local CFtype &quot;A&quot;:local CFttl &quot;1&quot;:local CFservicemode &quot;0&quot;:local CFDomain &quot;homelab&quot;:local CFDebug &quot;true&quot; Take care to verify and compare the CFxx variables with the ones used in and received from the previous powershell script, but also the $hostname variable. hostname: Used in the script to lookup the currently set IP-address. WANInterface: The list name of the external interface, used to find the external IP-address. CFemail: Your CloudFlare Login email. CFtkn: Your API Key/Token. CFzone: Your DNS Zone. CFid: The rec_id from the powershell script. CFtype: A for IPv4 host records, AAAA for IPv6. CFttl: Record time-to-live, use ‚Äú1‚Äù for automatic. CFservicemode: Use ‚Äú0‚Äù for direct traffic or ‚Äú1‚Äù to go through their CDN, Optimizations and Security features. I recommend ‚Äú0‚Äù for anything but websites. CFDomain: Subdomain or rather hostname for your router. CFDebug: Use ‚ÄúTrue‚Äù to print some informational stuff to the router logs. Resolve IP-addressesNext, we resolve two IP-addresses. First one, $externalIP, is the routers current external address. And the second, $resolvedIP, is the address currently set for our $hostname. ######## Resolve and set IP-variables ##########:local currentIP [/ip address get [/ip address find interface=$WANInterface ] address];:set externalIP [:pick $currentIP 0 [:find $currentIP &quot;/&quot;]];:set resolvedIP [:resolve $hostname]; Build CF API Request and log debug infoNow, build the URI for the API call from our variables. ######## Build CF API Url #########################:local CFurl &quot;https://www.cloudflare.com/api_json.html\\3F&quot;:set CFurl ($CFurl . &quot;a=rec_edit&amp;tkn=$CFtkn&amp;id=$CFid&quot;);:set CFurl ($CFurl . &quot;&amp;email=$CFemail&amp;z=$CFzone&amp;type=$CFtype&quot;);:set CFurl ($CFurl . &quot;&amp;name=$CFDomain&amp;service_mode=$CFservicemode&amp;ttl=$CFttl&quot;); And if the $CFdebug variable is set to ‚Äútrue‚Äù, write a little info to the router log. ######## Write debug info to log #################:if ($CFDebug = &quot;true&quot;) do=&#123;:log info (&quot;CF: hostname = $hostname&quot;):log info (&quot;CF: resolvedIP = $resolvedIP&quot;):log info (&quot;CF: currentIP = $currentIP&quot;):log info (&quot;CF: externalIP = $externalIP&quot;):log info (&quot;CF: CFurl = $CFurl&amp;content=$externalIP&quot;)&#125;; Compare and UpdateLast step is to compare $externalIP with $resolvedIP. If they don‚Äôt match, our external IP-address has been changed and we need to update the DNS record. To execute the HTTP GET request we use a RouterOS tool called fetch to which we pass the $CFurl variable. The reason this will not work before RouterOS v6+ is that before that there was no support for HTTPS, and CloudFlare does not accept unencrypted traffic for their APIs. The script block is pretty straight-forward. Compare, update, flush local DNS-cache and write to the log. ######## Compare and update CF if necessary #####:if ($resolvedIP != $externalIP) do=&#123;:log info (&quot;CF: Updating CF, setting $CFDomain = $externalIP&quot;)/tool fetch mode=https url=&quot;$CFurl&amp;content=$externalIP&quot; keep-result=no/ip dns cache flush&#125; else=&#123;:log info &quot;CF: No Update Needed!&quot;&#125; Permissions/PoliciesThis part, I‚Äôm not entirely sure on. The script needs to do name resolution, read settings and set variables and it works for me with these policies configured: Read Write Test Sniff Sensitive It might be over-doing it a bit, but I have not had occasion to fiddle with them yet. SchedulingI have this script scheduled to run once every 20 minutes. As it will only try to update the DNS records if there is a difference between them and the current external IP-address I feel fairly sure that I won‚Äôt be tagged as a spammer or something by CloudFlare. The schedule is configured with: Start Time: startup Interval: 00:20:00 On Event: /system script run &lt;Name of your script&gt; Policy: Read,Write, Test, Sniff, Sensitive This schedule is also a good place for a hairpin update if it‚Äôs needed. The Copy-Paste partNow, obviously, at least make sure you proof-read the script before putting it into production. I am not a network dude, and I rarely dabble with ROS scripts. I am certain that anyone with a bit more experience could create a smarter, prettier version of this script, so use at your own risk. Anyway, here‚Äôs the script in it‚Äôs entirety. ######## Set and collect general variables #########:global hostname &quot;homelab.example.com&quot;:global resolvedIP &quot;&quot;:global externalIP &quot;&quot;:global WANInterface &quot;eth1-ext-internet&quot;######## Set CloudFlare variables #################:local CFemail &quot;&lt;same email as in the powershell script&quot;:local CFtkn &quot;&lt;your API key/token&gt;&quot;:local CFzone &quot;example.com&quot;:local CFid &quot;16606003&quot;:local CFtype &quot;A&quot;:local CFttl &quot;1&quot;:local CFservicemode &quot;0&quot;:local CFDomain &quot;homelab&quot;:local CFDebug &quot;true&quot;######## Resolve and set IP-variables ##########:local currentIP [/ip address get [/ip address find interface=$WANInterface ] address];:set externalIP [:pick $currentIP 0 [:find $currentIP &quot;/&quot;]];:set resolvedIP [:resolve $hostname];######## Build CF API Url #########################:local CFurl &quot;https://www.cloudflare.com/api_json.html\\3F&quot;:set CFurl ($CFurl . &quot;a=rec_edit&amp;tkn=$CFtkn&amp;id=$CFid&quot;);:set CFurl ($CFurl . &quot;&amp;email=$CFemail&amp;z=$CFzone&amp;type=$CFtype&quot;);:set CFurl ($CFurl . &quot;&amp;name=$CFDomain&amp;service_mode=$CFservicemode&amp;ttl=$CFttl&quot;);######## Write debug info to log #################:if ($CFDebug = &quot;true&quot;) do=&#123;:log info (&quot;CF: hostname = $hostname&quot;):log info (&quot;CF: resolvedIP = $resolvedIP&quot;):log info (&quot;CF: currentIP = $currentIP&quot;):log info (&quot;CF: externalIP = $externalIP&quot;):log info (&quot;CF: CFurl = $CFurl&amp;content=$externalIP&quot;)&#125;;######## Compare and update CF if necessary #####:if ($resolvedIP != $externalIP) do=&#123;:log info (&quot;CF: Updating CF, setting $CFDomain = $externalIP&quot;)/tool fetch mode=https url=&quot;$CFurl&amp;content=$externalIP&quot; keep-result=no/ip dns cache flush&#125; else=&#123;:log info &quot;CF: No Update Needed!&quot;&#125;","categories":[{"name":"Mikrotik","slug":"mikrotik","permalink":"https://www.teknoglot.se/topics/mikrotik/"}],"tags":[{"name":"PoSH","slug":"PoSH","permalink":"https://www.teknoglot.se/tag/PoSH/"},{"name":"Script","slug":"Script","permalink":"https://www.teknoglot.se/tag/Script/"},{"name":"DNS","slug":"DNS","permalink":"https://www.teknoglot.se/tag/DNS/"},{"name":"Invoke-RestMethod","slug":"Invoke-RestMethod","permalink":"https://www.teknoglot.se/tag/Invoke-RestMethod/"},{"name":"Mikrotik","slug":"Mikrotik","permalink":"https://www.teknoglot.se/tag/Mikrotik/"},{"name":"RouterOS","slug":"RouterOS","permalink":"https://www.teknoglot.se/tag/RouterOS/"}],"keywords":[{"name":"Mikrotik","slug":"mikrotik","permalink":"https://www.teknoglot.se/topics/mikrotik/"}]},{"title":"Quick Demo - Add Windows Performance Collection Rule [#opsmgr, #mpauthoring]","slug":"quick-demo-add-windows-performance-collection-rule-opsmgr-mpauthoring","date":"2013-02-21T08:25:39.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2007/quick-demo-add-windows-performance-collection-rule-opsmgr-mpauthoring/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2007/quick-demo-add-windows-performance-collection-rule-opsmgr-mpauthoring/","excerpt":"By request, I uploaded a short clip demonstrating how you would add a windows performance counter to a performance collection rule using the Authoring Console. It is a fairly simple task to complete but does require the Authoring Console, obviously, and a better target class than what I use in the demo. The demo also assumes that this counter exist on all the targeted servers in your environment. It would be wise, when making your management pack, to check that it‚Äôs there on all targeted operating systems, and that‚Äôs what I use Performance Monitor for. (just search for perfmon in your start menu or run perfmon.exe) Enjoy.","text":"By request, I uploaded a short clip demonstrating how you would add a windows performance counter to a performance collection rule using the Authoring Console. It is a fairly simple task to complete but does require the Authoring Console, obviously, and a better target class than what I use in the demo. The demo also assumes that this counter exist on all the targeted servers in your environment. It would be wise, when making your management pack, to check that it‚Äôs there on all targeted operating systems, and that‚Äôs what I use Performance Monitor for. (just search for perfmon in your start menu or run perfmon.exe) Enjoy.","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}],"tags":[{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"},{"name":"Management Pack","slug":"Management-Pack","permalink":"https://www.teknoglot.se/tag/Management-Pack/"},{"name":"MP Development","slug":"MP-Development","permalink":"https://www.teknoglot.se/tag/MP-Development/"},{"name":"Video","slug":"Video","permalink":"https://www.teknoglot.se/tag/Video/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}]},{"title":"OpsMgr 2012 Agent Failover ‚Äì A Faster Script with Wildcards [#opsmgr, #powershell]","slug":"opsmgr-2012-agent-failover-a-faster-script-with-wildcards-opsmgr-powershell","date":"2012-06-28T12:28:36.000Z","updated":"2017-09-28T15:57:00.000Z","comments":true,"path":"ms/opsmgr2012/opsmgr-2012-agent-failover-a-faster-script-with-wildcards-opsmgr-powershell/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2012/opsmgr-2012-agent-failover-a-faster-script-with-wildcards-opsmgr-powershell/","excerpt":"Now we‚Äôre gonna make things even faster! In the previous post on the subject of Agent Fail-over in Operations Manager 2012 we created a script that will go through a selection of agents and make sure that they all have up-to-date fail-over settings. We are doing the same thing in this one, but making it go faster. In my lab, it‚Äôs about five times faster in fact and I only have about 20 agents to play with. Not really a big deal, but scale it up a bit and add a few thousand agents and the pay-off will be very significant. As usual, the script will work as is, but it really is more to show the concept. You would have to add filtering to make sure you don‚Äôt mix agents behind gateway servers and agents behind management servers. Giving an agent behind a gateway a management servers as it‚Äôs fail-over server will likely not help you in any way. We will pretty quickly go ‚Äúadvanced‚Äù this time, so buckle up. ;) Being a slight modification of the script in the last post I am not going to go through those details. Use that post if you need references to the Inputs, the OpsMgr 2012 Modules, Management Group connection and gathering your agents and management servers. Why Is It Faster?We are doing the same thing, on the same agents and with the same servers. And we already did some optimization by loading them all into memory and working from there. How do you make it faster? Basically, I‚Äôm cutting the over-head of the cmdlets and how they work. You may have noticed that in the ‚ÄúDo Stuff‚Äù section, we are actually calling the Set-SCOMParentManagementServer cmdlet twice! Once for the primary Management Server and once for the fail-over Management Servers. In effect, we connect, fire a command, wait for result, and disconnect two times for each agent. And pretty much only because the cmdlet does not offer support to set primary and fail-over management servers at the same time. Any attempt to do so will return an ambiguous parameter error. I don‚Äôt like that. A brief look at the agent object class, Microsoft.EnterpriseManagement.Administration.AgentManagedComputer, revealed a method called SetManagementServers. This method takes, or actually ‚Äúrequires‚Äù, two parameters. One for primary and one for fail-over management servers. Yay! Using this method saves us a bunch of over-head and a couple of round-trips to the SDK-service. The Challenge","text":"Now we‚Äôre gonna make things even faster! In the previous post on the subject of Agent Fail-over in Operations Manager 2012 we created a script that will go through a selection of agents and make sure that they all have up-to-date fail-over settings. We are doing the same thing in this one, but making it go faster. In my lab, it‚Äôs about five times faster in fact and I only have about 20 agents to play with. Not really a big deal, but scale it up a bit and add a few thousand agents and the pay-off will be very significant. As usual, the script will work as is, but it really is more to show the concept. You would have to add filtering to make sure you don‚Äôt mix agents behind gateway servers and agents behind management servers. Giving an agent behind a gateway a management servers as it‚Äôs fail-over server will likely not help you in any way. We will pretty quickly go ‚Äúadvanced‚Äù this time, so buckle up. ;) Being a slight modification of the script in the last post I am not going to go through those details. Use that post if you need references to the Inputs, the OpsMgr 2012 Modules, Management Group connection and gathering your agents and management servers. Why Is It Faster?We are doing the same thing, on the same agents and with the same servers. And we already did some optimization by loading them all into memory and working from there. How do you make it faster? Basically, I‚Äôm cutting the over-head of the cmdlets and how they work. You may have noticed that in the ‚ÄúDo Stuff‚Äù section, we are actually calling the Set-SCOMParentManagementServer cmdlet twice! Once for the primary Management Server and once for the fail-over Management Servers. In effect, we connect, fire a command, wait for result, and disconnect two times for each agent. And pretty much only because the cmdlet does not offer support to set primary and fail-over management servers at the same time. Any attempt to do so will return an ambiguous parameter error. I don‚Äôt like that. A brief look at the agent object class, Microsoft.EnterpriseManagement.Administration.AgentManagedComputer, revealed a method called SetManagementServers. This method takes, or actually ‚Äúrequires‚Äù, two parameters. One for primary and one for fail-over management servers. Yay! Using this method saves us a bunch of over-head and a couple of round-trips to the SDK-service. The ChallengeUnfortunately, you cannot simply toss an array of management servers at the SetManagementServers method. With a bit of knowledge or keen eyes you will spot the problem right away. I didn‚Äôt and was pulling my hair for a while until I realized what caused the errors. Looking closer at how the method is defined we see this: public void SetManagementServers ( ManagementServer managementServer, IList failoverManagementServers ) You see that IList&lt;ManagementServer&gt; part?That‚Äôs the problem. When you run Get-SCOMManagementServer and save the result to a powershell variable, you will get a powershell ‚ÄúEnumerable‚Äù. In C#, that would be a class that implements the IEnumerable interface. Sad part is, it does not also implement IList. If you are thinking ‚ÄúIList‚Ä¶ IEnumerable‚Ä¶ Interface‚Ä¶ Whaaaaa‚Ä¶???‚Äù right now, don‚Äôt worry. You don‚Äôt have to understand this to read the script later on, just think of it as different types of data. To get around this, we create a new object based on the dotNET List type and populate it with the management servers in our $scomFailOverMS array. $scomMSList = New-Object 'Collections.Generic.List[Microsoft.EnterpriseManagement.Administration.ManagementServer]'foreach ($scomMS in $scomFailOverMS) &#123; # Loop through the array and add your failover MSs to the list $scomMSList.Add($scomMS)&#125; Note:We have to do that foreach loop since our $scomMSList object do not implement IEnumerableStill with me? Configuring the AgentAs the method exist on that AgentManagedComputer class we will call it on our $scomAgent object, like this: $scomAgent.SetManagementServers($scomPrimaryMS,$scomMSList) And we‚Äôre done! I had some doubt that this would be an improvement at first since we have to create our own objects and run an extra foreach-loop, but as we only work on objects in memory and only speak to the SDK service once per agent, we cut a lot of over-head and delays from our execution. On 20-ish agents in a lab, I‚Äôve measured the execution time drop to barely a fifth. The Copy/Paste PartAnd here‚Äôs the entire script with a few added comments for clarity. Read, adapt and try it. In a lab, preferably. # Input SCOM Management Server to connect to in this session[string]$inputScomMS = \"scomms02.domain.local\"# Input an existing agent you want to modify[string]$inputTargetAgent = \"*.domain.local\"### Connect to SCOM 2012 Management Group ###If (Get-Module -Name \"OperationsManager\") &#123; try &#123; Import-Module -Name \"OperationsManager\" &#125; catch &#123; echo \"Could not load Operations Manager module\" exit &#125;&#125;New-SCOMManagementGroupConnection -ComputerName $inputScomMS### END ###$scomAgents = Get-SCOMAgent -DNSHostName $inputTargetAgent | Where &#123;$_.ManuallyInstalled -ne $true&#125;# Get all of the management servers# It is ofcourse possible to search by hostname and wildcards using selected# parameters to the cmdlet.$scomManagementServers = Get-SCOMManagementServer# Switch to the following line to only get Gateway Servers#$scomManagementServers = Get-SCOMGatewayManagementServerforeach ($scomAgent in $scomAgents) &#123; # Get the primary management server for the agent $scomPrimaryMS = $scomManagementServers | where &#123;$_.Name -eq $scomAgent.PrimaryManagementServerName&#125; # Remove the primary MS from \"all MS\" array to use it for FailOver servers $scomFailOverMS = $scomManagementServers | where &#123;$_.Name -ne $scomPrimaryMS.Name&#125; # Create a new IList derived object for the failover MSs # You have to do this because the SetManagementServers() method requires an # IList and the MS-array is an IEnumerable type. So we basically create # a new IList object och the ManagementServer type. $scomMSList = New-Object 'Collections.Generic.List[Microsoft.EnterpriseManagement.Administration.ManagementServer]' foreach ($scomMS in $scomFailOverMS) &#123; # Loop through the array and add your failover MSs to the list $scomMSList.Add($scomMS) &#125; $scomAgent.SetManagementServers($scomPrimaryMS, $scomMSList)&#125; GLHF!","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2012","slug":"ms/opsmgr2012","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2012/"}],"tags":[{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"},{"name":"PoSH","slug":"PoSH","permalink":"https://www.teknoglot.se/tag/PoSH/"},{"name":"Script","slug":"Script","permalink":"https://www.teknoglot.se/tag/Script/"},{"name":"Fail-over","slug":"Fail-over","permalink":"https://www.teknoglot.se/tag/Fail-over/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2012","slug":"ms/opsmgr2012","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2012/"}]},{"title":"OpsMgr 2012 Agent Failover - Simple Script with Wildcards [#opsmgr, #powershell]","slug":"opsmgr-2012-agent-failover-simple-script-with-wildcards-opsmgr-powershell","date":"2012-06-21T08:58:13.000Z","updated":"2017-09-28T15:57:00.000Z","comments":true,"path":"ms/opsmgr2012/opsmgr-2012-agent-failover-simple-script-with-wildcards-opsmgr-powershell/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2012/opsmgr-2012-agent-failover-simple-script-with-wildcards-opsmgr-powershell/","excerpt":"In the last post, OpsMgr 2012 Agent &amp; Gateway Failover ‚Äì The Basics, we looked at the basics of the Agent and Gateway fail-over configuration cmdlets and how to use them in a direct and interactive setting. This is absolutely useful when you got this specific agent that you need to configure with a specific fail-over management server. To spice it up a little, we are going to add a little intelligence to it and enable wild-card selections while at it. The scenario we are building this script for is that now and then you want to make sure that certain agents have fail-over management servers configured. You also want to make sure that all management servers that are not the primary management server of any selected agent will be in that list of fail-over servers. This would include any new management servers as well as exclude any removed ones. In short, make sure your agent fail-over settings are up-to-date with the current environment. InputsTo use this script you need to know which management server you should connect your powershell session to and which agent, or agents, you want to check and configure. # Input SCOM Management Server to connect to in this session[string]$inputScomMS = \"scomms01.domain.local\"# Input an existing agent you want to modify[string]$inputTargetAgent = \"*.domain.local\" Note: If you are using load-balanced SDK-services, or ‚ÄúData Access Services‚Äù, pointing $inputScomMS to that virtual host-name will work perfectly fine.This example uses a wild-card for the agent selection and I guess it‚Äôs the most likely scenario for this script, but a single host-name obviously works fine as well. Supported wildcard selections are documented at TechNet. An array of computer-names or a comma-separated list, however, will not work. You could easily add that functionality but it‚Äôs out of scope for this example. Connect to Your Management GroupTo run any script against an Operations Manager 2012 Management Group we need a connection to one. To connect to a management group we have to load the OperationsManager module. Lets check for a loaded module, load it if necessary and connect to the Management Server from the $inputScomMS setting. If loading the module fails‚Äìmaybe it is not installed‚Äìwe will exit the script. # Check if OperationsManager module is loadedIf (Get-Module -Name \"OperationsManager\") &#123; try &#123; # Try to load the module Import-Module -Name \"OperationsManager\" &#125; catch &#123; # Did not work, exit the script Write-Output \"Could not load Operations Manager module\" exit &#125;&#125;# Module is loaded, connect to Management Group/ServerNew-SCOMManagementGroupConnection -ComputerName $inputScomMS","text":"In the last post, OpsMgr 2012 Agent &amp; Gateway Failover ‚Äì The Basics, we looked at the basics of the Agent and Gateway fail-over configuration cmdlets and how to use them in a direct and interactive setting. This is absolutely useful when you got this specific agent that you need to configure with a specific fail-over management server. To spice it up a little, we are going to add a little intelligence to it and enable wild-card selections while at it. The scenario we are building this script for is that now and then you want to make sure that certain agents have fail-over management servers configured. You also want to make sure that all management servers that are not the primary management server of any selected agent will be in that list of fail-over servers. This would include any new management servers as well as exclude any removed ones. In short, make sure your agent fail-over settings are up-to-date with the current environment. InputsTo use this script you need to know which management server you should connect your powershell session to and which agent, or agents, you want to check and configure. # Input SCOM Management Server to connect to in this session[string]$inputScomMS = \"scomms01.domain.local\"# Input an existing agent you want to modify[string]$inputTargetAgent = \"*.domain.local\" Note: If you are using load-balanced SDK-services, or ‚ÄúData Access Services‚Äù, pointing $inputScomMS to that virtual host-name will work perfectly fine.This example uses a wild-card for the agent selection and I guess it‚Äôs the most likely scenario for this script, but a single host-name obviously works fine as well. Supported wildcard selections are documented at TechNet. An array of computer-names or a comma-separated list, however, will not work. You could easily add that functionality but it‚Äôs out of scope for this example. Connect to Your Management GroupTo run any script against an Operations Manager 2012 Management Group we need a connection to one. To connect to a management group we have to load the OperationsManager module. Lets check for a loaded module, load it if necessary and connect to the Management Server from the $inputScomMS setting. If loading the module fails‚Äìmaybe it is not installed‚Äìwe will exit the script. # Check if OperationsManager module is loadedIf (Get-Module -Name \"OperationsManager\") &#123; try &#123; # Try to load the module Import-Module -Name \"OperationsManager\" &#125; catch &#123; # Did not work, exit the script Write-Output \"Could not load Operations Manager module\" exit &#125;&#125;# Module is loaded, connect to Management Group/ServerNew-SCOMManagementGroupConnection -ComputerName $inputScomMS A good idea would, of course, be to first check if we already have an existing management group connection before creating a new one. But that‚Äôs up to you. Rally Your Agents (and Management Servers)Since we cannot manage manually installed agents‚Äìthat would be AD-integrated or installed locally using Configuration Manager or maybe the wizard‚Äìthrough powershell we don‚Äôt even want to try. So we‚Äôll exclude them. We also need all the available management servers. This will not handle Gateway servers as they have their own cmdlet, Get-SCOMGatewayManagementServer, in Operations Manager 2012. Strike that! There is a specific cmdlet for Gateway Servers in OpsMgr 2012, but the regular Get-SCOMManagementServer actually don‚Äôt care whether it‚Äôs a normal Management Server or a Gateway Server. The Get-SCOMGatewayManagementServer, however, only return real Gateway Servers. That means that this script will not care if it is a Management Server or a Gateway Server, so be sure to add some kind of filtering before running it in a Management Group containing management servers. # Select matching remotely manageable agents$scomAgents = Get-SCOMAgent -DNSHostName $inputTargetAgent | Where-Object &#123;$_.ManuallyInstalled -ne $true&#125;# Get all management servers$scomManagementServers = Get-SCOMManagementServer The reason I like to store all matching agents in a variable is that we will save ourselves a lot of trips to the Data Access Service later on, and we also get a nice collection to run our foreach-loop on. This method is much faster than running Get-SCOMAgent inline as we did in ‚ÄúThe Basics‚Äù. Note: It would probably be a good idea to check that $scomAgents actually contains anything; checking for $null with a simple if()would be enough. Do StuffWe have our connection to the management group, we have collected our agents, and we have our management servers. It‚Äôs time to loop through the agents and set their Primary and Fail-over management servers. foreach ($scomAgent in $scomAgents) &#123; # Get the primary management server for the agent $scomPrimaryMS = $scomManagementServers | Where-Object &#123;$_.Name -eq $scomAgent.PrimaryManagementServerName&#125; # Remove the primary MS from \"all MS\" array to use it for FailOver servers $scomFailOverMS = $scomManagementServers | Where-Object &#123;$_.Name -ne $scomPrimaryMS.Name&#125; # Set Primary Management Server Set-SCOMParentManagementServer -Agent $scomAgent -PrimaryServer $scomPrimaryMS # Set Fail-over Management Server Set-SCOMParentManagementServer -Agent $scomAgent -FailoverServer $scomFailOverMS&#125; The nice thing about loading the agents and the management servers into variables is that all the information you need for this script is pre-cached in memory. You don‚Äôt have to connect to the management group to find out which management server happens is the primary for each agent. And you don‚Äôt have to run Get-SCOMManagementServer for each agent to select which ones that will be fail-over management servers. All that information is in memory, and memory is fast. The Copy/Paste PartAs usual, here‚Äôs the entire script for you to copy. Read it, try it, adapt it‚Ä¶ # Input SCOM Management Server to connect to in this session[string]$inputScomMS = \"scomms02.domain.local\"# Input an existing agent you want to modify[string]$inputTargetAgent = \"*.domain.local\"### Connect to SCOM 2012 Management Group #### Check if OperationsManager module is loadedIf (Get-Module -Name \"OperationsManager\") &#123; try &#123; # Try to load the module Import-Module -Name \"OperationsManager\" &#125; catch &#123; # Did not work, exit the script Write-Output \"Could not load Operations Manager module\" exit &#125;&#125;# Module is loaded, connect to Management Group/ServerNew-SCOMManagementGroupConnection -ComputerName $inputScomMS### END #### Select matching remotely manageable agents$scomAgents = Get-SCOMAgent -DNSHostName $inputTargetAgent | Where-Object &#123;$_.ManuallyInstalled -ne $true&#125;# Get all management servers$scomManagementServers = Get-SCOMManagementServerforeach ($scomAgent in $scomAgents) &#123; # Get the primary management server for the agent $scomPrimaryMS = $scomManagementServers | Where-Object &#123;$_.Name -eq $scomAgent.PrimaryManagementServerName&#125; # Remove the primary MS from \"all MS\" array to use it for FailOver servers $scomFailOverMS = $scomManagementServers | Where-Object &#123;$_.Name -ne $scomPrimaryMS.Name&#125; # Set Primary Management Server Set-SCOMParentManagementServer -Agent $scomAgent -PrimaryServer $scomPrimaryMS # Set Fail-over Management Server Set-SCOMParentManagementServer -Agent $scomAgent -FailoverServer $scomFailOverMS&#125;### Done! GLHF!","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2012","slug":"ms/opsmgr2012","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2012/"}],"tags":[{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"},{"name":"PoSH","slug":"PoSH","permalink":"https://www.teknoglot.se/tag/PoSH/"},{"name":"Fail-over","slug":"Fail-over","permalink":"https://www.teknoglot.se/tag/Fail-over/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2012","slug":"ms/opsmgr2012","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2012/"}]},{"title":"Menu Problems!","slug":"menu-problems","date":"2012-06-21T06:01:50.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"tb/menu-problems/","link":"","permalink":"https://www.teknoglot.se/tb/menu-problems/","excerpt":"The menus are looking a bit off as you may have noticed. I guess it‚Äôs an issue with WordPress 3.4 and Superfish and are trying to figure out where it goes haywire. Sorry for the inconvenience. UpdateI switched the theme to at least get the navigation working while I try to figure out what the problem with the regular theme is.","text":"The menus are looking a bit off as you may have noticed. I guess it‚Äôs an issue with WordPress 3.4 and Superfish and are trying to figure out where it goes haywire. Sorry for the inconvenience. UpdateI switched the theme to at least get the navigation working while I try to figure out what the problem with the regular theme is.","categories":[{"name":"Technobabble","slug":"tb","permalink":"https://www.teknoglot.se/topics/tb/"}],"tags":[{"name":"Teknoglot","slug":"Teknoglot","permalink":"https://www.teknoglot.se/tag/Teknoglot/"}],"keywords":[{"name":"Technobabble","slug":"tb","permalink":"https://www.teknoglot.se/topics/tb/"}]},{"title":"OpsMgr 2012 Agent & Gateway Failover - The Basics [#opsmgr, #powershell]","slug":"opsmgr-2012-agent-gateway-failover-the-basics","date":"2012-05-30T12:12:37.000Z","updated":"2017-09-28T15:57:00.000Z","comments":true,"path":"ms/opsmgr2012/opsmgr-2012-agent-gateway-failover-the-basics/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2012/opsmgr-2012-agent-gateway-failover-the-basics/","excerpt":"I have previously posted a few scripts on managing and configuring fail-over management servers on gateways and agents in System Center Operations Manager 2007 R2. Now that System Center 2012 Operations Manager is RTM and users are starting to explore the differences between the versions I see more and more questions on how you do, in OpsMgr 2012, what you did in OpsMgr 2007. In a few posts henceforth I will go through Agent and Gateway server fail-over configuration and management. In this first post I‚Äôll look at the very basics of fail-over configuration, the cmdlets to use and some one-liners. The cmdletFirst of all, the cmdlets of OpsMgr powershell have all got new names looking like Verb-SCOMnoun and to list them all in the console you can execute the following command: get-command *SCOM* The cmdlet we are looking for to set and manage primary and fail-over management servers is Get-SCOMParentManagementServer As usual, you can pass the cmdlet as a parameter to get-help for information about its parameters and a few use-cases. SYNOPSIS Changes the primary and failover management servers for an agent or gateway management server. SYNTAX Set-SCOMParentManagementServer -Agent -PrimaryServer [-PassThru ] [-Confirm ] [-WhatIf ] [] Set-SCOMParentManagementServer -Agent -FailoverServer [-PassThru ] [-Confirm ] [-WhatIf ] [] Set-SCOMParentManagementServer -GatewayServer -FailoverServer [-PassThru ] [-Confirm ] [-WhatIf ] [] Set-SCOMParentManagementServer -GatewayServer -PrimaryServer [-PassThru] [-Confirm] [-WhatIf] []But that‚Äôs so boring to read the manual is a bit sketchy on how it behaves and the limitations.","text":"I have previously posted a few scripts on managing and configuring fail-over management servers on gateways and agents in System Center Operations Manager 2007 R2. Now that System Center 2012 Operations Manager is RTM and users are starting to explore the differences between the versions I see more and more questions on how you do, in OpsMgr 2012, what you did in OpsMgr 2007. In a few posts henceforth I will go through Agent and Gateway server fail-over configuration and management. In this first post I‚Äôll look at the very basics of fail-over configuration, the cmdlets to use and some one-liners. The cmdletFirst of all, the cmdlets of OpsMgr powershell have all got new names looking like Verb-SCOMnoun and to list them all in the console you can execute the following command: get-command *SCOM* The cmdlet we are looking for to set and manage primary and fail-over management servers is Get-SCOMParentManagementServer As usual, you can pass the cmdlet as a parameter to get-help for information about its parameters and a few use-cases. SYNOPSIS Changes the primary and failover management servers for an agent or gateway management server. SYNTAX Set-SCOMParentManagementServer -Agent -PrimaryServer [-PassThru ] [-Confirm ] [-WhatIf ] [] Set-SCOMParentManagementServer -Agent -FailoverServer [-PassThru ] [-Confirm ] [-WhatIf ] [] Set-SCOMParentManagementServer -GatewayServer -FailoverServer [-PassThru ] [-Confirm ] [-WhatIf ] [] Set-SCOMParentManagementServer -GatewayServer -PrimaryServer [-PassThru] [-Confirm] [-WhatIf] []But that‚Äôs so boring to read the manual is a bit sketchy on how it behaves and the limitations. The One-Liners!I have compiled a few examples for a few common tasks to better illustrate it‚Äôs uses. Set Primary Management Server on Agent#Set Primary Management Server on AgentSet-SCOMParentManagementServer -Agent (Get-SCOMAgent -DNSHostName \"AGENT.domain.local\") -PrimaryServer (Get-SCOMManagementServer -Name \"SCOMMS01.domain.local\") Set Fail-over Management Server on Agent#Set Fail-over Management Server on AgentSet-SCOMParentManagementServer -Agent (Get-SCOMAgent -DNSHostName \"AGENT.domain.local\") -FailoverServer (Get-SCOMManagementServer -Name \"SCOMMS02.domain.local\") Set Primary Management Server on Gateway#Set Primary Management Server on GatewaySet-SCOMParentManagementServer -GatewayServer (Get-SCOMGatewayManagementServer -Name \"SCOMGW01.domain.local\") -PrimaryServer (Get-SCOMManagementServer -Name \"SCOMMS01.domain.local\") Set Fail-over Management Server on Gateway#Set Fail-over Management Server on GatewaySet-SCOMParentManagementServer -GatewayServer (Get-SCOMGatewayManagementServer -Name \"SCOMGW01.domain.local\") -FailoverServer (Get-SCOMManagementServer -Name \"SCOMMS02.domain.local\") A few reflectionsAs you may notice, if you have used the OpsMgr 2007 Set-ManagementServer cmdlet you actually have to use separate parameters depending on whether you are configuring management servers on an agent or a gateway server. You probably also noticed that to get an object for a gateway server you also have to use Get-SCOMGatewayManagementServer in OpsMgr 2012. For some reason, there‚Äôs different properties on agent objects compared to management and gateway servers. On an MS or GW, you use -Name to select by name, while on an agent you have to use -DNSHostName. Both of these parameters take wild-cards making it possible to find all the agents named ‚Äú*.domain.local‚Äù. While -PrimaryServer only takes a single object the -Agent, -GatewayServer and -FailoverServer can take an array or collection of objects. One more ‚Äúgotcha‚Äù I ran into is the fact that trying to set both-PrimaryServer and -FailoverServer in the same command will fail with an ‚ÄúAmbiguousParameterSet‚Äù error. You have to run it once for the Primary Management Server and once for your Fail-over Management Servers. Related SnippetsApart from setting your management servers you might also want to read your agent‚Äôs current configuration as well. Get current Primary Management Server on Agent#Get current Primary MS on Agent$agent = Get-SCOMAgent -DNSHostName \"AGENT.domain.local\"$primaryMS = $agent.GetPrimaryManagementServer()write-host \"Current Primary ManagementServer: \"$primaryMS.Name Get current Failover Management Server on Agent#Get current Failover MS on Agent$agent = Get-SCOMAgent -DNSHostName \"AGENT.domain.local\"$failoverMSs = $agent.GetFailoverManagementServers()write-host \"Got\"$failoverMSs.Count\"failover Management Servers\"foreach($failoverMS in $failoverMSs) &#123; $failoverMS.Name&#125; I think that would be all for this post. Next one will touch on a little more intelligence and a few ways to automatically select ‚Äúother‚Äù management servers as fail-over management servers. Enjoy!","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2012","slug":"ms/opsmgr2012","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2012/"}],"tags":[{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"},{"name":"PoSH","slug":"PoSH","permalink":"https://www.teknoglot.se/tag/PoSH/"},{"name":"How-To","slug":"How-To","permalink":"https://www.teknoglot.se/tag/How-To/"},{"name":"Fail-over","slug":"Fail-over","permalink":"https://www.teknoglot.se/tag/Fail-over/"},{"name":"Scripts","slug":"Scripts","permalink":"https://www.teknoglot.se/tag/Scripts/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2012","slug":"ms/opsmgr2012","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2012/"}]},{"title":"Load-balanced SCOM2012 SDK Services for Network Illiterates [#opsmgr, #nlb]","slug":"load-balanced-scom2012-sdk-services-for-network-illiterates-opsmgr-nlb","date":"2012-05-18T11:16:51.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2012/load-balanced-scom2012-sdk-services-for-network-illiterates-opsmgr-nlb/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2012/load-balanced-scom2012-sdk-services-for-network-illiterates-opsmgr-nlb/","excerpt":"PreludeNow that System Center Operations Manager no longer has that pesky Root Management Server role; a server role that in larger environments quickly became the choking point and made creating a fully Highly Available SCOM-environment both complex and frustrating to support and with little gain at that. With that gone and the SDK Service, or Data Access Service, thriving on all the Management Servers HA suddenly became pretty simple. All you have to do in SCOM2012 to make sure your management groups keep on kicking is to have at-least two Management Servers and your databases clustered. This new distributed architecture does not only give easy HA, it also makes it possible to connect to the SDK-service‚Äîbe it using the Operations Console or powershell to name two options‚Äîon any Management Server. This, in turn, provides for a completely new level of scalability. Choked on sessions? Deploy a new Management Server! Anyway‚Ä¶ given all this scalability and HA, would it not be nice if you could load-balance all these SDK-sessions you will be running from System Center Virtual Machine Manager, System Center Service Manager, System Center Orchestrator, regular scheduled powershell scripts and what-not? Of course it would! And you can! The simple solution is to use the built-in Network Load Balancer (NLB for short) feature in Windows Server and that‚Äôs what we‚Äôre going to discuss in this post.Before we go, I‚Äôd like to point to a great article written by Justin Cook that is covering most bases but in a less for-dummies way. So, yeah‚Ä¶ I suppose this is the for-dummies version then. ;) Enjoy! PrerequisitesWe need to have the Network Load Balancing feature installed on all our targeted Management servers. The quick way to do this is using command-line (Windows Server 2008 R2 or later?). dism /online /enable-feature /featurename:NetworkLoadBalancingFullServer","text":"PreludeNow that System Center Operations Manager no longer has that pesky Root Management Server role; a server role that in larger environments quickly became the choking point and made creating a fully Highly Available SCOM-environment both complex and frustrating to support and with little gain at that. With that gone and the SDK Service, or Data Access Service, thriving on all the Management Servers HA suddenly became pretty simple. All you have to do in SCOM2012 to make sure your management groups keep on kicking is to have at-least two Management Servers and your databases clustered. This new distributed architecture does not only give easy HA, it also makes it possible to connect to the SDK-service‚Äîbe it using the Operations Console or powershell to name two options‚Äîon any Management Server. This, in turn, provides for a completely new level of scalability. Choked on sessions? Deploy a new Management Server! Anyway‚Ä¶ given all this scalability and HA, would it not be nice if you could load-balance all these SDK-sessions you will be running from System Center Virtual Machine Manager, System Center Service Manager, System Center Orchestrator, regular scheduled powershell scripts and what-not? Of course it would! And you can! The simple solution is to use the built-in Network Load Balancer (NLB for short) feature in Windows Server and that‚Äôs what we‚Äôre going to discuss in this post.Before we go, I‚Äôd like to point to a great article written by Justin Cook that is covering most bases but in a less for-dummies way. So, yeah‚Ä¶ I suppose this is the for-dummies version then. ;) Enjoy! PrerequisitesWe need to have the Network Load Balancing feature installed on all our targeted Management servers. The quick way to do this is using command-line (Windows Server 2008 R2 or later?). dism /online /enable-feature /featurename:NetworkLoadBalancingFullServer You also need a plan and some information about your new cluster. Make sure you have identified the following parameters before starting the configuration: A Dedicated Cluster IP-Address: A Dedicated Cluster DNS Name: A list of SCOM2012 Management Servers: You can use this pre-flight table to take note of your IP-address, DNS Name and Server List. Create a New ClusterOpen the Network Load Balancing Manager and create a new cluster. In the ‚ÄúNew Cluster‚Äù dialogue, connect to one of your Management Servers. Enter the name of a management server Click Connect Select the network interface to use Click Next Select the settings on your first host in the cluster. Make sure it‚Äôs the correct IP-address. Click Next Set the Cluster IP-address. Click Add Enter your Dedicated Cluster IP-Address and Subnet mask Click OK Click Next If need additional IP-addresses, like an IPv6 address, you simply repeat step 1-3 before proceeding to step 4. Edit DNS Names and Cluster Operation Mode. Select your Dedicated Cluster IP-address Enter your chosen Dedicated Cluster DNS Name Select Multicast mode Click Next Note: We are not going to delve into the Cluster Operation Mode in this guide, but this is what I use for Operations Manager 2012. If you want to learn more about these settings, here‚Äôs the KB on the various settings: http://support.microsoft.com/kb/323437Set your Port Rules and Affinity Settings. Verify that Affinity is set to ‚ÄúSingle‚Äù. If not, Click ‚ÄúEdit‚Ä¶‚Äù and adjust. Click Finish Note: ‚ÄúSingle‚Äù affinity tells the cluster to always direct the same client to the same host if possible. This is required to be able to support sessions. In the world of NLB, a ‚Äúclient‚Äù is an IP-address. Post-ConfigurationNow that you have a cluster configured you have to make sure your SDK-clients are able to resolve the dedicated cluster DNS-name. The one you picked in the pre-flight table. To enable name resolution you have to add your cluster DNS-name to your DNS-zone and point it to your dedicated cluster IP-address. Make it an A-record and it should work. If you intend to use the cluster name from outside the local network or subnet‚ÄîOperation Consoles or Powershell sessions for example‚Äîyou would also need to verify that the router is able to handle the multicast packages. I am by no means a network guy, but asking the person behind that ‚ÄúDon‚Äôt blame the network‚Äù sign to help you access a NLB cluster on network _X _from network Y usually works. One way to troubleshoot this is to ping the cluster DNS-name from one of the hosts. If that works but you are still unable to ping from another network or subnet, then it might be a router setting. Adding Hosts to the ClusterWith the cluster configured and up-and-running you need to add the rest of the Management Servers. Repeat this section for each Management Server you wish to add to the load-balancing cluster. In the Network Load Balancing Manager, right-click your cluster and select ‚ÄúAdd Host To Cluster‚Äù. Connect to your next Management Server to be added Enter the server name of the Management Server (‚Äúhost‚Äù in cluster terminology) Click Connect Select the IP-address of the host Click Next Verify your Host Parameters Doublecheck the IP-address Click Next Verify the Port Rules Make sure that Load is Equal and Affinity is Single Click Finish Final VerificationAfter each added host it would be proper to check if it was added correctly. The easiest way is to check their statuses in the Network Load Balancing Manager. Green is generally considered good and you want your hosts to be ‚ÄúConverged‚Äù. Another way to verify functionality is to point your Operations Manager console to the Cluster DNS-name instead and connect. If you are in a lab or in an environment where it is OK to shut down Management Servers you could try that as well. Considering my note on routers in the Cluster Post-Configuration I guess it would be prudent to point out that you should try launching SDK-sessions from all networks you intend to connect from. Just to make sure that your routers are correctly configured to handle these kinds of sessions. PostludeNow; as easy this may be I would personally argue that you should involve your network team before starting to deploy your load-balanced clusters. A little heads-up is always a good thing‚ÄîI have noticed that network people rarely like surprises‚Äîand they might actually be able to help you all the way is you ask nicely. And maybe they‚Äôll tell you right away that some configuration is required before-hand instead of giggling frantically in a corner at your feeble attempts to troubleshoot your fresh little cluster. Soooo‚Ä¶ have fun! And remember; with great powers come great responsibility. Sheesh! This post got out of hand!","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2012","slug":"ms/opsmgr2012","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2012/"}],"tags":[{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"},{"name":"How-To","slug":"How-To","permalink":"https://www.teknoglot.se/tag/How-To/"},{"name":"Highly-Available","slug":"Highly-Available","permalink":"https://www.teknoglot.se/tag/Highly-Available/"},{"name":"NLB","slug":"NLB","permalink":"https://www.teknoglot.se/tag/NLB/"},{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.teknoglot.se/tag/Tutorial/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2012","slug":"ms/opsmgr2012","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2012/"}]},{"title":"Quick-Hack: Send SMS through Powershell [#powershell]","slug":"quick-hack-send-sms-through-powershell-powershell","date":"2012-05-15T13:14:00.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"code/posh/quick-hack-send-sms-through-powershell-powershell/","link":"","permalink":"https://www.teknoglot.se/code/posh/quick-hack-send-sms-through-powershell-powershell/","excerpt":"Decided to do a quick-hack/fast-publish on this one as I have had a bit less time to create a nice clean production-ready version as of yet‚Ä¶ and people has been asking about how far off the article is. What this script does is to send a text message using a GSM/GPRS modem connected to a local (or LAN-connected with local drivers) serial port using Powershell. Disclaimer!This script ‚Äúworks‚Äù but is not fit for production. See it as an example of the general concept to evolve and adapt into something worthy of production use. What‚Äôs missing in the latest iteration is: A working Event-Handler to deal with asynchronous call-backs. Support for AT+MSGW (write to modem memory) Reusing messages in modem memory for multiple recipients. Various error- and exeption-handlers. Actually verifying that the modem is AT-capable. Querying the system for available modems and their ports. The ScriptSo, a short note before digging into the script. Prerequisites for this script is that you have identified which COM-port to use and it‚Äôs supported baud-rates and whether it supports DTR or not. If you do not know what the hell I am talking about, you could probably have it work with my preconfigured settings anyway. If you are unsure about if your modem supports AT commands you could open a serial connection to the modem using Hyperterminal or PuTTY and run AT+CMGF=1. If supported, the return should be OK. If it is not supported (you get ERROR instead) you would have to use PDU-mode which require a bit of hex-encoding of your messages. This is nothing I have had to do yet and will not be including in this script. Maybe in the future. Maybe. So, looking a some powershelling then. First thing would be to connect to the modem. # Create your instance of the SerialPort Class$serialPort = new-Object System.IO.Ports.SerialPort# Set various COM-port settings$serialPort.PortName = \"COM1\"$serialPort.BaudRate = 19200$serialPort.WriteTimeout = 500$serialPort.ReadTimeout = 3000$serialPort.DtrEnable = \"true\"# Open the connection$serialPort.Open()","text":"Decided to do a quick-hack/fast-publish on this one as I have had a bit less time to create a nice clean production-ready version as of yet‚Ä¶ and people has been asking about how far off the article is. What this script does is to send a text message using a GSM/GPRS modem connected to a local (or LAN-connected with local drivers) serial port using Powershell. Disclaimer!This script ‚Äúworks‚Äù but is not fit for production. See it as an example of the general concept to evolve and adapt into something worthy of production use. What‚Äôs missing in the latest iteration is: A working Event-Handler to deal with asynchronous call-backs. Support for AT+MSGW (write to modem memory) Reusing messages in modem memory for multiple recipients. Various error- and exeption-handlers. Actually verifying that the modem is AT-capable. Querying the system for available modems and their ports. The ScriptSo, a short note before digging into the script. Prerequisites for this script is that you have identified which COM-port to use and it‚Äôs supported baud-rates and whether it supports DTR or not. If you do not know what the hell I am talking about, you could probably have it work with my preconfigured settings anyway. If you are unsure about if your modem supports AT commands you could open a serial connection to the modem using Hyperterminal or PuTTY and run AT+CMGF=1. If supported, the return should be OK. If it is not supported (you get ERROR instead) you would have to use PDU-mode which require a bit of hex-encoding of your messages. This is nothing I have had to do yet and will not be including in this script. Maybe in the future. Maybe. So, looking a some powershelling then. First thing would be to connect to the modem. # Create your instance of the SerialPort Class$serialPort = new-Object System.IO.Ports.SerialPort# Set various COM-port settings$serialPort.PortName = \"COM1\"$serialPort.BaudRate = 19200$serialPort.WriteTimeout = 500$serialPort.ReadTimeout = 3000$serialPort.DtrEnable = \"true\"# Open the connection$serialPort.Open() With the connection established, you the set to modem in AT-mode and start sending the message to the modem. # Tell the modem you want to use AT-mode$serialPort.Write(\"AT+CMGF=1`r`n\")# Start feeding message data to the modem# Begin with the phone number, international# style and a &lt;CL&gt;... that's the `r`n part$serialPort.Write(\"AT+CMGS=`\"+46888888888`\"`r`n\")# Now, write the message to the modem$serialPort.Write(\"This is a test!`r`n\")# Send a Ctrl+Z to end the message.$serialPort.Write($([char] 26)) As you may notice, the message is only stored in the modems memory until you send a Ctrl+z which will end the message and send it. It is possible to add more text to the message before sending it if you would like. Personally, I prefer to store the message into a regular powershell variable and pass that one to the script. The SerialPort library is sort of clever and a local phone number will probably work. For safety, I always use international number with country code as it will work every time. Only thing left now is to close the serial port connection and end the script. Like this. $serialPort.Close() The Copy/Paste partHere‚Äôs the entire script with some added control-features and check to avoid trying to send text messages with no serial connection. ### DISCLAIMER ##### This script is a quick-hack to demonstrate## the basics of sending an SMS using an AT-## compatible GSM modem connected a local## serial port through PowerShell.## No error-handling is implemented and this## is NOT a script fit for production.################### Create your instance of the SerialPort Class$serialPort = new-Object System.IO.Ports.SerialPort# Set various COM-port settings$serialPort.PortName = \"COM1\"$serialPort.BaudRate = 19200$serialPort.WriteTimeout = 500$serialPort.ReadTimeout = 3000$serialPort.DtrEnable = \"true\"# Open the connection$serialPort.Open()# Add variables for phone number and the message.$phoneNumber = \"+46888888888\"$textMessage = \"This is a test message!\"try &#123; $serialPort.Open()&#125;catch &#123; # Wait for 5s and try again # Told you this is a quick-hack, right? Start-Sleep -Seconds 5 $serialPort.Open()&#125;If ($serialPort.IsOpen -eq $true) &#123; # Tell the modem you want to use AT-mode $serialPort.Write(\"AT+CMGF=1`r`n\") # Start feeding message data to the modem # Begin with the phone number, international # style and a &lt;CL&gt;... that's the `r`n part $serialPort.Write(\"AT+CMGS=`\"$phoneNumber`\"`r`n\") # Give the modem some time to react... Start-Sleep -Seconds 1 # Now, write the message to the modem $serialPort.Write(\"$textMessage`r`n\") # Send a Ctrl+Z to end the message. $serialPort.Write($([char] 26)) # Wait for modem to send it Start-Sleep -Seconds 1&#125;# Close the Serial Port connection$serialPort.Close()if ($serialPort.IsOpen -eq $false) &#123; echo \"Port Closed!\"&#125;# That's all folks# Now, add call-backs, event-handlers, and return-# message handling. Enjoy!","categories":[{"name":"Code","slug":"code","permalink":"https://www.teknoglot.se/topics/code/"},{"name":"PoSH","slug":"code/posh","permalink":"https://www.teknoglot.se/topics/code/posh/"}],"tags":[{"name":"PoSH","slug":"PoSH","permalink":"https://www.teknoglot.se/tag/PoSH/"},{"name":"GSM","slug":"GSM","permalink":"https://www.teknoglot.se/tag/GSM/"},{"name":"Quick-hack","slug":"Quick-hack","permalink":"https://www.teknoglot.se/tag/Quick-hack/"},{"name":"SMS","slug":"SMS","permalink":"https://www.teknoglot.se/tag/SMS/"}],"keywords":[{"name":"Code","slug":"code","permalink":"https://www.teknoglot.se/topics/code/"},{"name":"PoSH","slug":"code/posh","permalink":"https://www.teknoglot.se/topics/code/posh/"}]},{"title":"Rant - The Concept of Booth-Babes","slug":"rant-the-concept-of-booth-babes","date":"2012-05-08T16:18:05.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"tb/rant-the-concept-of-booth-babes/","link":"","permalink":"https://www.teknoglot.se/tb/rant-the-concept-of-booth-babes/","excerpt":"BackgroundHaving visited a few conferences in the last years I have spotted a trend I didn‚Äôt think I would see in the IT-Pro sphere. You could probably call me na√Øve for that but logically we should not encourage this trend. This is my appeal to all exhibitors of future conferences to re-evaluate the concept of booth-babes. I will not go into the genus-political part of this discussion as of now‚Äìothers are more eloquent and fit to handle that‚Äìbut rather some of the more pragmatic sides to ditch the BB (short for Booth-Babe) and how that would gain us visitors as well as the exhibitors. I will also keep a pretty frank, and perhaps impolite, tone in this rant of mine. So, here‚Äôs my top reasons, in no particular order, to give up the BBs. Reason #1 - BBs is disrupting the purpose of the exhibitionWhen I go to a conference, I am there for the tech, to network and shake paws with the people I collaborate with on-line. It is also a good place to meet the actual corporations that I do business with and discuss their products between four eyes.I do not want to plow through a crowd of great white whales [Oops! I meant ‚Äúmales‚Äù] ogling the BBs to get to someone with actual knowledge about the products and solutions at hand. Reason #2 - BBs are alienating the visitorsIf you are a heterosexual male or a homosexual female, the BBs can actually make you embarrassed, shy and unwilling to approach the exhibitor for that sole reason.If you are not, you might find an exhibitor with BBs appalling and take another route for that sole reason. Reason #3 - BBs are intimidating the female visitors","text":"BackgroundHaving visited a few conferences in the last years I have spotted a trend I didn‚Äôt think I would see in the IT-Pro sphere. You could probably call me na√Øve for that but logically we should not encourage this trend. This is my appeal to all exhibitors of future conferences to re-evaluate the concept of booth-babes. I will not go into the genus-political part of this discussion as of now‚Äìothers are more eloquent and fit to handle that‚Äìbut rather some of the more pragmatic sides to ditch the BB (short for Booth-Babe) and how that would gain us visitors as well as the exhibitors. I will also keep a pretty frank, and perhaps impolite, tone in this rant of mine. So, here‚Äôs my top reasons, in no particular order, to give up the BBs. Reason #1 - BBs is disrupting the purpose of the exhibitionWhen I go to a conference, I am there for the tech, to network and shake paws with the people I collaborate with on-line. It is also a good place to meet the actual corporations that I do business with and discuss their products between four eyes.I do not want to plow through a crowd of great white whales [Oops! I meant ‚Äúmales‚Äù] ogling the BBs to get to someone with actual knowledge about the products and solutions at hand. Reason #2 - BBs are alienating the visitorsIf you are a heterosexual male or a homosexual female, the BBs can actually make you embarrassed, shy and unwilling to approach the exhibitor for that sole reason.If you are not, you might find an exhibitor with BBs appalling and take another route for that sole reason. Reason #3 - BBs are intimidating the female visitorsThere is, of course, exceptions to this, but I actually discussed this matter with a couple of gentlewomen in the alumni lounge and they did say that they are both appalled and intimidated to the slightly clad BBs at one particular booth at this years MMS. They even used terms like ‚Äúridiculous‚Äù and ‚Äúwaste of space‚Äù to describe the phenomena.Now, I believe I can hear some of you readers thinking ‚Äúwhat? Nice addition to the boring screens and ‚Ä¶‚Äù. But imaging the opposite for a while. Imagine a whole bunch of Booth-Hunks instead. You know, Brad Pitt in Fight Club and the likes. I know I would be intimidated by that kind of display. Reason #4 - BBs makes it hard to know who to talk toBecause of the BBs, it can at time be hard to know if the lady at the booth just happen to be a nice-looking knowledgeable tech-specialist or simply someone there for eye-candy. Too many times have I had a conversation like this: - &quot;Hi! So, tell me about [SystemX]. It looks kinda interesting on paper.&quot;- &quot;Hi! Uh, oh! Yeah! You should probably be talking to that guy over there. I don&apos;t really know anything about their stuff.&quot; I hate it. I want to be able to pick anyone in the booth and get a cohesive answer. You cannot be expert on everything and some people are more marketing focused, but at least they can give you the big picture before calling some techy fellow. Last year I had a really nice discussion with a nice lady from EMC that later led to get access to to some beta code. Unfortunately, I had by then grown tired of the BBs and merely approached her since there were lines to the male exhibitors. Which brings me to‚Ä¶ Reason #5 - Having BBs is disrespecting your female colleagues.There you are. You most certainly have some very talented women in your development teams‚Äìmy experience is that‚Äôs where you‚Äôll find most of them, as architects and lead developers‚Äìbut for some reason your decide to hire a bunch of BBs to ‚Äúspice it up a little‚Äù, ‚Äúdraw a little crowd‚Äù, ‚Äúget the attention‚Äù and so forth. Do you really think your female colleagues appreciate that? Isn‚Äôt that diminishing their talent a bit? I am sure that those who attend conferences for technical reasons and to do a bit of networking would take a nice technical discussion with anyone, however geeky she/he might be, rather than side-stepping a crowd or some figure-head on my way there. I don‚Äôt know. Maybe I am alone in this matter, but I‚Äôd really like to see this change. I would really like to see vendors and exhibitors trying to dazzle the visitors with great displays, clever uses of software and mind-blowing products and not scantily clad women. Ah, well. Thanks for your time.","categories":[{"name":"Technobabble","slug":"tb","permalink":"https://www.teknoglot.se/topics/tb/"}],"tags":[{"name":"Rant","slug":"Rant","permalink":"https://www.teknoglot.se/tag/Rant/"},{"name":"Conference","slug":"Conference","permalink":"https://www.teknoglot.se/tag/Conference/"}],"keywords":[{"name":"Technobabble","slug":"tb","permalink":"https://www.teknoglot.se/topics/tb/"}]},{"title":"Parameter Replacement in AlertName","slug":"parameter-replacement-in-alertname","date":"2012-04-09T20:04:48.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2007/parameter-replacement-in-alertname/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2007/parameter-replacement-in-alertname/","excerpt":"‚Ä¶and why you should not use itA DisclaimerI have had serious doubts about actually writing this article for almost a year now for reasons that I will explain further on. But as others have discovered this ‚Äúfeature‚Äù as well‚Äìmaybe ‚Äúhack‚Äù would be a better name for it‚ÄìI feel the need to explain how it works and also why you should not use it. Knowledge is power, and even if I advice against using this technique it is also a good way to understand how SCOM uses display-strings in management packs. The Good NewsYes, you can use parameter replacement in you AlertName. With ‚Äúparameter replacement‚Äù i mean using some kind of substitute text, or mnemonic if you like, that at run-time get translated into something useful. If you have written any kind of alert generating rules or monitors, you most like included something like $Data/Context/Property[@Name=‚ÄôSomeDataFromAPropertyBag‚Äô]$ into your alert description. In this dialog, you also have the possibility to set the Alert Name. And if you are lazy, like I am, you probably also noticed that it is impossible to insert any kind of dynamic data into that field as well. This is especially annoying when you are writing a management pack that needs to look different in the Alert Views in the console, and you want to monitor 50 different Events or Performance counters or Log entries that are pretty much the same apart from a Name or ID.Of course I could not refrain from copy-pasting a $Data/Context‚Ä¶$ into the alert name only to realize that it simply is not being parsed and translated into the value of the specified parameter. Over time I have settled for a stand-point that it‚Äôs probably a performance issue and I have also used that as an argument for this apparent lack of simplicity that some of my customers have been questioning. Two, maybe three, years later. Microsoft releases an update to the core agent monitoring packs. Much to my surprise, one performance monitor suddenly generated alerts with a dynamic performance value in the Alert Name. You know, that field that is not gettingt parsed I was mentioning in the earlier paragraph. It actually looked pretty bad and made it very much impossible to practice any kind of alert supression, but still. It actually had a parsed value in the Alert Name.As the lack of this feature had me irked before, I exported the core MP and started reading through the XML to find out how they did it. To my surprise, it was actually pretty simple if you ditched the Authoring Console and used your trusty text-editor instead. How To Do ItIn simple terms, if you know your SCOM XML out-side-in, you add the parameters to your ‚ÄúAlert‚Äù and modify your DisplayString, the one under LanguagePacks, to call that parameter by it‚Äôs relative ID.","text":"‚Ä¶and why you should not use itA DisclaimerI have had serious doubts about actually writing this article for almost a year now for reasons that I will explain further on. But as others have discovered this ‚Äúfeature‚Äù as well‚Äìmaybe ‚Äúhack‚Äù would be a better name for it‚ÄìI feel the need to explain how it works and also why you should not use it. Knowledge is power, and even if I advice against using this technique it is also a good way to understand how SCOM uses display-strings in management packs. The Good NewsYes, you can use parameter replacement in you AlertName. With ‚Äúparameter replacement‚Äù i mean using some kind of substitute text, or mnemonic if you like, that at run-time get translated into something useful. If you have written any kind of alert generating rules or monitors, you most like included something like $Data/Context/Property[@Name=‚ÄôSomeDataFromAPropertyBag‚Äô]$ into your alert description. In this dialog, you also have the possibility to set the Alert Name. And if you are lazy, like I am, you probably also noticed that it is impossible to insert any kind of dynamic data into that field as well. This is especially annoying when you are writing a management pack that needs to look different in the Alert Views in the console, and you want to monitor 50 different Events or Performance counters or Log entries that are pretty much the same apart from a Name or ID.Of course I could not refrain from copy-pasting a $Data/Context‚Ä¶$ into the alert name only to realize that it simply is not being parsed and translated into the value of the specified parameter. Over time I have settled for a stand-point that it‚Äôs probably a performance issue and I have also used that as an argument for this apparent lack of simplicity that some of my customers have been questioning. Two, maybe three, years later. Microsoft releases an update to the core agent monitoring packs. Much to my surprise, one performance monitor suddenly generated alerts with a dynamic performance value in the Alert Name. You know, that field that is not gettingt parsed I was mentioning in the earlier paragraph. It actually looked pretty bad and made it very much impossible to practice any kind of alert supression, but still. It actually had a parsed value in the Alert Name.As the lack of this feature had me irked before, I exported the core MP and started reading through the XML to find out how they did it. To my surprise, it was actually pretty simple if you ditched the Authoring Console and used your trusty text-editor instead. How To Do ItIn simple terms, if you know your SCOM XML out-side-in, you add the parameters to your ‚ÄúAlert‚Äù and modify your DisplayString, the one under LanguagePacks, to call that parameter by it‚Äôs relative ID. Just in case you happen to be a regular mortal, here‚Äôs the step-by-step guide. ;) In this example I have created a silly-simple Alert Generating EventLog rule in wich I have added some parameters to the description. It pretty much looks like this: Saving the MP at this point I will have a new WriteAlert action with a bunch of parameters and a displaystring with a unique ID.The resulting XML-code for the WriteAlert action looks like this: [xml highlight=\"7,8,9,10,11,12,13\"]&lt;WriteAction ID=\"Alert\" TypeID=\"Health!System.Health.GenerateAlert\"&gt; &lt;Priority&gt;1&lt;/Priority&gt; &lt;Severity&gt;2&lt;/Severity&gt; &lt;AlertName /&gt; &lt;AlertDescription /&gt; &lt;AlertOwner /&gt; &lt;AlertMessageId&gt;$MPElement[Name=\"TestMP.MyEventlogAlertRule.AlertMessage\"]$&lt;/AlertMessageId&gt; &lt;AlertParameters&gt; &lt;AlertParameter1&gt;$Data/EventDescription$&lt;/AlertParameter1&gt; &lt;AlertParameter2&gt;$Data/LoggingComputer$&lt;/AlertParameter2&gt; &lt;AlertParameter3&gt;$Data/UserName$&lt;/AlertParameter3&gt; &lt;AlertParameter4&gt;$Data/EventNumber$&lt;/AlertParameter4&gt; &lt;/AlertParameters&gt; &lt;Suppression /&gt; &lt;Custom1 /&gt; &lt;Custom2 /&gt; &lt;Custom3 /&gt; &lt;Custom4 /&gt; &lt;Custom5 /&gt; &lt;Custom6 /&gt; &lt;Custom7 /&gt; &lt;Custom8 /&gt; &lt;Custom9 /&gt; &lt;Custom10 /&gt;&lt;/WriteAction&gt; In this slab of code, you‚Äôve got the Parameters, their ‚Äúrelative ID‚Äù (the number in the Tag), and also the which is what you would need to search for among the displaystrings. Take note of the you want to use in your AlertName since you are going to need it later. A quick search for ‚ÄúTestMP.MyEventlogAlertRule.AlertMessage‚Äù will lead you to the actual message, which should looke similar to this: &lt;DisplayString ElementID=\"TestMP.MyEventlogAlertRule.AlertMessage\"&gt; &lt;Name&gt;I want Parameter Replacement here:&lt;/Name&gt; &lt;Description&gt;Event Description: &#123;0&#125;&#123;1&#125;&#123;2&#125;&#123;3&#125; &lt;/Description&gt;&lt;/DisplayString&gt; You should have one of these for every language you have configured in your management pack.As you may notice, the Description does not contain any XPaths of any kind but rather references to the parameters defined in the WriteAction. That would be the {X} thingies within the description tags. You may also notice that the AlertParameters starts from ‚Äú1‚Äù while the parameter references begin with ‚Äú0‚Äù. In practice, that means that {0} in the displaystring definition equals to AlertParameter1 and so forth. Now, with this in mind, adding a Parameter to AlertName if very simple and straight-forward. Simply decide which parameter your want to use and add it‚Äôs reference to the Name definition.So, let‚Äôs say I have the above alert message and I want to include UserName in the Alert Name, I would change the tag to: &lt;Name&gt;I want Parameter Replacement here:&#123;2&#125;&lt;/Name&gt; That‚Äôs it folks!Save the XML, make sure you verify it and import it into your Operations Manager LAB and watch the magic. Just make sure you continue reading this post as the next part about the downsides is pretty important. The DownsideThe negative effects of using Parameter Replacement in AlertName really boils down to two main perspectives. These are, if I may say to, pretty major and is the reason I have been reluctant on posting this, sort of, how-to. You are breaking your subscriptions and connectorsApparently, parameter replacement is not working in subscriptions and connectors, be it 3:rd-party, Universal, Orchestrator IPs et.c. Basically anything other than the Operations Console will not be able to handle your parameters in AlertName. This will give you a ‚Äú{1} in {2} has received an error‚Äù instead of ‚Äúveryimportant.log in C:\\Logs\\ImportantSystem\\ has received an error‚Äù in anything except the Operations Console. Now, this might not be a bad thing if the Operations Console is your only interface to Operations Manager, but if you would like to forward these alerts to a mobile phone, IM user or a mail recipient it will be utterly useless. I have not verified this, but I am not sure if Alert Suppression is actually parsing the parameters as well. Also. If you, by means of connectors or System Center Orchestrator, are generating incidents from alerts the AlertName forwarded will be equally useless for anyone receiving it. It‚Äôs killing your health perspectiveMight sound drastic, but I‚Äôm quite serious about this. Using Parameter Replacement in AlertName might be useful for alert generating rules, but should never be used in a monitor. The reason is pretty simple actually. If you are using a monitor, you are without a doubt interested in it‚Äôs state. Otherwise, you would not use a monitor, am I right? I cannot see how it would make sense to create a monitor that does not reflect the health of a specific checkpoint. Much less having a monitor generating alerts that might confuse any service desk operator about what monitor that caused the alert. Also‚ÄìI have not tested this‚ÄìI assume that a monitor would not update it‚Äôs AlertName once the alert are generated making it more difficult to troubleshoot. Alert generating rules are, to me, something I tend to use only when all other options fail for some reason and I do not like to monitor things to cannot have health. And since parameters in AlertName is nothing for monitors I also question whether it actually is usable at all. The ConclusionWhile this is an interesting techique and a good way to enjoy MP Authoring and learn about the behaviour of display strings and languages in you Management Packs, I would definitely consider it a mostly academical exercise. Only in extreme use-cases and situations would I consider it a viably option and while it might look good in the console, do be aware of the limitations. I have also not seen anything about it on MSDN, and I have serious doubts about it being a supported feature. I have personally been using it in transition to a ‚Äúbetter‚Äù management pack to get alerting running quickly, yet a prefered solution would actually be using a custom datasouce and a decent macro-enabled text-editor‚Äìnot to mention snippets‚Äìto bulk-generate your monitors and/or rules. MP Authoring is fun and powerful ‚Äì be resposible","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}],"tags":[{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"},{"name":"MP Development","slug":"MP-Development","permalink":"https://www.teknoglot.se/tag/MP-Development/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}]},{"title":"Virtual OpenVPN Server at Home","slug":"virtual-openvpn-server-at-home","date":"2011-09-28T06:37:39.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"Linux/virtual-openvpn-server-at-home/","link":"","permalink":"https://www.teknoglot.se/Linux/virtual-openvpn-server-at-home/","excerpt":"I was going to write a post on how to install and configure your own virtual SSL-VPN server as I had in mind to make one myself as a means to surf safely while on hotspots and to access my System Center lab at home. I‚Äôm not gonna do that. Instead I just want to point to this free, already pre-configured, OpenVPN Virtual Appliance. Just follow its instructions and it will work quite nicely. Have fun.","text":"I was going to write a post on how to install and configure your own virtual SSL-VPN server as I had in mind to make one myself as a means to surf safely while on hotspots and to access my System Center lab at home. I‚Äôm not gonna do that. Instead I just want to point to this free, already pre-configured, OpenVPN Virtual Appliance. Just follow its instructions and it will work quite nicely. Have fun.","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.teknoglot.se/topics/Linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.teknoglot.se/tag/Linux/"},{"name":"OpenVPN","slug":"OpenVPN","permalink":"https://www.teknoglot.se/tag/OpenVPN/"},{"name":"Virtual Appliance","slug":"Virtual-Appliance","permalink":"https://www.teknoglot.se/tag/Virtual-Appliance/"}],"keywords":[{"name":"Linux","slug":"Linux","permalink":"https://www.teknoglot.se/topics/Linux/"}]},{"title":"OpsMgr 2007 R2 Documentation","slug":"opsmgr-2007-r2-documentation","date":"2011-08-08T20:52:27.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2007/opsmgr-2007-r2-documentation/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2007/opsmgr-2007-r2-documentation/","excerpt":"Here a link to the System Center Operations Manager 2007 R2 Documentation for those of you out there who keeps asking of its whereabouts and then tell me to not tell you to google for it. So now I can direct you to my site, tell you to click on ‚ÄúOpsMgr 2007‚Äù to the left and browse through my posts instead of wasting precious time on googling and pretend being more helpful.To the rest of the world, sorry for wasting your time! Happy now, eh?","text":"Here a link to the System Center Operations Manager 2007 R2 Documentation for those of you out there who keeps asking of its whereabouts and then tell me to not tell you to google for it. So now I can direct you to my site, tell you to click on ‚ÄúOpsMgr 2007‚Äù to the left and browse through my posts instead of wasting precious time on googling and pretend being more helpful.To the rest of the world, sorry for wasting your time! Happy now, eh?","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}],"tags":[{"name":"Rant","slug":"Rant","permalink":"https://www.teknoglot.se/tag/Rant/"},{"name":"Sillyness","slug":"Sillyness","permalink":"https://www.teknoglot.se/tag/Sillyness/"},{"name":"Teach a Man to Fish","slug":"Teach-a-Man-to-Fish","permalink":"https://www.teknoglot.se/tag/Teach-a-Man-to-Fish/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}]},{"title":"Bulk disable ACS Forwarders (with wildcards)","slug":"bulk-disable-acs-forwarders-with-wildcards","date":"2011-07-07T08:59:24.000Z","updated":"2017-09-28T15:57:00.000Z","comments":true,"path":"ms/opsmgr2007/bulk-disable-acs-forwarders-with-wildcards/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2007/bulk-disable-acs-forwarders-with-wildcards/","excerpt":"Here‚Äôs a little something-something for the wicked. Me and my apprentice is currently decommissioning an entire Management Group with a thousand (-ish) agents. Long story short, we got a new Management Group, migrated all the agents, added a couple of hundreds more, deployed a bunch of gateways and now we are shutting down the old one. Now, uninstalling the old Management Group from all the agents is a breeze using SCCM and handling the few 20-ish servers that are left is not a biggie either. Shutting down ACS, however, is a different matter. Although you do configure your forwarders using Operations Manager, removing the management group you were running ACS in does not mean the agents will shut down and disable the AdtAgent service or stop trying to forward audit events to your collector. Now, selecting 10 agents at the time and running the ‚ÄúDisable Audit Collection‚Äù task‚Äìin case you did not know, there‚Äôs a limitation on how many agents you can run a task on in the Operations Console‚Äìis not my idea of a jolly good day and since Powershell is a bucket of joy in comparison; here‚Äôs a script for you all! DisableACSForwarders It is zipped to avoid security alerts, but as with any script found on the internet I implore to to read the code before actually running it. Anyway, you can use it in a couple of ways. To run it interactively, just go to the directory where you unpacked it and run it. You will be requested to enter the FQDN of you Root Management Server and a wildcard search for ACS Forwarders.For example: C:\\..\\Scripts&gt; .\\DisableACSForwarders.ps1Root Management Server: rms.teknoglot.localACS Forwarder name (wildcard): *.teknoglot.local","text":"Here‚Äôs a little something-something for the wicked. Me and my apprentice is currently decommissioning an entire Management Group with a thousand (-ish) agents. Long story short, we got a new Management Group, migrated all the agents, added a couple of hundreds more, deployed a bunch of gateways and now we are shutting down the old one. Now, uninstalling the old Management Group from all the agents is a breeze using SCCM and handling the few 20-ish servers that are left is not a biggie either. Shutting down ACS, however, is a different matter. Although you do configure your forwarders using Operations Manager, removing the management group you were running ACS in does not mean the agents will shut down and disable the AdtAgent service or stop trying to forward audit events to your collector. Now, selecting 10 agents at the time and running the ‚ÄúDisable Audit Collection‚Äù task‚Äìin case you did not know, there‚Äôs a limitation on how many agents you can run a task on in the Operations Console‚Äìis not my idea of a jolly good day and since Powershell is a bucket of joy in comparison; here‚Äôs a script for you all! DisableACSForwarders It is zipped to avoid security alerts, but as with any script found on the internet I implore to to read the code before actually running it. Anyway, you can use it in a couple of ways. To run it interactively, just go to the directory where you unpacked it and run it. You will be requested to enter the FQDN of you Root Management Server and a wildcard search for ACS Forwarders.For example: C:\\..\\Scripts&gt; .\\DisableACSForwarders.ps1Root Management Server: rms.teknoglot.localACS Forwarder name (wildcard): *.teknoglot.local You can also run it with parameters (for scheduling?) like this: C:\\..\\Scripts&gt; .\\DisableACSForwarders.ps1 rms.teknoglot.local *.teknoglot.local If you need to run the task with different credentials there‚Äôs a switch for that. Just add -UseCredentials to the command and you will be prompted for it.Like this: C:\\..\\Scripts&gt; .\\DisableACSForwarders.ps1 -UseCredentials As you might already have realized, the wildcard search does not require actual wildcards. If you only want to disable the ACS forwarder on a single machine, just enter it‚Äôs FQDN. As for what wildcards it will accept; anything supported by the powershell -like operator is valid. [UPDATE!] You might get false failures when running the script on clustered machines because of a bug in the AC Management Pack For the source code, read on! ## Using parameters for RMS and wildcard searchparam( [string]$rootManagementServer = $(Read-Host -Prompt \"Root Management Server\" ), [string]$filterAgents = $(Read-Host -Prompt \"ACS Forwarder name (wildcard)\" ), [switch]$UseCredentials)## Make sure the $rootManagementServer variable is definedwhile (-not $rootManagementServer) &#123; Write-Host \"`nRoot Management Server MUST be defined!\" -ForegroundColor Red [string]$rootManagementServer = $(Read-Host -Prompt \"Root Management Server\" )&#125;if ($UseCredentials -eq $true) &#123; $taskCredentials = Get-Credential&#125;$startLocation = Get-Location$checkPSSnapin = Get-PSSnapin | where &#123;$_.Name -eq \"Microsoft.EnterpriseManagement.OperationsManager.Client\" &#125;if ($checkPSSnapin -eq $null) &#123; Add-PSSnapin \"Microsoft.EnterpriseManagement.OperationsManager.Client\"&#125;$result = Set-Location \"OperationsManagerMonitoring::\"$result = New-ManagementGroupConnection -ConnectionString:$rootManagementServer$result = Set-Location $rootManagementServer$acsForwarderClass = Get-MonitoringClass -Name \"Microsoft.SystemCenter.ACS.Forwarder\"$agentNames = Get-MonitoringObject -monitoringclass:$acsForwarderClass | where &#123;$_.Path -like $filterAgents&#125; | Select Path$successfulTasks = @()$skippedTasks = @()$failedTasks = @()$monitoringClass = Get-MonitoringClass -Name \"Microsoft.SystemCenter.Agent\"if ($agentNames -ne $null) &#123; Write-Host \"`nFound\" $agentNames.Count\"ACS forwarders with wildcard $filterAgents\" Write-Host \"`n`nWaiting for 5 seconds to give you a chance to abort!`n\" Start-Sleep -Seconds 5 Write-Host \"Time's UP!`n`n\" $agentNames | ForEach-Object &#123; $agentName = $_.Path Write-Host \"Disabling Audit Collection on\" $agentName $monitoringObject = Get-MonitoringObject -monitoringclass:$monitoringClass | where &#123;$_.DisplayName -like $agentName&#125; $agentTask = $monitoringObject | Get-Task | where &#123;$_.Name -eq \"Microsoft.SystemCenter.DisableAuditCollectionService\" &#125; if ($monitoringObject.IsAvailable -eq $true) &#123; if ($credentials -eq $null) &#123; $result = Start-Task -Task $agentTask -TargetMonitoringObject $monitoringObject &#125; else &#123; $result = Start-Task -Task $agentTask -TargetMonitoringObject $monitoringObject -Credential $taskCredentials &#125; if ($result.Status -eq \"Succeeded\" ) &#123; Write-Host \"Operation Successful!\" -ForegroundColor Green Write-Host `n $successfulTasks += $agentName &#125; else &#123; Write-Host \"Operation failed.\" -ForegroundColor Red Write-Host $result.ErrorMessage Write-Host `n $failedTasks += $agentName &#125; &#125; else &#123; Write-Host \"The agent is unavailable, Skipping!\" Write-Host `n $skippedTasks += $agentName &#125; &#125; Write-Host \"Summary\" Write-Host \"`tSuccessful:`t\" $successfulTasks.count Write-Host \"`tFailed:`t`t\" $failedTasks.count Write-Host \"`tSkipped:`t\" $skippedTasks.count&#125;else &#123; Write-Host \"`nNo ACS Forwarders found using wildcard $filterAgents\"&#125;Set-Location $startLocation Enjoy!","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}],"tags":[{"name":"ACS","slug":"ACS","permalink":"https://www.teknoglot.se/tag/ACS/"},{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"},{"name":"PoSH","slug":"PoSH","permalink":"https://www.teknoglot.se/tag/PoSH/"},{"name":"Script","slug":"Script","permalink":"https://www.teknoglot.se/tag/Script/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}]},{"title":"OpsMgr 2007 Connectivity Map","slug":"opsmgr-2007-connectivity-map","date":"2011-05-17T09:47:18.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2007/opsmgr-2007-connectivity-map/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2007/opsmgr-2007-connectivity-map/","excerpt":"I‚Äôve had this little visio drawing lying around on my desktop for a while now and I thought that it might be a nice thing to share. It is nothing ground breaking at all and all the information is available at the Operations Manager 2007 R2 Supported Configurations page on Technet, but I find the visual map easier to read and I use it personally to quickly look up all port openings for the most common components in Operations Manager. It is missing a few components like ACS, AEM and XPlat, but I usually just look them up when needed. Have fun!","text":"I‚Äôve had this little visio drawing lying around on my desktop for a while now and I thought that it might be a nice thing to share. It is nothing ground breaking at all and all the information is available at the Operations Manager 2007 R2 Supported Configurations page on Technet, but I find the visual map easier to read and I use it personally to quickly look up all port openings for the most common components in Operations Manager. It is missing a few components like ACS, AEM and XPlat, but I usually just look them up when needed. Have fun!","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}],"tags":[{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"},{"name":"Quick Reference","slug":"Quick-Reference","permalink":"https://www.teknoglot.se/tag/Quick-Reference/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}]},{"title":"Introduction to TG WinAutoSvc v1","slug":"introduction-to-tg-winautosvc-v1","date":"2011-04-29T09:35:47.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2012/introduction-to-tg-winautosvc-v1/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2012/introduction-to-tg-winautosvc-v1/","excerpt":"BackgroundFor quite some time now I‚Äôve had this idea spinning around in my head to write a couple of blog-posts about some of the more useful techniques available when building management packs. Many of these techniques are already described on MSDN and Technet- or other blogs as well as on various forums, but often no more than small bits and pieces of them and I have yet to see some humanly readable information about how to tie them together into a useful management pack. I say ‚Äúhumanly readable‚Äù because the information you do find online so far may be clear and somewhat easy to understand for someone with a system development background and a pretty good idea of how object oriented development models tend to work. But the real life System Center Operations Manager engineer‚Äìyou know the one who get those ‚Äúdo you think we could monitor our ‚Ä¶-system too?‚Äù questions a couple of times a week, you know‚Ä¶ you (most likely, being here)‚Äìtend to have a completely different background. Yet as their OpsMgr environment grows, so does the demand for custom monitoring and all of a sudden the former server engineer are now also a developer. A developer who has never before had the need to grasp such abstract concepts as classes, instances, inheritance and who probably never before have had any reason whatsoever to write any XML code. PurposeMy idea for this series of posts is to shed some light into the world of the authoring console and modules and cookdown and so forth. I am by no means an accredited author, but I will do my best to stay human in this venture and in plain english try to explain why and how you do certain things when going from Management Pack templates, rules, monitors and the safe haven that is authoring in the Operations Console into making your scripts resuable, easy to extend and prime for cookdown using the Authoring Console and XML. The TG WinAutoSvc Management PackTo give the series some kind of context and at the same time not only be a matter of examples I will base them on a fully functional management pack that discovers and monitors all Windows services that are set to automatic startup. I know there is other similar management packs out there but I haven‚Äôt fancied any one of them yet, and since I had the idea of writing this series I decided that building a new one would be a good way to go. Some of the interesting features with this management pack is: You will get an instance of the service classes for each and every service. It uses different classes for Own Process services and Shared Process services (svchost for example). Every service have a health state (you can use them in distributed applications). The service state monitors are inherited from their base classes, no coding neccesary. There is only one discovery script for all kinds of windows services. Extending the discovery to include different kinds of windows services, like kernel processes, is a matter of filtering. It is Open Source and licensed under the Eclipse Public License v1. Most of these features will be described thoroughly in later posts in the series and as development of it progresses I will document what I do, how I do it and why I do it in certain ways. Hopefully you will learn something new through this and get closer to becoming that MP Dev the organization asks for.In the mean time, feel free to download, look at the source code (which it by no means perfect) and try it out. The TG WinAutoSvc monitoring management pack is available for download here:http://code.google.com/p/tg-winautosvc/downloads/detail?name=TG.WinAutoSvc.xml The latest revision of the source code is located here:http://code.google.com/p/tg-winautosvc/source/browse/trunk/TG.WinAutoSvc.xml","text":"BackgroundFor quite some time now I‚Äôve had this idea spinning around in my head to write a couple of blog-posts about some of the more useful techniques available when building management packs. Many of these techniques are already described on MSDN and Technet- or other blogs as well as on various forums, but often no more than small bits and pieces of them and I have yet to see some humanly readable information about how to tie them together into a useful management pack. I say ‚Äúhumanly readable‚Äù because the information you do find online so far may be clear and somewhat easy to understand for someone with a system development background and a pretty good idea of how object oriented development models tend to work. But the real life System Center Operations Manager engineer‚Äìyou know the one who get those ‚Äúdo you think we could monitor our ‚Ä¶-system too?‚Äù questions a couple of times a week, you know‚Ä¶ you (most likely, being here)‚Äìtend to have a completely different background. Yet as their OpsMgr environment grows, so does the demand for custom monitoring and all of a sudden the former server engineer are now also a developer. A developer who has never before had the need to grasp such abstract concepts as classes, instances, inheritance and who probably never before have had any reason whatsoever to write any XML code. PurposeMy idea for this series of posts is to shed some light into the world of the authoring console and modules and cookdown and so forth. I am by no means an accredited author, but I will do my best to stay human in this venture and in plain english try to explain why and how you do certain things when going from Management Pack templates, rules, monitors and the safe haven that is authoring in the Operations Console into making your scripts resuable, easy to extend and prime for cookdown using the Authoring Console and XML. The TG WinAutoSvc Management PackTo give the series some kind of context and at the same time not only be a matter of examples I will base them on a fully functional management pack that discovers and monitors all Windows services that are set to automatic startup. I know there is other similar management packs out there but I haven‚Äôt fancied any one of them yet, and since I had the idea of writing this series I decided that building a new one would be a good way to go. Some of the interesting features with this management pack is: You will get an instance of the service classes for each and every service. It uses different classes for Own Process services and Shared Process services (svchost for example). Every service have a health state (you can use them in distributed applications). The service state monitors are inherited from their base classes, no coding neccesary. There is only one discovery script for all kinds of windows services. Extending the discovery to include different kinds of windows services, like kernel processes, is a matter of filtering. It is Open Source and licensed under the Eclipse Public License v1. Most of these features will be described thoroughly in later posts in the series and as development of it progresses I will document what I do, how I do it and why I do it in certain ways. Hopefully you will learn something new through this and get closer to becoming that MP Dev the organization asks for.In the mean time, feel free to download, look at the source code (which it by no means perfect) and try it out. The TG WinAutoSvc monitoring management pack is available for download here:http://code.google.com/p/tg-winautosvc/downloads/detail?name=TG.WinAutoSvc.xml The latest revision of the source code is located here:http://code.google.com/p/tg-winautosvc/source/browse/trunk/TG.WinAutoSvc.xml A small word of advice though. If you implement this in your environment, remember that you probably have alot more automatic services than you would expect. Because of this, discovery is disabled by default. Best of luck, and enjoy!","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2012","slug":"ms/opsmgr2012","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2012/"}],"tags":[{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"},{"name":"Management Pack","slug":"Management-Pack","permalink":"https://www.teknoglot.se/tag/Management-Pack/"},{"name":"MP Development","slug":"MP-Development","permalink":"https://www.teknoglot.se/tag/MP-Development/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2012","slug":"ms/opsmgr2012","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2012/"}]},{"title":"Server problems fixed! (hopefully)","slug":"server-problems-fixed-hopefully","date":"2011-04-27T19:50:12.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"tb/server-problems-fixed-hopefully/","link":"","permalink":"https://www.teknoglot.se/tb/server-problems-fixed-hopefully/","excerpt":"I think I got the server running ok now. I‚Äôve been fiddling about quite alot and unfortunately don‚Äôt know which one action that fixed the problem. If I do figure it out, I will post it here. Site performance should be a bit better now.","text":"I think I got the server running ok now. I‚Äôve been fiddling about quite alot and unfortunately don‚Äôt know which one action that fixed the problem. If I do figure it out, I will post it here. Site performance should be a bit better now.","categories":[{"name":"Technobabble","slug":"tb","permalink":"https://www.teknoglot.se/topics/tb/"}],"tags":[],"keywords":[{"name":"Technobabble","slug":"tb","permalink":"https://www.teknoglot.se/topics/tb/"}]},{"title":"Sluggish performance on teknoglot","slug":"sluggish-performance-on-teknoglot","date":"2011-04-19T20:14:02.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"tb/sluggish-performance-on-teknoglot/","link":"","permalink":"https://www.teknoglot.se/tb/sluggish-performance-on-teknoglot/","excerpt":"I, as well as others, have noticed some slow performance from my blog lately and I just wanted to let you know that the root cause have been identified as a bug in on of the crypto libs on the server. I haven‚Äôt found a working solution yet but are trying to keep an eye on the site regularly to be able to bounce the problematic services when they start to act up. Hopefully there will be a fix available soon. Sorry for any inconvenience in the meantime.","text":"I, as well as others, have noticed some slow performance from my blog lately and I just wanted to let you know that the root cause have been identified as a bug in on of the crypto libs on the server. I haven‚Äôt found a working solution yet but are trying to keep an eye on the site regularly to be able to bounce the problematic services when they start to act up. Hopefully there will be a fix available soon. Sorry for any inconvenience in the meantime.","categories":[{"name":"Technobabble","slug":"tb","permalink":"https://www.teknoglot.se/topics/tb/"}],"tags":[{"name":"Teknoglot","slug":"Teknoglot","permalink":"https://www.teknoglot.se/tag/Teknoglot/"}],"keywords":[{"name":"Technobabble","slug":"tb","permalink":"https://www.teknoglot.se/topics/tb/"}]},{"title":"Move complete, welcome to teknoglot.se!","slug":"move-complete-welcome-to-teknoglot-se","date":"2011-02-04T13:07:41.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"tb/move-complete-welcome-to-teknoglot-se/","link":"","permalink":"https://www.teknoglot.se/tb/move-complete-welcome-to-teknoglot-se/","excerpt":"Oh my God, I actually moved my blog for real. I think I‚Äôve been putting this upp for nearly half a year now and even though I actually went and bought a ‚Äúreal‚Äù domain-name for it. But now it‚Äôd done. The server is now self-hosted and self-maintained. Now, that obviously gives me a bit more to do, but on the other hand. I can fix any problems myself and not have to create tickets and hope someone responding to them knows what they‚Äôre talking about. The design is mostly borrowed, for now, but it works and I hope I did all the HTACCESS rules on the old server correct so that they forward all the old links to the same post on the new one. So, welcome!","text":"Oh my God, I actually moved my blog for real. I think I‚Äôve been putting this upp for nearly half a year now and even though I actually went and bought a ‚Äúreal‚Äù domain-name for it. But now it‚Äôd done. The server is now self-hosted and self-maintained. Now, that obviously gives me a bit more to do, but on the other hand. I can fix any problems myself and not have to create tickets and hope someone responding to them knows what they‚Äôre talking about. The design is mostly borrowed, for now, but it works and I hope I did all the HTACCESS rules on the old server correct so that they forward all the old links to the same post on the new one. So, welcome!","categories":[{"name":"Technobabble","slug":"tb","permalink":"https://www.teknoglot.se/topics/tb/"}],"tags":[],"keywords":[{"name":"Technobabble","slug":"tb","permalink":"https://www.teknoglot.se/topics/tb/"}]},{"title":"I'm moving (finally)","slug":"im-moving-finally","date":"2011-02-01T11:10:52.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"tb/im-moving-finally/","link":"","permalink":"https://www.teknoglot.se/tb/im-moving-finally/","excerpt":"If you‚Äôre seeing this, the move went OK. :P Anyway, I have tried to make sure that all the links, images and urls are still intact and that people are automatically redirected to the correct address on the new site too. I think I got it right, but who knows? Still fiddling with the themes thought. Sorry for the inconvenience! ps. Post from the old site is a jump ahead. Hi all, I‚Äôm finally getting my male donkey out of the wagon and has started moving this blog to a new self-hosted server. The current host is cheap and delivers quite the good service, but since I already have servers running 24/7 at home, with attached electric bills, and more than enough bandwidth for a couple of websites I find it silly paying for yet-another hosting solution. Also, it is a good time to do some spring-cleaning and actually start using that teknoglot.se domain i bought some time ago. :P","text":"If you‚Äôre seeing this, the move went OK. :P Anyway, I have tried to make sure that all the links, images and urls are still intact and that people are automatically redirected to the correct address on the new site too. I think I got it right, but who knows? Still fiddling with the themes thought. Sorry for the inconvenience! ps. Post from the old site is a jump ahead. Hi all, I‚Äôm finally getting my male donkey out of the wagon and has started moving this blog to a new self-hosted server. The current host is cheap and delivers quite the good service, but since I already have servers running 24/7 at home, with attached electric bills, and more than enough bandwidth for a couple of websites I find it silly paying for yet-another hosting solution. Also, it is a good time to do some spring-cleaning and actually start using that teknoglot.se domain i bought some time ago. :P Hopefully, the transition will go mostly unnoticed apart from the automatic redirect (301 - Permanently moved) to the new domain.","categories":[{"name":"Technobabble","slug":"tb","permalink":"https://www.teknoglot.se/topics/tb/"}],"tags":[],"keywords":[{"name":"Technobabble","slug":"tb","permalink":"https://www.teknoglot.se/topics/tb/"}]},{"title":"SNMP GET Errors in OpsMgr EventLog","slug":"snmp-get-errors-in-eventlog","date":"2010-09-02T20:28:07.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2007/snmp-get-errors-in-eventlog/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2007/snmp-get-errors-in-eventlog/","excerpt":"I‚Äôve been building a little SNMP Management Pack in the past few days to discover and monitor a bunch of PowerWare UPS‚Äôs, which turned out to take quite a lot more energy and time than expected. Mostly due to the facts that I am really bad with SNMP and how it works, I‚Äôve never really looked into the inner working of building an SNMP management pack and also because we ran into a couple of errors preventing the discovery process to work alright. To make it clear right away, this is not going to be a ‚ÄúBuilding an SNMP Management Pack Tutorial‚Äù since there‚Äôs plentiful good ones out there already, and to be extra helpful I‚Äôm gonna include a few links right away: SNMP Setup and Simple Custom SNMP Discovery - Pretty much the basics SNMP Management Pack Example: NetApp Management Pack - Part 4 actually, but has the links to the other parts Creating SNMP Probe Based Monitors - No custom discovery, but a good and simple guide to SNMP Probes It‚Äôs the second, the NetApp one, I‚Äôve used as a guide to building the UPS management pack since it goes through the process of building your own filtered discovery using SystemOID to identify your hardware-classes and then building the monitors on top of those. Let‚Äôs get to itWhen building the discovery of my hardware classes I ran into problems. The discovery simply did not work. At first I got some strange errors about ‚Äúinvalid queries‚Äù, something that turned out to be related to me reading two guides‚Äìseriously though, pick one guide that is closest to what you want to achieve and stick to it‚Äìand mixing up the XPathQuery variables. Silly me.I got those errors to go away and I was able to get a few objects to my base-class, but none of the hardware classes who was populated through the return value of an SNMP OID got discovered.The only error I got this time was the following: Log Name: Operations ManagerSource: Health Service ModulesDate: 2010-09-02 11:19:12Event ID: 11001Task Category: NoneLevel: ErrorKeywords: ClassicUser: N/AComputer: CENSOREDDescription:Error sending an SNMP GET message to IP Address XX.XX.XX.XX, Community String:=CENSORED, Status 0x6c.One or more workflows were affected by this.Workflow name: CENSORED.MP.CLASS.DISCOVERYInstance name: CENSORED_DEVICENAMEInstance ID: &#123;5C7EFB30-D885-8843-0DD7-EA86B4FD2311&#125;Management group: CENSORED I went through all the other logical steps of troubleshooting an error like that which include double-checking firewall settings, OIDs, IP-addresses, allowed hosts and so forth. It wasn‚Äôt until I loaded the PowerMIB into a MIB Browser installed on the proxy machine (in this case a Management Server) I realized that there was no problem sending an SNMP GET to the UPS from that server. I launched Wireshark and had it listen to SNMP traffic between the UPS and the Management Server. The thing that struck me right-away was the fact that I could see the a bunch of ‚ÄúSNMP Get-Request‚Äù but no ‚ÄúSNMP Get-Response‚Äù which means that Operations Manager did send an SNMP GET but there was no response. After a bit of intense staring i noticed what you see in the screenshot.","text":"I‚Äôve been building a little SNMP Management Pack in the past few days to discover and monitor a bunch of PowerWare UPS‚Äôs, which turned out to take quite a lot more energy and time than expected. Mostly due to the facts that I am really bad with SNMP and how it works, I‚Äôve never really looked into the inner working of building an SNMP management pack and also because we ran into a couple of errors preventing the discovery process to work alright. To make it clear right away, this is not going to be a ‚ÄúBuilding an SNMP Management Pack Tutorial‚Äù since there‚Äôs plentiful good ones out there already, and to be extra helpful I‚Äôm gonna include a few links right away: SNMP Setup and Simple Custom SNMP Discovery - Pretty much the basics SNMP Management Pack Example: NetApp Management Pack - Part 4 actually, but has the links to the other parts Creating SNMP Probe Based Monitors - No custom discovery, but a good and simple guide to SNMP Probes It‚Äôs the second, the NetApp one, I‚Äôve used as a guide to building the UPS management pack since it goes through the process of building your own filtered discovery using SystemOID to identify your hardware-classes and then building the monitors on top of those. Let‚Äôs get to itWhen building the discovery of my hardware classes I ran into problems. The discovery simply did not work. At first I got some strange errors about ‚Äúinvalid queries‚Äù, something that turned out to be related to me reading two guides‚Äìseriously though, pick one guide that is closest to what you want to achieve and stick to it‚Äìand mixing up the XPathQuery variables. Silly me.I got those errors to go away and I was able to get a few objects to my base-class, but none of the hardware classes who was populated through the return value of an SNMP OID got discovered.The only error I got this time was the following: Log Name: Operations ManagerSource: Health Service ModulesDate: 2010-09-02 11:19:12Event ID: 11001Task Category: NoneLevel: ErrorKeywords: ClassicUser: N/AComputer: CENSOREDDescription:Error sending an SNMP GET message to IP Address XX.XX.XX.XX, Community String:=CENSORED, Status 0x6c.One or more workflows were affected by this.Workflow name: CENSORED.MP.CLASS.DISCOVERYInstance name: CENSORED_DEVICENAMEInstance ID: &#123;5C7EFB30-D885-8843-0DD7-EA86B4FD2311&#125;Management group: CENSORED I went through all the other logical steps of troubleshooting an error like that which include double-checking firewall settings, OIDs, IP-addresses, allowed hosts and so forth. It wasn‚Äôt until I loaded the PowerMIB into a MIB Browser installed on the proxy machine (in this case a Management Server) I realized that there was no problem sending an SNMP GET to the UPS from that server. I launched Wireshark and had it listen to SNMP traffic between the UPS and the Management Server. The thing that struck me right-away was the fact that I could see the a bunch of ‚ÄúSNMP Get-Request‚Äù but no ‚ÄúSNMP Get-Response‚Äù which means that Operations Manager did send an SNMP GET but there was no response. After a bit of intense staring i noticed what you see in the screenshot. For some reason Operations Manager does not care about what SNMP version you configure when you do the initial discovery of a network device. Even if you do specify SNMP v1, you probes may very well be using SNMP v2c instead and in many cases that will result in these SNMP GET errors in the Operations Manager event log. To avoid this, you haves to specify which SNMP version to use in your System.SnmpProbe according to the information provided here: http://msdn.microsoft.com/en-us/library/ee809331.aspx Since I am such a nice guy, here‚Äôs an example of the working probe with the added line highlighted. &lt;IsWriteAction&gt;false&lt;/IsWriteAction&gt;&lt;IP&gt;$Config/IP$&lt;/IP&gt;&lt;CommunityString&gt;$Config/CommunityString$&lt;/CommunityString&gt;&lt;Version&gt;1&lt;/Version&gt;&lt;SnmpVarBinds&gt; &lt;SnmpVarBind&gt; &lt;OID&gt;1.3.6.1.4.1.534.1.1.1.0&lt;/OID&gt; &lt;Syntax&gt;0&lt;/Syntax&gt; &lt;Value VariantType=\"8\"&gt;&lt;/Value&gt; &lt;/SnmpVarBind&gt; &lt;SnmpVarBind&gt; &lt;OID&gt;1.3.6.1.4.1.534.1.1.2.0&lt;/OID&gt; &lt;Syntax&gt;0&lt;/Syntax&gt; &lt;Value VariantType=\"8\"&gt;&lt;/Value&gt; &lt;/SnmpVarBind&gt; &lt;SnmpVarBind&gt; &lt;OID&gt;1.3.6.1.4.1.534.1.1.3.0&lt;/OID&gt; &lt;Syntax&gt;0&lt;/Syntax&gt; &lt;Value VariantType=\"8\"&gt;&lt;/Value&gt; &lt;/SnmpVarBind&gt;&lt;/SnmpVarBinds&gt; That‚Äôs it. Working perfectly now. Best of luck!","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}],"tags":[{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"},{"name":"Errors","slug":"Errors","permalink":"https://www.teknoglot.se/tag/Errors/"},{"name":"Management Pack","slug":"Management-Pack","permalink":"https://www.teknoglot.se/tag/Management-Pack/"},{"name":"TroubleShooting","slug":"TroubleShooting","permalink":"https://www.teknoglot.se/tag/TroubleShooting/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}]},{"title":"Installing Linux Integration Services v2.1 on Red Hat ES 5","slug":"install-linuxis21-rhes5","date":"2010-08-31T10:06:04.000Z","updated":"2018-08-28T13:02:24.355Z","comments":true,"path":"Linux/rhes/install-linuxis21-rhes5/","link":"","permalink":"https://www.teknoglot.se/Linux/rhes/install-linuxis21-rhes5/","excerpt":"Ok, so I got the task to install the Linux Integration Service for Hyper-V R2 on a RedHat Enterprise Server 5. Something that turned out to be a bit more to handle than I would have thought. So here‚Äôs a little How-To. PreparationsRead the documentation provided in the Linux Integration Services download. Much of the information in this article is in there, but some parts are not. Otherwise I would not have bothered writing about it. ;) I‚Äôm not going to go through the OS installation process here, but make sure to select the ‚ÄúSoftware Development‚Äù packages since you will be needing it. In case you missed it, you can install them later by running these commands. # yum groupinstall \"Development Tools\"# yum install kernel-headers I‚Äôm not actually sure that you need to run the kernel-headers install manually or if it‚Äôs included in the ‚ÄúDevelopment Tools‚Äù package. The first gotcha i ran into was the fact that the link to the Linux Integration Services‚Äìpreviously known as Linux Integration Components or LinuxIC‚Äìon RedHat‚Äôs information pages gave me a 404 and a redirect to a bing-search that returned the exact same 404. The page have simply been removed by Microsoft without any form of redirection to the new page. Anyway, a search on http://download.microsoft.com for ‚ÄúLinux Integration Components‚Äù do return the new page, and that‚Äôs where I learned about the new name.Thank you for making it easy for us Microsoft! Here‚Äôs a direct link to the search on the current name. And here‚Äôs a direct link to the actual download page. This download contains an ISO file that you can mount using the Hyper-V- or VMM-console, or you can do as I did and download the ISO to the virtual machine, mount it locally, copy the files and unmount it. Like this. # mkdir /mnt/ISO# mount -o loop /root/LinuxIC v21.iso /mnt/ISO# mkdir /opt/linux_ic_v21_rtm# cp /mnt/ISO/* -R /opt/linux_ic_v21_rtm/# umount /mnt/ISO","text":"Ok, so I got the task to install the Linux Integration Service for Hyper-V R2 on a RedHat Enterprise Server 5. Something that turned out to be a bit more to handle than I would have thought. So here‚Äôs a little How-To. PreparationsRead the documentation provided in the Linux Integration Services download. Much of the information in this article is in there, but some parts are not. Otherwise I would not have bothered writing about it. ;) I‚Äôm not going to go through the OS installation process here, but make sure to select the ‚ÄúSoftware Development‚Äù packages since you will be needing it. In case you missed it, you can install them later by running these commands. # yum groupinstall \"Development Tools\"# yum install kernel-headers I‚Äôm not actually sure that you need to run the kernel-headers install manually or if it‚Äôs included in the ‚ÄúDevelopment Tools‚Äù package. The first gotcha i ran into was the fact that the link to the Linux Integration Services‚Äìpreviously known as Linux Integration Components or LinuxIC‚Äìon RedHat‚Äôs information pages gave me a 404 and a redirect to a bing-search that returned the exact same 404. The page have simply been removed by Microsoft without any form of redirection to the new page. Anyway, a search on http://download.microsoft.com for ‚ÄúLinux Integration Components‚Äù do return the new page, and that‚Äôs where I learned about the new name.Thank you for making it easy for us Microsoft! Here‚Äôs a direct link to the search on the current name. And here‚Äôs a direct link to the actual download page. This download contains an ISO file that you can mount using the Hyper-V- or VMM-console, or you can do as I did and download the ISO to the virtual machine, mount it locally, copy the files and unmount it. Like this. # mkdir /mnt/ISO# mount -o loop /root/LinuxIC v21.iso /mnt/ISO# mkdir /opt/linux_ic_v21_rtm# cp /mnt/ISO/* -R /opt/linux_ic_v21_rtm/# umount /mnt/ISO You probably have to be root to do this by the way.With that done, let‚Äôs get to the installation. InstallationAs root, do the following: # export PATH=$PATH:/sbin# cd /opt/linux_ic_v21_rtm/# make make install# reboot Why the export PATH command? Apparently, on RHES5, /sbin is not in the PATH by default and this is something that the make scripts are completely unaware of. The make install will try to run depmod which will fail since it‚Äôs not in the default path.You could also add PATH=$PATH/sbin to the root users ~/.bashrc which will put it back in the PATH but only for the root user, but I don‚Äôt know if that‚Äôs recommended.And, yes. You DO have to reboot after the install. If you are running RHES5 64bit you also have to install the adjtimex package. It is in the RHN repository but also on the RHES5 Installation CD in case you have no internet connection. Install it with yum like this: # yum install adjtimex And from the CD (mount it first) like this: # rpm ‚Äìivh /mnt/cdrom/Server/adjtimex-1.20-2.1.x86_64.rpm And that‚Äôs basically it for the installation. VerificationHow do you know that the driver are installed? Aftr the reboot, try running modinfo vmbus which should return something like this: # modinfo vmbusfilename: /lib/modules/2.6.18-194.11.1.el5/kernel/drivers/vmbus/vmbus.koverion: 2.1.25licnse: GPLsrcversion: 3C1899C419665CB2514F2D0depends:vermagic: 2.6.18-194.11.1.el5 SMP mod_unload gcc-4.1parm: vmbus_irq:intpar: vmbus_loglevel:int Try that with netvsc, storvsc and blkvsc too (replace the vmbus part) and you should get something similar. If you don‚Äôt, the installation did not succeed.The documentation also tells us to check that the components are running with /sbin/lsmod | grep vsc which should return: # /bin/lsmod | grep vscblkvsc 70184 3storvsc 64264 0netvsc 73504 0vmbus 88304 3 blkvsc,storvsc,netvscscs_mod 196953 6 scsi_dh,sg,blkvsc,storvsc,libata,sd_mod The numbers will probably differ from installation to installation depending on blocksizes and allocation. ConfigurationConfiguration is pretty straight-forward so I‚Äôll keep this short. When you install the drivers you will get a new network card called seth0, which I presume stands for Synthetic ETHernet. There‚Äôs nothing magic about it regarding configuration and system-configuration-network will work just fine.The drivers will also give you a couple of SCSI-devices (if you have one attached) with the regular /dev/sd* naming. Simply configure these using fdisk or whatever GUI you might prefer. There is also a note in the documentation about changing the grub configuration in the ‚ÄúAdditional Information‚Ä¶‚Äù section. Do read that section. Additional CommentsOne thing I tend to do now that disk space is dirt cheap is to copy all ISO-files I use locally instead of mounting them when needed through Hyper-V. Simply because you can bet your insert-shorter-word-for-buttocks that the day you need it again, someone has been kind enough to have done som spring-cleaning or it‚Äôs locked by another machine in the cluster. If you have it locally and followed my instructions in the ‚ÄúPreparation‚Äù section, you will allready have a /mnt/ISO directory. Only thing you‚Äôll have to do is # mount -o loop /path/to/your.iso /mnt/ISO And there you have it. Just remember to unmount it when you‚Äôre done. I also almost never use the Hyper-V remote connection interface thingy since it will give you a GUI and the mouse just won‚Äôt work. If you haven‚Äôt configured a network card yet though, you could connect through Hyper-V and hit Ctrl+Alt+F1 to get a command prompt. Unfortunatly cut/paste don‚Äôt work here, but you could run system-configuration-network, assign an IP-address and then connect with an SSH client. I prefer PuTTY to a degree that I usually install the ported version on my Linux desktops as well. And I never logon using root. People should know this, but it should be stressed anyway. Always logon as regular user and su or sudo when needed. I can‚Äôt understand why RHES has root-login enabled by default in the SSH-server config. Good luck!","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.teknoglot.se/topics/Linux/"},{"name":"RedHat ES","slug":"Linux/rhes","permalink":"https://www.teknoglot.se/topics/Linux/rhes/"}],"tags":[{"name":"How-To","slug":"How-To","permalink":"https://www.teknoglot.se/tag/How-To/"},{"name":"Hyper-V","slug":"Hyper-V","permalink":"https://www.teknoglot.se/tag/Hyper-V/"},{"name":"Linux","slug":"Linux","permalink":"https://www.teknoglot.se/tag/Linux/"},{"name":"RedHat","slug":"RedHat","permalink":"https://www.teknoglot.se/tag/RedHat/"},{"name":"RHES5","slug":"RHES5","permalink":"https://www.teknoglot.se/tag/RHES5/"}],"keywords":[{"name":"Linux","slug":"Linux","permalink":"https://www.teknoglot.se/topics/Linux/"},{"name":"RedHat ES","slug":"Linux/rhes","permalink":"https://www.teknoglot.se/topics/Linux/rhes/"}]},{"title":"MSMQ 4 and MSMQ 5 MP for OpsMgr Released! (finally)","slug":"msmq-4-and-msmq-5-mp-for-opsmgr-released-finally","date":"2010-04-06T10:09:57.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2007/msmq-4-and-msmq-5-mp-for-opsmgr-released-finally/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2007/msmq-4-and-msmq-5-mp-for-opsmgr-released-finally/","excerpt":"After a long wait (definitely more than 90 days) the management packs for MSMQ 4 (Windows 2008) and MSMQ 5 (Windows 2008 R2) are finally released. Both seem to be fully Cluster aware and pretty much holds the same monitoring as the the latest MSMQ 3 MP. Message Queuing 4.0 Management Pack for Operations Manager 2007&gt; **Quick Details** Version: 6.0.6700.83 Date Published: 4/5/2010 Language: English Download here: http://www.microsoft.com/downloads/details.aspx?FamilyID=cfc103b8-7185-4721-8098-110885fe9e9e&amp;displaylang=en Message Queuing 5.0 Management Pack for Operations Manager 2007 Quick Details Version: 6.0.6700.88 Date Published: 4/5/2010 Language: English Download here: http://www.microsoft.com/downloads/details.aspx?FamilyID=28349b78-8329-44aa-8a1f-81f4e3f84d0c&amp;displaylang=en","text":"After a long wait (definitely more than 90 days) the management packs for MSMQ 4 (Windows 2008) and MSMQ 5 (Windows 2008 R2) are finally released. Both seem to be fully Cluster aware and pretty much holds the same monitoring as the the latest MSMQ 3 MP. Message Queuing 4.0 Management Pack for Operations Manager 2007&gt; **Quick Details** Version: 6.0.6700.83 Date Published: 4/5/2010 Language: English Download here: http://www.microsoft.com/downloads/details.aspx?FamilyID=cfc103b8-7185-4721-8098-110885fe9e9e&amp;displaylang=en Message Queuing 5.0 Management Pack for Operations Manager 2007 Quick Details Version: 6.0.6700.88 Date Published: 4/5/2010 Language: English Download here: http://www.microsoft.com/downloads/details.aspx?FamilyID=28349b78-8329-44aa-8a1f-81f4e3f84d0c&amp;displaylang=en","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}],"tags":[{"name":"Management Pack","slug":"Management-Pack","permalink":"https://www.teknoglot.se/tag/Management-Pack/"},{"name":"MSMQ","slug":"MSMQ","permalink":"https://www.teknoglot.se/tag/MSMQ/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}]},{"title":"Change Gateway Powershell Script","slug":"change-gateway-powershell-script","date":"2010-03-31T13:27:08.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2007/change-gateway-powershell-script/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2007/change-gateway-powershell-script/","excerpt":"This script has pretty much already been covered in my previous post about Changing or Replacing an Operations Manager Gateway Server. This time I‚Äôve basically put parameter support in it to make it easier to use. Here‚Äôs the script anyway. Param($OldGW,$NewGW)$OldMS= Get-ManagementServer | where &#123;$_.Name -eq $OldGW&#125;$NewMS = Get-ManagementServer | where &#123;$_.Name -eq $NewGW&#125;$agents = Get-Agent | where &#123;$_.PrimaryManagementServerName -eq $OldGW&#125;$agents = $agents\"Moving \" + $agents.count + \" agents from \" + $OldMS.Name + \" to \" + $NewMS.NameStart-Sleep -m 200Set-ManagementServer -AgentManagedComputer: $agents -PrimaryManagementServer: $NewMS -FailoverServer: $OldMS To use it, create a textfile called ChangeGW.ps1 and paste the code into it. Save the file somewhere neat (maybe C:Scripts) for easy access. If you don‚Äôt feel like copy/pasting, you can download the script here. To use it, open the Operations Manager Command Shell and type:C:\\ScriptsChangeGW.ps1 &lt;old.gatewayserver.dns.name&gt; &lt;new.gatewayserver.dns.name&gt; For example: C:\\ScriptsChangeGW.ps1 gwserver01.domainname.local gwserver02.domainname.local","text":"This script has pretty much already been covered in my previous post about Changing or Replacing an Operations Manager Gateway Server. This time I‚Äôve basically put parameter support in it to make it easier to use. Here‚Äôs the script anyway. Param($OldGW,$NewGW)$OldMS= Get-ManagementServer | where &#123;$_.Name -eq $OldGW&#125;$NewMS = Get-ManagementServer | where &#123;$_.Name -eq $NewGW&#125;$agents = Get-Agent | where &#123;$_.PrimaryManagementServerName -eq $OldGW&#125;$agents = $agents\"Moving \" + $agents.count + \" agents from \" + $OldMS.Name + \" to \" + $NewMS.NameStart-Sleep -m 200Set-ManagementServer -AgentManagedComputer: $agents -PrimaryManagementServer: $NewMS -FailoverServer: $OldMS To use it, create a textfile called ChangeGW.ps1 and paste the code into it. Save the file somewhere neat (maybe C:Scripts) for easy access. If you don‚Äôt feel like copy/pasting, you can download the script here. To use it, open the Operations Manager Command Shell and type:C:\\ScriptsChangeGW.ps1 &lt;old.gatewayserver.dns.name&gt; &lt;new.gatewayserver.dns.name&gt; For example: C:\\ScriptsChangeGW.ps1 gwserver01.domainname.local gwserver02.domainname.local","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}],"tags":[{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"},{"name":"PoSH","slug":"PoSH","permalink":"https://www.teknoglot.se/tag/PoSH/"},{"name":"Script","slug":"Script","permalink":"https://www.teknoglot.se/tag/Script/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}]},{"title":"ESENT Error When Modifying OpsMgr Agent","slug":"esent-error-when-modifying-opsmgr-agent","date":"2010-03-19T09:34:17.000Z","updated":"2018-08-28T12:35:24.351Z","comments":true,"path":"ms/opsmgr2007/esent-error-when-modifying-opsmgr-agent/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2007/esent-error-when-modifying-opsmgr-agent/","excerpt":"Getting ESENT Kerys are required to install this application when you are trying to modify/change an agent installation? This seems to be most common on Windows 2008 and i guess it‚Äôs because of the UAC and the fact that opening the Control Panel isn‚Äôt running in administrative mode. To work around this you need to run the msiexec command on the correct installation GUID from an administrative command prompt. Besides running through the registry to find the GUID, one of the easier ways is this: Open an administrative command prompt. run wmic product Locate your product by its name, the GUID (looks a bit like this {25097770-2B1F-49F6-AB9D-1C708B96262A}) directly after that is the one you want. Copy it. run msiexec /i &lt;PASTEYOURGUIDHERE&gt; Modify the agent as pleased That‚Äôs pretty much it. Good luck.","text":"Getting ESENT Kerys are required to install this application when you are trying to modify/change an agent installation? This seems to be most common on Windows 2008 and i guess it‚Äôs because of the UAC and the fact that opening the Control Panel isn‚Äôt running in administrative mode. To work around this you need to run the msiexec command on the correct installation GUID from an administrative command prompt. Besides running through the registry to find the GUID, one of the easier ways is this: Open an administrative command prompt. run wmic product Locate your product by its name, the GUID (looks a bit like this {25097770-2B1F-49F6-AB9D-1C708B96262A}) directly after that is the one you want. Copy it. run msiexec /i &lt;PASTEYOURGUIDHERE&gt; Modify the agent as pleased That‚Äôs pretty much it. Good luck.","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}],"tags":[{"name":"Windows","slug":"Windows","permalink":"https://www.teknoglot.se/tag/Windows/"},{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"},{"name":"Errors","slug":"Errors","permalink":"https://www.teknoglot.se/tag/Errors/"},{"name":"How-To","slug":"How-To","permalink":"https://www.teknoglot.se/tag/How-To/"},{"name":"Windows Installer","slug":"Windows-Installer","permalink":"https://www.teknoglot.se/tag/Windows-Installer/"},{"name":"WMI","slug":"WMI","permalink":"https://www.teknoglot.se/tag/WMI/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}]},{"title":"Updated MSMQ Management Pack v6.0.6615.0!","slug":"updated-msmq-management-pack","date":"2009-12-23T08:57:38.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2007/updated-msmq-management-pack/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2007/updated-msmq-management-pack/","excerpt":"Microsoft has released an update to the MSMQ (version 3) management pack. System Center Pack for: Message Queuing 3.0Version: 6.0.6615.0Released on: 12/14/2009Message Queuing (also known as MSMQ) is a server application that enables applications to communicate across heterogeneous networks and systems that may be temporarily offline or otherwise inaccessible. Instead of an application communicating with a service on another computer, it sends its information to Message Queuing, which sends the information to a Message Queuing service on the target computer where it is made available to the other application. Message Queuing provides guaranteed delivery, efficient routing, security, and priority based messaging. Now, what‚Äôs really interesting is what you will find in the MP Guide under ‚ÄúSupported Configurations‚Äù. The Message Queuing Management Pack for Operations Manager 2007 is designed to monitor Message Queuing version 3 only. The Message Queuing Management Pack supports the following platforms: Windows Server 2003 Windows XP The Message Queuing Management Pack also supports monitoring clustered MSMQ components Emphasis by me. Finally, MSMQ monitoring seems to be cluster aware, which might mean that the home-made pack i did to have those (numerous) queues covered could be passed on to the scrap-heap. This is also confirmed under ‚ÄúChanges in This Update‚Äù. The December 2009 update to this management pack includes the following change: Fixed a problem when working with an instance of MSMQ in a Cluster. The MP is now able to discover and monitor public and private queues in a cluster. Fixed a problem when discovering the local and cluster instance of MSMQ. The MP is now able to discover and monitor both instances. The confusing double RunAs profiles seems to have been cleaned up too (you only have to worry about one now) as well as fixing some sloppy mistakes in the previous scripts (no Option Explicit? C‚Äômon Microsoft! You write the best practices, try to stick to them.) and generally improving display and documentation. Gonna import this to our staging environment today and let it roll during the holidays. Download and documentation:http://www.microsoft.com/downloads/details.aspx?FamilyId=1D2B4398-8BC2-4A43-850C-852EBB0D983B&amp;displaylang=en&amp;displaylang=en","text":"Microsoft has released an update to the MSMQ (version 3) management pack. System Center Pack for: Message Queuing 3.0Version: 6.0.6615.0Released on: 12/14/2009Message Queuing (also known as MSMQ) is a server application that enables applications to communicate across heterogeneous networks and systems that may be temporarily offline or otherwise inaccessible. Instead of an application communicating with a service on another computer, it sends its information to Message Queuing, which sends the information to a Message Queuing service on the target computer where it is made available to the other application. Message Queuing provides guaranteed delivery, efficient routing, security, and priority based messaging. Now, what‚Äôs really interesting is what you will find in the MP Guide under ‚ÄúSupported Configurations‚Äù. The Message Queuing Management Pack for Operations Manager 2007 is designed to monitor Message Queuing version 3 only. The Message Queuing Management Pack supports the following platforms: Windows Server 2003 Windows XP The Message Queuing Management Pack also supports monitoring clustered MSMQ components Emphasis by me. Finally, MSMQ monitoring seems to be cluster aware, which might mean that the home-made pack i did to have those (numerous) queues covered could be passed on to the scrap-heap. This is also confirmed under ‚ÄúChanges in This Update‚Äù. The December 2009 update to this management pack includes the following change: Fixed a problem when working with an instance of MSMQ in a Cluster. The MP is now able to discover and monitor public and private queues in a cluster. Fixed a problem when discovering the local and cluster instance of MSMQ. The MP is now able to discover and monitor both instances. The confusing double RunAs profiles seems to have been cleaned up too (you only have to worry about one now) as well as fixing some sloppy mistakes in the previous scripts (no Option Explicit? C‚Äômon Microsoft! You write the best practices, try to stick to them.) and generally improving display and documentation. Gonna import this to our staging environment today and let it roll during the holidays. Download and documentation:http://www.microsoft.com/downloads/details.aspx?FamilyId=1D2B4398-8BC2-4A43-850C-852EBB0D983B&amp;displaylang=en&amp;displaylang=en Cheers! Oh, and happy holidays!","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}],"tags":[{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"},{"name":"Management Pack","slug":"Management-Pack","permalink":"https://www.teknoglot.se/tag/Management-Pack/"},{"name":"MSMQ","slug":"MSMQ","permalink":"https://www.teknoglot.se/tag/MSMQ/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}]},{"title":"Linux Discovery ‚Äì Not Enough Entropy","slug":"linux-discovery-not-enough-entropy","date":"2009-12-02T11:37:08.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"Linux/sles/linux-discovery-not-enough-entropy/","link":"","permalink":"https://www.teknoglot.se/Linux/sles/linux-discovery-not-enough-entropy/","excerpt":"Error DescriptionHere‚Äôs a little trouble-shooting guide for discovering Linux systems from OpsMgr R2 when getting the following error from the wizard: &lt;stdout&gt;Generating certificate with hostname=\"COMPUTERNAME\"[/home/serviceb/TfsCoreWrkSpcRedhat/source/code/tools/scx_ssl_config/scxsslcert.cpp:198]Failed to allocate resource of type random data: Failed to get random data - not enough entropy&lt;/stdout&gt;&lt;stderr&gt;error: %post(scx-1.0.4-248.i386) scriptlet failed, exit status 1&lt;/stderr&gt;&lt;returnCode&gt;1&lt;/returnCode&gt;&lt;DataItem type=\"Microsoft.SSH.SSHCommandData\" time=\"2009-08-05T11:15:01.5800358-04:00\" sourceHealthServiceId=\"0EB1D6DA-202C-7FC5-3D46-BDBB9208547D\"&gt;&lt;SSHCommandData&gt;&lt;stdout&gt;Generating certificate with hostname=\"COMPUTERNAME\"[/home/serviceb/TfsCoreWrkSpcRedhat/source/code/tools/scx_ssl_config/scxsslcert.cpp:198]Failed to allocate resource of type random data: Failed to get random data - not enough entropy&lt;/stdout&gt;&lt;stderr&gt;error: %post(scx-1.0.4-248.i386) scriptlet failed, exit status 1&lt;/stderr&gt;&lt;returnCode&gt;1&lt;/returnCode&gt;&lt;/SSHCommandData&gt;&lt;/DataItem&gt; But first, a little background on the actual ‚Äúproblem‚Äù. To generate the certificate, the entropy needs to be high enough to generate random data for the certificate creation. Without the certificate, the OpsMgr agent won‚Äôt be able to open up communications with the MS. So, what creates this entropy we need? Bluntly put, a selection of hardware components that are likely to produce non-predictable data. Like a keyboard, mouse and a monitor or videocard. Of course, there‚Äôs a lot more to it, but we really don‚Äôt need to know this. What we need to know is that there has to be a ‚Äúbit bucket‚Äù of more than 256bytes of entropy for the certificate creation process to succeed. We also need to know that more enterprise-ish servers, like rack- or blade-servers tend to be void of things like directly attached keyboards, mouses and monitors that the linux kernel needs to be able to generate entropy. And herein lies the problem. If you have a new server that is not in full service (likely since we are trying to deploy the monitoring on it) which means that there‚Äôs not much random data flowing through the hardware and there‚Äôs no keyboard or mouse or monitor connected to it there is quite the risk that the system entropy is going to be very low. Of the linux systems that I have been deploying OpsMgr agents to, about half have failed because of ‚ÄúNot enough entropy‚Äù. So, here‚Äôs the steps I usually takes to ensure that discovery works. I use PuTTY to connect to the soon-to-be-monitored servers. This guide also assumes that you have SU rights on the system since all of these steps (except #1) needs it. Workaround1. Check you current entropycat /proc/sys/kernel/random/entropy_avail Is it less than, or close to, 256? It probably is. If you don‚Äôt feel like connecting a mouse and start wiggling it around‚Äînot really feasible in a data center‚Äîand see if the entropy increases, you can generate your own random data. 2. Generate you own random data.Be advised that this forced entropy will not be as random as the system-created on and thus not as secure. How much more insecure it is, I don‚Äôt know, and quite frankly I prefer to have my systems monitored yet slightly less secure than not monitored at all. Anyway, you can force your own random data by running:","text":"Error DescriptionHere‚Äôs a little trouble-shooting guide for discovering Linux systems from OpsMgr R2 when getting the following error from the wizard: &lt;stdout&gt;Generating certificate with hostname=\"COMPUTERNAME\"[/home/serviceb/TfsCoreWrkSpcRedhat/source/code/tools/scx_ssl_config/scxsslcert.cpp:198]Failed to allocate resource of type random data: Failed to get random data - not enough entropy&lt;/stdout&gt;&lt;stderr&gt;error: %post(scx-1.0.4-248.i386) scriptlet failed, exit status 1&lt;/stderr&gt;&lt;returnCode&gt;1&lt;/returnCode&gt;&lt;DataItem type=\"Microsoft.SSH.SSHCommandData\" time=\"2009-08-05T11:15:01.5800358-04:00\" sourceHealthServiceId=\"0EB1D6DA-202C-7FC5-3D46-BDBB9208547D\"&gt;&lt;SSHCommandData&gt;&lt;stdout&gt;Generating certificate with hostname=\"COMPUTERNAME\"[/home/serviceb/TfsCoreWrkSpcRedhat/source/code/tools/scx_ssl_config/scxsslcert.cpp:198]Failed to allocate resource of type random data: Failed to get random data - not enough entropy&lt;/stdout&gt;&lt;stderr&gt;error: %post(scx-1.0.4-248.i386) scriptlet failed, exit status 1&lt;/stderr&gt;&lt;returnCode&gt;1&lt;/returnCode&gt;&lt;/SSHCommandData&gt;&lt;/DataItem&gt; But first, a little background on the actual ‚Äúproblem‚Äù. To generate the certificate, the entropy needs to be high enough to generate random data for the certificate creation. Without the certificate, the OpsMgr agent won‚Äôt be able to open up communications with the MS. So, what creates this entropy we need? Bluntly put, a selection of hardware components that are likely to produce non-predictable data. Like a keyboard, mouse and a monitor or videocard. Of course, there‚Äôs a lot more to it, but we really don‚Äôt need to know this. What we need to know is that there has to be a ‚Äúbit bucket‚Äù of more than 256bytes of entropy for the certificate creation process to succeed. We also need to know that more enterprise-ish servers, like rack- or blade-servers tend to be void of things like directly attached keyboards, mouses and monitors that the linux kernel needs to be able to generate entropy. And herein lies the problem. If you have a new server that is not in full service (likely since we are trying to deploy the monitoring on it) which means that there‚Äôs not much random data flowing through the hardware and there‚Äôs no keyboard or mouse or monitor connected to it there is quite the risk that the system entropy is going to be very low. Of the linux systems that I have been deploying OpsMgr agents to, about half have failed because of ‚ÄúNot enough entropy‚Äù. So, here‚Äôs the steps I usually takes to ensure that discovery works. I use PuTTY to connect to the soon-to-be-monitored servers. This guide also assumes that you have SU rights on the system since all of these steps (except #1) needs it. Workaround1. Check you current entropycat /proc/sys/kernel/random/entropy_avail Is it less than, or close to, 256? It probably is. If you don‚Äôt feel like connecting a mouse and start wiggling it around‚Äînot really feasible in a data center‚Äîand see if the entropy increases, you can generate your own random data. 2. Generate you own random data.Be advised that this forced entropy will not be as random as the system-created on and thus not as secure. How much more insecure it is, I don‚Äôt know, and quite frankly I prefer to have my systems monitored yet slightly less secure than not monitored at all. Anyway, you can force your own random data by running: dd if=/dev/urandom of=~/.rnd bs=1 count=1024 This creates a .rnd file with 1024B of random data that the certificate creation process will use instead of the system entropy if the file exists. 3. Uninstall and re-discoverThe first failed attempt of discovery will most likely leave a non-working agent installation that we have to remove. Otherwise we will just be stuck with an ‚ÄúAccess Denied‚Äù error. Run: rpm ‚Äìe scx Now, try to discover the system again. 4. Failed again?Try generating the certificate manually by running: /opt/microsoft/scx/bin/tools/scxsslconfig -f ‚Äìv/opt/microsoft/scx/bin/tools/scxadmin ‚Äìrestart Retry discovery again. 5. Still fails?Uninstall the agent once more as instructed in step 3.Stese steps have solved my problems 100% on both SUSE and RedHat and hopefully they will help you too. Interestingely enough, these problems seems to be connected to some changes in the 2.6 kernel and basically everything that uses SSL-ish certificates will be affected. Even though the symptoms may be a bit more subtle, like time-outs and disconnects. For ‚Äúheadless‚Äù servers like those I usually to administer where the random data tend to be much lower, there‚Äôs even specialised hardware whose sole purpose is to generate random data, like the Entropy Key. I have also been told that new servers is likely to be equipped with entropy chipsets to make sure that there‚Äôs chaos enough to avoid these new-found oddities. Sources:http://social.technet.microsoft.com/Forums/en-US/crossplatformsles/thread/f94ec905-23ac-4444-b9f8-644fec3ae357 http://www.askrenzo.com/oracle/SCOM/SCOM_discovering_nodes.html","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.teknoglot.se/topics/Linux/"},{"name":"SLES","slug":"Linux/sles","permalink":"https://www.teknoglot.se/topics/Linux/sles/"}],"tags":[{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"},{"name":"How-To","slug":"How-To","permalink":"https://www.teknoglot.se/tag/How-To/"},{"name":"Linux","slug":"Linux","permalink":"https://www.teknoglot.se/tag/Linux/"},{"name":"TroubleShooting","slug":"TroubleShooting","permalink":"https://www.teknoglot.se/tag/TroubleShooting/"},{"name":"X-Plat","slug":"X-Plat","permalink":"https://www.teknoglot.se/tag/X-Plat/"}],"keywords":[{"name":"Linux","slug":"Linux","permalink":"https://www.teknoglot.se/topics/Linux/"},{"name":"SLES","slug":"Linux/sles","permalink":"https://www.teknoglot.se/topics/Linux/sles/"}]},{"title":"(re)Gain sysadmin access to SQL2005 or SQL2008","slug":"regain-sysadmin-access-to-sql2005-or-sql2008","date":"2009-11-19T13:08:10.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/sql/regain-sysadmin-access-to-sql2005-or-sql2008/","link":"","permalink":"https://www.teknoglot.se/ms/sql/regain-sysadmin-access-to-sql2005-or-sql2008/","excerpt":"In SQL Server 2005 and 2008 the local Administrators account is not sysadmin by default. This makes it even more important that the one setting up the Database also remembers to add a SQL Server admins group to the sysadmin role. If this step is forgotten, the user installing the database server is the only one that will ever be sysadmin. In some extreme cases I‚Äôve seen situations where no one except some dude on vacation is sysadmin and I need to install or upgrade a bunch of applications and services. In these cases I have also been assigned Local Administrator rights on the server, but since the local Administrators group isn‚Äôt sysadmin either I still cannot login to the SQL server.What to do!? Thanks to Raul Carcia‚Äôs blog post it‚Äôs not that a big deal. The instructions are written for SQL Server 2005 but works equally fine on SQL Server 2008 and the only pre-requirement is that you are a local server administrator.Here‚Äôs what to do: Open the SQL Server Configuration Manager. In SQL Server Services, open the properties for the SQL Server instance you need access to. In the Advanced tab, find Startup Parameters. Add ‚Äú;-m‚Äù to the end of that line. Press OK and restart the SQL Server into ‚ÄúMaintenance Mode‚Äù or ‚ÄúSingle User Mode‚Äù if you like. (check that a restart is OK first ;)) Open a command prompt (right-click, ‚ÄúRun as Administrator‚Äù in Windows 2008) and go to C:\\Program Files\\Microsoft SQL Server\\100\\Tools\\Binn(C:\\Program Files\\Microsoft SQL Server_90_\\Tools\\Binn for SQL2005) Execute sqlcmd /A /E /S &lt;INSTANCE&gt;(use . for local default instance and .INSTANCE for local named instance) In the CLI, execute: EXEC sp_addsrvrolemember 'DOMAIN\\yourusername', 'sysadmin';GO Return to the SQL Server Configuration Manager and restore the Startup Parameters to it‚Äôs previous settings. Restart the SQL Server instance to allow users to get access to it again. Now, you should be able to login to the SQL server with sysadmin rights using your current user. This would also be a good time to actually set up a SQL Server Admins group (local or domain) to add to the sysadmin role to avoid having others to the above steps when you, yourself, are on vacation. ;) As Raul Carcia point out in his original post, this is really a disaster recovery procedure and there‚Äôs definitely nothing sneaky about it since it leaves a lot of trails in the event logs. All in all, a Great article by Raul and all credit should go his way.","text":"In SQL Server 2005 and 2008 the local Administrators account is not sysadmin by default. This makes it even more important that the one setting up the Database also remembers to add a SQL Server admins group to the sysadmin role. If this step is forgotten, the user installing the database server is the only one that will ever be sysadmin. In some extreme cases I‚Äôve seen situations where no one except some dude on vacation is sysadmin and I need to install or upgrade a bunch of applications and services. In these cases I have also been assigned Local Administrator rights on the server, but since the local Administrators group isn‚Äôt sysadmin either I still cannot login to the SQL server.What to do!? Thanks to Raul Carcia‚Äôs blog post it‚Äôs not that a big deal. The instructions are written for SQL Server 2005 but works equally fine on SQL Server 2008 and the only pre-requirement is that you are a local server administrator.Here‚Äôs what to do: Open the SQL Server Configuration Manager. In SQL Server Services, open the properties for the SQL Server instance you need access to. In the Advanced tab, find Startup Parameters. Add ‚Äú;-m‚Äù to the end of that line. Press OK and restart the SQL Server into ‚ÄúMaintenance Mode‚Äù or ‚ÄúSingle User Mode‚Äù if you like. (check that a restart is OK first ;)) Open a command prompt (right-click, ‚ÄúRun as Administrator‚Äù in Windows 2008) and go to C:\\Program Files\\Microsoft SQL Server\\100\\Tools\\Binn(C:\\Program Files\\Microsoft SQL Server_90_\\Tools\\Binn for SQL2005) Execute sqlcmd /A /E /S &lt;INSTANCE&gt;(use . for local default instance and .INSTANCE for local named instance) In the CLI, execute: EXEC sp_addsrvrolemember 'DOMAIN\\yourusername', 'sysadmin';GO Return to the SQL Server Configuration Manager and restore the Startup Parameters to it‚Äôs previous settings. Restart the SQL Server instance to allow users to get access to it again. Now, you should be able to login to the SQL server with sysadmin rights using your current user. This would also be a good time to actually set up a SQL Server Admins group (local or domain) to add to the sysadmin role to avoid having others to the above steps when you, yourself, are on vacation. ;) As Raul Carcia point out in his original post, this is really a disaster recovery procedure and there‚Äôs definitely nothing sneaky about it since it leaves a lot of trails in the event logs. All in all, a Great article by Raul and all credit should go his way.","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"SQL Server","slug":"ms/sql","permalink":"https://www.teknoglot.se/topics/ms/sql/"}],"tags":[{"name":"How-To","slug":"How-To","permalink":"https://www.teknoglot.se/tag/How-To/"},{"name":"SQL Server","slug":"SQL-Server","permalink":"https://www.teknoglot.se/tag/SQL-Server/"},{"name":"SQL Server 2005","slug":"SQL-Server-2005","permalink":"https://www.teknoglot.se/tag/SQL-Server-2005/"},{"name":"SQL Server 2008","slug":"SQL-Server-2008","permalink":"https://www.teknoglot.se/tag/SQL-Server-2008/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"SQL Server","slug":"ms/sql","permalink":"https://www.teknoglot.se/topics/ms/sql/"}]},{"title":"Updated: MP for System Center Configurations Manager 2007 SP2 on x64","slug":"updated-mp-for-system-center-configurations-manager-2007-sp2-on-x64","date":"2009-11-03T11:13:00.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2007/updated-mp-for-system-center-configurations-manager-2007-sp2-on-x64/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2007/updated-mp-for-system-center-configurations-manager-2007-sp2-on-x64/","excerpt":"Microsoft has released an updated MP for SCCM SP2 (v6.0.6000.2, released on 10/28/2009) for OpsMgr R2. The update basically contains support for x64 that was missing in the previous release. The Configuration Manager 2007 SP2 Management Pack adds support for monitoring Configuration Manager 2007 SP2 in a 64-bit environment with Operations Manager 2007 R2 or Operations Manager 2007 SP1 with hotfix (KB971541) installed. This enables the Configuration Manager 2007 SP2 Management Pack to work with either the 32-bit or the 64-bit Operations Manager 2007 agent. Except for the 64-bit support, the other features and guidance for Configuration Manager 2007 Management Packs remain intact. Emphasis is mine. Read more and download here:http://www.microsoft.com/downloads/details.aspx?FamilyID=a8443173-46c2-4581-b3b8-ce67160f627b","text":"Microsoft has released an updated MP for SCCM SP2 (v6.0.6000.2, released on 10/28/2009) for OpsMgr R2. The update basically contains support for x64 that was missing in the previous release. The Configuration Manager 2007 SP2 Management Pack adds support for monitoring Configuration Manager 2007 SP2 in a 64-bit environment with Operations Manager 2007 R2 or Operations Manager 2007 SP1 with hotfix (KB971541) installed. This enables the Configuration Manager 2007 SP2 Management Pack to work with either the 32-bit or the 64-bit Operations Manager 2007 agent. Except for the 64-bit support, the other features and guidance for Configuration Manager 2007 Management Packs remain intact. Emphasis is mine. Read more and download here:http://www.microsoft.com/downloads/details.aspx?FamilyID=a8443173-46c2-4581-b3b8-ce67160f627b","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}],"tags":[{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"},{"name":"Management Pack","slug":"Management-Pack","permalink":"https://www.teknoglot.se/tag/Management-Pack/"},{"name":"x64","slug":"x64","permalink":"https://www.teknoglot.se/tag/x64/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}]},{"title":"Installing SQL Reporting Services 2005 on Windows 2008 x64","slug":"installing-sql-reporting-services-2005-on-windows-2008-x64","date":"2009-11-02T13:33:27.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/sql/installing-sql-reporting-services-2005-on-windows-2008-x64/","link":"","permalink":"https://www.teknoglot.se/ms/sql/installing-sql-reporting-services-2005-on-windows-2008-x64/","excerpt":"Let‚Äôs say you have followed this guide: http://support.microsoft.com/kb/938245/ Still not working? The one thing I forgot, or rather did not find in any of the guides, was to change the website application pool to ‚ÄúClassic .NET AppPool‚Äù. It is actually noted in KB938245 but only after the installation, during the configuration. For some reason I have not been able to install Reporting Services 2005 on Windows 2008 without changing this prior to the installation. Maybe I am doing it wrong but this seems to be working all right for me.","text":"Let‚Äôs say you have followed this guide: http://support.microsoft.com/kb/938245/ Still not working? The one thing I forgot, or rather did not find in any of the guides, was to change the website application pool to ‚ÄúClassic .NET AppPool‚Äù. It is actually noted in KB938245 but only after the installation, during the configuration. For some reason I have not been able to install Reporting Services 2005 on Windows 2008 without changing this prior to the installation. Maybe I am doing it wrong but this seems to be working all right for me.","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"SQL Server","slug":"ms/sql","permalink":"https://www.teknoglot.se/topics/ms/sql/"}],"tags":[{"name":"How-To","slug":"How-To","permalink":"https://www.teknoglot.se/tag/How-To/"},{"name":"IIS7","slug":"IIS7","permalink":"https://www.teknoglot.se/tag/IIS7/"},{"name":"Reporting Services","slug":"Reporting-Services","permalink":"https://www.teknoglot.se/tag/Reporting-Services/"},{"name":"x64","slug":"x64","permalink":"https://www.teknoglot.se/tag/x64/"},{"name":"OpsMgr 2007","slug":"OpsMgr-2007","permalink":"https://www.teknoglot.se/tag/OpsMgr-2007/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"SQL Server","slug":"ms/sql","permalink":"https://www.teknoglot.se/topics/ms/sql/"}]},{"title":"Cannot Delete Files with Long Paths?","slug":"cannot-delete-files-with-long-paths","date":"2009-10-21T07:39:17.000Z","updated":"2018-08-28T13:23:19.952Z","comments":true,"path":"ms/windows/cannot-delete-files-with-long-paths/","link":"","permalink":"https://www.teknoglot.se/ms/windows/cannot-delete-files-with-long-paths/","excerpt":"What do you do when you cannot delete a file or folder on a windows server? Check the file permissions! And if that doesn‚Äôt help? Check the share permissions! Yes, if it is a shared folder. And if that doesn‚Äôt help? Check the file ownership! Great! But then what? Well, the file could be in use, and then you would have to shut the locking process down and perhaps kick a user out. In a really bad scenario it could also be a symptom of a broken filesystem, a reserved filename (like ‚Äúlpt1‚Äù or ‚ÄúPRN‚Äù) or even an invalid name (silly things like a space in the beginning or the end of a filename). Another possible reason could actually be that the path to the file or folder is too long. You won‚Äôt actually get an error telling you that the filepath exceeds the 255 characters Windows can handle but a simple ‚ÄúAcces Denied‚Äù. There are some, more or less tedious, work-arounds for the problem. Like renaming, starting from the root, all the directories to shorter ones or using the old DOS (8.3, like ‚Äúdokume~1.doc‚Äù) names that windows can auto-generate for you. Personally, I have two favourite ways of handling this. Map the parent-directory of the file/folder you are trying to access/delete as a network drive and access your files that way. This is particularly useful if the folder you are trying to access a DFS-share or perhaps a share on the central fileserver filepaths like \\\\servername01\\Central Projects\\Central Services\\IT Department\\Develop Methods for Automatically Deploying New Central Servers\\2.2.1 Auto-Deploying SQL-Server 2005 Cluster\\Documents\\Preparations\\Whitepapers\\SQL Server 2005 Failover Clustering White Paper.doc Create a new share to a folder further down the hierarchy. This works locally too if you are logged on to, say, SRV01, you create a new share on D:\\\\Central Projects\\Central Services\\IT Department\\Develop Methods for Automatically Deploying New Central Servers\\ called Autodeploymethods and access it from \\\\SRV01\\Autodeploymethods. That way the filepath doesn‚Äôt exceed 255 characters. Now. When designing fileservers, you really should think about how deep the filepaths may get. This is especially true on DFS-shares since you might have to deal with the full FQDN too, and not only the actual folder structure. Many big corporations I know uses ‚Äúcodes‚Äù for departments and assign a project ID (quite simply a number or maybe an abbreviation) to each project and uses theese for the fileshares too. Another scenario that could lead to similar problems are intranet sites where users can create and manage their own subsites and where filenames and folders are not stored in a database. I have only seen this phenomena on Windows systems so far, and I‚Äôve actually used a linux Live-CD on occasion when admin access is denied. Read More: http://support.microsoft.com/kb/320081","text":"What do you do when you cannot delete a file or folder on a windows server? Check the file permissions! And if that doesn‚Äôt help? Check the share permissions! Yes, if it is a shared folder. And if that doesn‚Äôt help? Check the file ownership! Great! But then what? Well, the file could be in use, and then you would have to shut the locking process down and perhaps kick a user out. In a really bad scenario it could also be a symptom of a broken filesystem, a reserved filename (like ‚Äúlpt1‚Äù or ‚ÄúPRN‚Äù) or even an invalid name (silly things like a space in the beginning or the end of a filename). Another possible reason could actually be that the path to the file or folder is too long. You won‚Äôt actually get an error telling you that the filepath exceeds the 255 characters Windows can handle but a simple ‚ÄúAcces Denied‚Äù. There are some, more or less tedious, work-arounds for the problem. Like renaming, starting from the root, all the directories to shorter ones or using the old DOS (8.3, like ‚Äúdokume~1.doc‚Äù) names that windows can auto-generate for you. Personally, I have two favourite ways of handling this. Map the parent-directory of the file/folder you are trying to access/delete as a network drive and access your files that way. This is particularly useful if the folder you are trying to access a DFS-share or perhaps a share on the central fileserver filepaths like \\\\servername01\\Central Projects\\Central Services\\IT Department\\Develop Methods for Automatically Deploying New Central Servers\\2.2.1 Auto-Deploying SQL-Server 2005 Cluster\\Documents\\Preparations\\Whitepapers\\SQL Server 2005 Failover Clustering White Paper.doc Create a new share to a folder further down the hierarchy. This works locally too if you are logged on to, say, SRV01, you create a new share on D:\\\\Central Projects\\Central Services\\IT Department\\Develop Methods for Automatically Deploying New Central Servers\\ called Autodeploymethods and access it from \\\\SRV01\\Autodeploymethods. That way the filepath doesn‚Äôt exceed 255 characters. Now. When designing fileservers, you really should think about how deep the filepaths may get. This is especially true on DFS-shares since you might have to deal with the full FQDN too, and not only the actual folder structure. Many big corporations I know uses ‚Äúcodes‚Äù for departments and assign a project ID (quite simply a number or maybe an abbreviation) to each project and uses theese for the fileshares too. Another scenario that could lead to similar problems are intranet sites where users can create and manage their own subsites and where filenames and folders are not stored in a database. I have only seen this phenomena on Windows systems so far, and I‚Äôve actually used a linux Live-CD on occasion when admin access is denied. Read More: http://support.microsoft.com/kb/320081","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"Windows","slug":"ms/windows","permalink":"https://www.teknoglot.se/topics/ms/windows/"}],"tags":[{"name":"Windows","slug":"Windows","permalink":"https://www.teknoglot.se/tag/Windows/"},{"name":"Errors","slug":"Errors","permalink":"https://www.teknoglot.se/tag/Errors/"},{"name":"KB","slug":"KB","permalink":"https://www.teknoglot.se/tag/KB/"},{"name":"Windows 2008","slug":"Windows-2008","permalink":"https://www.teknoglot.se/tag/Windows-2008/"},{"name":"Windows Vista","slug":"Windows-Vista","permalink":"https://www.teknoglot.se/tag/Windows-Vista/"},{"name":"Windows XP","slug":"Windows-XP","permalink":"https://www.teknoglot.se/tag/Windows-XP/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"Windows","slug":"ms/windows","permalink":"https://www.teknoglot.se/topics/ms/windows/"}]},{"title":"Microsoft Adds support for SUSE 11 in OpsMgr R2","slug":"microsoft-adds-support-for-suse-11-in-opsmgr-r2","date":"2009-10-16T05:59:10.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2007/microsoft-adds-support-for-suse-11-in-opsmgr-r2/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2007/microsoft-adds-support-for-suse-11-in-opsmgr-r2/","excerpt":"This update hasn‚Äôt showed up in the MP Catalog yet, but the System Center Operations Manager 2007 R2 Cross Platform Update can be downloaded here. Besides SUSE 11 support, here‚Äôs the short overview. The System Center Operations Manager 2007 R2 Cross Platform Update adds fixes for a defunct process issue on Unix/Linux Servers, as well as, adds support for SUSE Linux Enterprise Server 11 (both 32-bit and 64-bit versions) and Solaris Zone support.Feature Summary:The System Center Operations Manager 2007 R2 Cross Platform Update supports the monitoring of Unix/Linux Servers including: Monitoring of SUSE Linux Enterprise Server 11 servers (both 32-bit and 64-bit versions) Support of Solaris Zones Fix for defunct Process issue The Cross Platform Agent may not discover soft partitions on Solaris systems. Therefore, the disk provider may be unloaded, and the Cross Platform Agent may stop collecting information from the system disks. The Cross Platform Agent may not restart after the AIX server reboots. The latest versions of all the Operations Manager 2007 R2 Unix/Linux agents are included in this update. Perfect timing, I must say, since I really need this today. :D Update:This is no small MP-update, which probably is the reason that we do not find it in the MP Catalog, but a ~250MB OpsMgr R2 Software Update. You need to run this on all Operations Manager Servers (RMS/MS, GW?) since it actually updates many of the agent Cross Platform binaries. It does add a new MP f√∂r SUSE 11 that you have to import from disk if you need it. So, the installation goes somewhat like this: Install the Software Update (pick the right Architecture) on all OpsMgr R2 Servers Import the SUSE 11 MP if necessary Re-discover your Unix/Linux machines. Files updated in this update for R2: .Microsoft.Enterprisemanagement.UI.Administration.dll (Version 6.1.7043.1) .AgentManagementUnixAgentsscx-1.0.4-248.aix.5.ppc.lpp.gz .AgentManagementUnixAgentsscx-1.0.4-248.aix.6.ppc.lpp.gz .AgentManagementUnixAgentsscx-1.0.4-248.hpux.11iv2.ia64.depot.Z .AgentManagementUnixAgentsscx-1.0.4-248.hpux.11iv2.parisc.depot.Z .AgentManagementUnixAgentsscx-1.0.4-248.hpux.11iv3.ia64.depot.Z .AgentManagementUnixAgentsscx-1.0.4-248.hpux.11iv3.parisc.depot.Z .AgentManagementUnixAgentsscx-1.0.4-248.rhel.4.x64.rpm .AgentManagementUnixAgentsscx-1.0.4-248.rhel.4.x86.rpm .AgentManagementUnixAgentsscx-1.0.4-248.rhel.5.x64.rpm .AgentManagementUnixAgentsscx-1.0.4-248.rhel.5.x86.rpm .AgentManagementUnixAgentsscx-1.0.4-248.sles.10.x64.rpm .AgentManagementUnixAgentsscx-1.0.4-248.sles.10.x86.rpm .AgentManagementUnixAgentsscx-1.0.4-248.sles.9.x86.rpm .AgentManagementUnixAgentsscx-1.0.4-248.solaris.10.sparc.pkg.Z .AgentManagementUnixAgentsscx-1.0.4-248.solaris.10.x86.pkg.Z .AgentManagementUnixAgentsscx-1.0.4-248.solaris.8.sparc.pkg.Z .AgentManagementUnixAgentsscx-1.0.4-248.solaris.9.sparc.pkg.Z Files added:","text":"This update hasn‚Äôt showed up in the MP Catalog yet, but the System Center Operations Manager 2007 R2 Cross Platform Update can be downloaded here. Besides SUSE 11 support, here‚Äôs the short overview. The System Center Operations Manager 2007 R2 Cross Platform Update adds fixes for a defunct process issue on Unix/Linux Servers, as well as, adds support for SUSE Linux Enterprise Server 11 (both 32-bit and 64-bit versions) and Solaris Zone support.Feature Summary:The System Center Operations Manager 2007 R2 Cross Platform Update supports the monitoring of Unix/Linux Servers including: Monitoring of SUSE Linux Enterprise Server 11 servers (both 32-bit and 64-bit versions) Support of Solaris Zones Fix for defunct Process issue The Cross Platform Agent may not discover soft partitions on Solaris systems. Therefore, the disk provider may be unloaded, and the Cross Platform Agent may stop collecting information from the system disks. The Cross Platform Agent may not restart after the AIX server reboots. The latest versions of all the Operations Manager 2007 R2 Unix/Linux agents are included in this update. Perfect timing, I must say, since I really need this today. :D Update:This is no small MP-update, which probably is the reason that we do not find it in the MP Catalog, but a ~250MB OpsMgr R2 Software Update. You need to run this on all Operations Manager Servers (RMS/MS, GW?) since it actually updates many of the agent Cross Platform binaries. It does add a new MP f√∂r SUSE 11 that you have to import from disk if you need it. So, the installation goes somewhat like this: Install the Software Update (pick the right Architecture) on all OpsMgr R2 Servers Import the SUSE 11 MP if necessary Re-discover your Unix/Linux machines. Files updated in this update for R2: .Microsoft.Enterprisemanagement.UI.Administration.dll (Version 6.1.7043.1) .AgentManagementUnixAgentsscx-1.0.4-248.aix.5.ppc.lpp.gz .AgentManagementUnixAgentsscx-1.0.4-248.aix.6.ppc.lpp.gz .AgentManagementUnixAgentsscx-1.0.4-248.hpux.11iv2.ia64.depot.Z .AgentManagementUnixAgentsscx-1.0.4-248.hpux.11iv2.parisc.depot.Z .AgentManagementUnixAgentsscx-1.0.4-248.hpux.11iv3.ia64.depot.Z .AgentManagementUnixAgentsscx-1.0.4-248.hpux.11iv3.parisc.depot.Z .AgentManagementUnixAgentsscx-1.0.4-248.rhel.4.x64.rpm .AgentManagementUnixAgentsscx-1.0.4-248.rhel.4.x86.rpm .AgentManagementUnixAgentsscx-1.0.4-248.rhel.5.x64.rpm .AgentManagementUnixAgentsscx-1.0.4-248.rhel.5.x86.rpm .AgentManagementUnixAgentsscx-1.0.4-248.sles.10.x64.rpm .AgentManagementUnixAgentsscx-1.0.4-248.sles.10.x86.rpm .AgentManagementUnixAgentsscx-1.0.4-248.sles.9.x86.rpm .AgentManagementUnixAgentsscx-1.0.4-248.solaris.10.sparc.pkg.Z .AgentManagementUnixAgentsscx-1.0.4-248.solaris.10.x86.pkg.Z .AgentManagementUnixAgentsscx-1.0.4-248.solaris.8.sparc.pkg.Z .AgentManagementUnixAgentsscx-1.0.4-248.solaris.9.sparc.pkg.Z Files added: Microsoft.Linux.SLES.11.MP All in all, the update contains the following fixes: KB969342 KB973583 Q954049 Q956240","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}],"tags":[{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"},{"name":"Management Pack","slug":"Management-Pack","permalink":"https://www.teknoglot.se/tag/Management-Pack/"},{"name":"X-Plat","slug":"X-Plat","permalink":"https://www.teknoglot.se/tag/X-Plat/"},{"name":"SUSE 11","slug":"SUSE-11","permalink":"https://www.teknoglot.se/tag/SUSE-11/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}]},{"title":"Health Rollup not working in Exchange Management Pack","slug":"health-rollup-not-working-in-exchange-management-pack","date":"2009-10-14T10:17:08.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2007/health-rollup-not-working-in-exchange-management-pack/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2007/health-rollup-not-working-in-exchange-management-pack/","excerpt":"I‚Äôve wrestled a bit with a critical status on one of the Organization States at a clients site that wont go back to green despite all the underlying monitors have gone back to green. And apparently I am not alone on this one. Others, like me, has read and re-read the MP-guide i search for a monitor/rule/discovery for overrides forgotten, and I don‚Äôt know how many times I‚Äôve made a small change and tried resetting the health once again. Anyhow.Marius Sutara posted an answer on TechNet forums last week with a ‚Äúfix‚Äù (-ish), or rather the acknowledgement that the problem is not a 40c. The problem might be related to other MP as well, but I‚Äôve only seen it on the new Exchange MP so far. In that same post, Pete Zerger provided some links to two nifty little tools that will help you reset the health of the monitor. In case you wonder why on earth I post when there‚Äôs allready a ‚Äúsolution‚Äù out there; Pagerank, baby!Not for me, but for the forum post making it show up earlier on google.","text":"I‚Äôve wrestled a bit with a critical status on one of the Organization States at a clients site that wont go back to green despite all the underlying monitors have gone back to green. And apparently I am not alone on this one. Others, like me, has read and re-read the MP-guide i search for a monitor/rule/discovery for overrides forgotten, and I don‚Äôt know how many times I‚Äôve made a small change and tried resetting the health once again. Anyhow.Marius Sutara posted an answer on TechNet forums last week with a ‚Äúfix‚Äù (-ish), or rather the acknowledgement that the problem is not a 40c. The problem might be related to other MP as well, but I‚Äôve only seen it on the new Exchange MP so far. In that same post, Pete Zerger provided some links to two nifty little tools that will help you reset the health of the monitor. In case you wonder why on earth I post when there‚Äôs allready a ‚Äúsolution‚Äù out there; Pagerank, baby!Not for me, but for the forum post making it show up earlier on google.","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}],"tags":[{"name":"Errors","slug":"Errors","permalink":"https://www.teknoglot.se/tag/Errors/"},{"name":"Exchange","slug":"Exchange","permalink":"https://www.teknoglot.se/tag/Exchange/"},{"name":"Management Pack","slug":"Management-Pack","permalink":"https://www.teknoglot.se/tag/Management-Pack/"},{"name":"TechNet","slug":"TechNet","permalink":"https://www.teknoglot.se/tag/TechNet/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}]},{"title":"Updated: Operations Manager 2007 R2 Management Pack","slug":"updated-operations-manager-2007-r2-management-pack","date":"2009-10-14T09:29:00.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2007/updated-operations-manager-2007-r2-management-pack/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2007/updated-operations-manager-2007-r2-management-pack/","excerpt":"Microsoft released an updated MP (v6.1.7533.0, released on 10/8/2009) for monitoring the health the Operations Manager components. Most significant updates, according to me, would seem to be: Fixed an issue that was previously preventing all rules related to agentless exception monitoring from generating alerts.Added the rule ‚ÄúCollects Opsmgr SDK ServiceClient Connections‚Äù to collect the number of connected clients for a given management group. This data is shown in the view ‚ÄúConsole and SDK Connection Count‚Äù under the folder ‚ÄúOperations ManagerManagement Server Performance‚Äù.Updated a number of monitors and rules to ensure that data is reported to the correct management group for multihomed agents.Fixed the configuration of the rule ‚ÄúIIS Discovery Probe Module Execution Failure‚Äù to so that the parameter replacement will now work correctly for alert suppression and generating the details of the alert‚Äôs description. The rest is mostly polishing, fine-tuning and complementary updates. Nothing really ground-breaking here, but still a welcome update. Download at: http://www.microsoft.com/downloads/details.aspx?FamilyID=61365290-3c38-4004-b717-e90bb0f6c148","text":"Microsoft released an updated MP (v6.1.7533.0, released on 10/8/2009) for monitoring the health the Operations Manager components. Most significant updates, according to me, would seem to be: Fixed an issue that was previously preventing all rules related to agentless exception monitoring from generating alerts.Added the rule ‚ÄúCollects Opsmgr SDK ServiceClient Connections‚Äù to collect the number of connected clients for a given management group. This data is shown in the view ‚ÄúConsole and SDK Connection Count‚Äù under the folder ‚ÄúOperations ManagerManagement Server Performance‚Äù.Updated a number of monitors and rules to ensure that data is reported to the correct management group for multihomed agents.Fixed the configuration of the rule ‚ÄúIIS Discovery Probe Module Execution Failure‚Äù to so that the parameter replacement will now work correctly for alert suppression and generating the details of the alert‚Äôs description. The rest is mostly polishing, fine-tuning and complementary updates. Nothing really ground-breaking here, but still a welcome update. Download at: http://www.microsoft.com/downloads/details.aspx?FamilyID=61365290-3c38-4004-b717-e90bb0f6c148","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}],"tags":[{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"},{"name":"Management Pack","slug":"Management-Pack","permalink":"https://www.teknoglot.se/tag/Management-Pack/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}]},{"title":"SQL ManagementPack Survey ‚Äì Make your voice heard","slug":"sql-managementpack-survey-make-your-voice-heard","date":"2009-10-07T12:24:37.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2007/sql-managementpack-survey-make-your-voice-heard/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2007/sql-managementpack-survey-make-your-voice-heard/","excerpt":"According to the OpsMgr Team blog, Microsoft wants to know what you think about their SQL Server MP. It‚Äôs really hard to come by a better opportunity to express your feelings and desires about monitoring SQL Server, so don‚Äôt miss this one out. http://blogs.technet.com/momteam/archive/2009/09/25/sql-management-pack-survey-live-on-connect.aspx","text":"According to the OpsMgr Team blog, Microsoft wants to know what you think about their SQL Server MP. It‚Äôs really hard to come by a better opportunity to express your feelings and desires about monitoring SQL Server, so don‚Äôt miss this one out. http://blogs.technet.com/momteam/archive/2009/09/25/sql-management-pack-survey-live-on-connect.aspx","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}],"tags":[{"name":"Management Pack","slug":"Management-Pack","permalink":"https://www.teknoglot.se/tag/Management-Pack/"},{"name":"SQL Server","slug":"SQL-Server","permalink":"https://www.teknoglot.se/tag/SQL-Server/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}]},{"title":"Replace/Change a Gateway Server","slug":"replacechange-a-gateway-server","date":"2009-09-24T10:32:35.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2007/replacechange-a-gateway-server/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2007/replacechange-a-gateway-server/","excerpt":"Description of problemIf you are looking into replacing an (or just switching to another primary) Operations Manager 2007 Gateway Server for any reason, there‚Äôs a little more to consider than just right-clicking the clients and selecting ‚ÄúChange Primary Management Server‚Äù in the Operations Console.You could end up with agents not being able to connect to the Management Group at all due to a small problem with the order in which Operations Manager do things. Here‚Äôs basically what happens: You tell Operations Manager to change Primary Management Server for AGENTX from GW1 to GW2. The SDK Service (i guess) tells GW1 that ‚ÄúYou‚Äôre no longer the Primary Management Server for AGENTX‚Äù GW1 acknowledges this and stops talking to AGENTX. And I mean Completely stops talking to AGENTX. OpsMgr then tells GW2 to start accepting communication from AGENTX. OpsMgr tries to tell AGENTX that it should talk to GW2 since GW1 won‚Äôt listen. Spotted the problem?This modus operandi probably works when agents are on the same network and in the same domain where fail-over is sort of automatic. The problem we are facing now is that the server are telling the Gateway to stop accepting communications to and from the agent before the agent is notified that there is a new Gateway server to talk to. The agent will continue to talk to GW1 but will be completely ignored and you will probably start seeing events in the Operations Manager eventlog on GW1 with EventID 20000. How do I get around this little feature then? No matter if you found this article after running into the mentioned troubles or if you are googling ahead of time to be prepared, the fix is the same and consists of a few powershell scripts. These scripts are out there allready, but in different contexts, hence this post. First step: Install the new GatewayDocumentation on this from Microsoft is good enough, but here‚Äôs the short version. Verify name resolution to and from Gateway server and Management Server Create certificate for the Gateway server Approve the Gateway server Install Gateway server Import certificates on Windows system Run MOMCertImport.exe on Gateway server to add the certificate into Gateway server configuration Wait","text":"Description of problemIf you are looking into replacing an (or just switching to another primary) Operations Manager 2007 Gateway Server for any reason, there‚Äôs a little more to consider than just right-clicking the clients and selecting ‚ÄúChange Primary Management Server‚Äù in the Operations Console.You could end up with agents not being able to connect to the Management Group at all due to a small problem with the order in which Operations Manager do things. Here‚Äôs basically what happens: You tell Operations Manager to change Primary Management Server for AGENTX from GW1 to GW2. The SDK Service (i guess) tells GW1 that ‚ÄúYou‚Äôre no longer the Primary Management Server for AGENTX‚Äù GW1 acknowledges this and stops talking to AGENTX. And I mean Completely stops talking to AGENTX. OpsMgr then tells GW2 to start accepting communication from AGENTX. OpsMgr tries to tell AGENTX that it should talk to GW2 since GW1 won‚Äôt listen. Spotted the problem?This modus operandi probably works when agents are on the same network and in the same domain where fail-over is sort of automatic. The problem we are facing now is that the server are telling the Gateway to stop accepting communications to and from the agent before the agent is notified that there is a new Gateway server to talk to. The agent will continue to talk to GW1 but will be completely ignored and you will probably start seeing events in the Operations Manager eventlog on GW1 with EventID 20000. How do I get around this little feature then? No matter if you found this article after running into the mentioned troubles or if you are googling ahead of time to be prepared, the fix is the same and consists of a few powershell scripts. These scripts are out there allready, but in different contexts, hence this post. First step: Install the new GatewayDocumentation on this from Microsoft is good enough, but here‚Äôs the short version. Verify name resolution to and from Gateway server and Management Server Create certificate for the Gateway server Approve the Gateway server Install Gateway server Import certificates on Windows system Run MOMCertImport.exe on Gateway server to add the certificate into Gateway server configuration Wait The wait is for the gateway server to get all needed configuration from RMS and to download all neccesary management packs, run all the discovery scripts and so on. When the Operations Manager event log has calmed down a bit, move to step two. Second step: Configure Agent FailoverConnect to an Operations Manager Command Shell. Any will do, as long as it‚Äôs connected to the correct Management Group.Then run the following script: $primaryGW= Get-ManagementServer | where &#123;$_.Name -eq 'GW2.domain.local'&#125;$failoverGw = Get-ManagementServer | where &#123;$_.Name -eq 'GW1.domain.local'&#125;$agents = Get-Agent | where &#123;$_.primarymanagementservername -eq 'GW1.domain.local'&#125;Set-ManagementServer -AgentManagedComputer: $agents -PrimaryManagementServer: $primaryGW -FailoverServer: $failoverGw Remember to change ‚ÄúGW1.domain.local‚Äù to you OLD Gateway servername and ‚ÄúGW2.domain.local‚Äù to your NEW Gateway servername. If you don‚Äôt know powershell, this script basically configures all agents using the old Gateway to use the new one as primare, but keep the old one as a fail-over server. The Gateways will still get to know the changes before the agents, but since the old on is still listening to the agents (though, as the fail-over host) it will be able to tell them to go to the new one, GW2.","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}],"tags":[{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"},{"name":"PoSH","slug":"PoSH","permalink":"https://www.teknoglot.se/tag/PoSH/"},{"name":"Script","slug":"Script","permalink":"https://www.teknoglot.se/tag/Script/"},{"name":"How-To","slug":"How-To","permalink":"https://www.teknoglot.se/tag/How-To/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}]},{"title":"My impression of EXT4 -- WTH!?","slug":"my-impression-of-ext4-wth","date":"2009-09-17T17:43:47.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"Linux/my-impression-of-ext4-wth/","link":"","permalink":"https://www.teknoglot.se/Linux/my-impression-of-ext4-wth/","excerpt":"Ok, so I reinstalled my linux partition with Ubuntu 9.04 x64 and decided to try EXT4 on the root partition. Like, yesterday.Managed to get the Citrix client running (way more easy on Ubuntu than Fedora, I‚Äôll be back on that) and all without too much fuzz. First reboot gave me a ‚Äúlet‚Äôs FSCK!‚Äù. So I FSCK-ed and booted up to the desktop. Second reboot gave me a ‚Äúlet‚Äôs FSCK!‚Äù. And I did. Booted to the desktop. Third boot went smoothly, but all of a sudden all the icons decided to go AWOL. Rebooted again. Fourth boot gave me a ‚Äúlet‚Äôs FSCK!‚Äù. I replied with ‚ÄúWell FSCK You!‚Äù Fifth boot gave me a ‚Äúlet‚Äôs FSCK!‚Äù. I rebooted back to Windows 7. Tonight I am reinstalling Ubuntu 9.04 x64 with EXT3.","text":"Ok, so I reinstalled my linux partition with Ubuntu 9.04 x64 and decided to try EXT4 on the root partition. Like, yesterday.Managed to get the Citrix client running (way more easy on Ubuntu than Fedora, I‚Äôll be back on that) and all without too much fuzz. First reboot gave me a ‚Äúlet‚Äôs FSCK!‚Äù. So I FSCK-ed and booted up to the desktop. Second reboot gave me a ‚Äúlet‚Äôs FSCK!‚Äù. And I did. Booted to the desktop. Third boot went smoothly, but all of a sudden all the icons decided to go AWOL. Rebooted again. Fourth boot gave me a ‚Äúlet‚Äôs FSCK!‚Äù. I replied with ‚ÄúWell FSCK You!‚Äù Fifth boot gave me a ‚Äúlet‚Äôs FSCK!‚Äù. I rebooted back to Windows 7. Tonight I am reinstalling Ubuntu 9.04 x64 with EXT3.","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.teknoglot.se/topics/Linux/"}],"tags":[{"name":"Rant","slug":"Rant","permalink":"https://www.teknoglot.se/tag/Rant/"},{"name":"Linux","slug":"Linux","permalink":"https://www.teknoglot.se/tag/Linux/"}],"keywords":[{"name":"Linux","slug":"Linux","permalink":"https://www.teknoglot.se/topics/Linux/"}]},{"title":"The TCP Port Check: Use with caution!","slug":"tcp-port-check-use-with-caution","date":"2009-08-27T12:39:43.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2007/tcp-port-check-use-with-caution/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2007/tcp-port-check-use-with-caution/","excerpt":"Just wanted to raise a word of caution about the TCP Port Check in Operations Manager 2007. Some customers have notices the the system-logs on some Unix machines are completely swamped with ‚Äúconnection error‚Äù, ‚ÄúTCP Connect failed‚Äù, ‚ÄúTCP Session Lost‚Äù and similar and after a bit och research the problematic servers were narrowed down to those monitored by Operations Manager. Specifically, those who are targeted by a TCP Port Check. It would seem like the TCP-connection never fully initializes on the target server. Kind of like knocking on your neighbours door and then hiding. Then when the door opens, no one is there causing your friendly neighbour to hang around waiting for something to happen. Maybe there‚Äôs a setting somewhere to modify how ‚Äúdeep‚Äù a Port Check should go before closing. Perhaps fully initializing and then sending a proper ‚ÄúClose‚Äù instead of just cutting the connection. In a few extreme cases we have noticed that the target server even goes so far as to start a session, but never ending it since there‚Äôs no closure and finally having no sessions to spare for the real users. But on most servers it‚Äôs just an annoyance since the ‚Äúreal‚Äù errors is very hard to be found in all the connection related logs. Anyway. Just a good thing to keep in mind when running TCP Port Checks from Operations Manager 2007. Keep an eye on the logs when implementing the port checks.","text":"Just wanted to raise a word of caution about the TCP Port Check in Operations Manager 2007. Some customers have notices the the system-logs on some Unix machines are completely swamped with ‚Äúconnection error‚Äù, ‚ÄúTCP Connect failed‚Äù, ‚ÄúTCP Session Lost‚Äù and similar and after a bit och research the problematic servers were narrowed down to those monitored by Operations Manager. Specifically, those who are targeted by a TCP Port Check. It would seem like the TCP-connection never fully initializes on the target server. Kind of like knocking on your neighbours door and then hiding. Then when the door opens, no one is there causing your friendly neighbour to hang around waiting for something to happen. Maybe there‚Äôs a setting somewhere to modify how ‚Äúdeep‚Äù a Port Check should go before closing. Perhaps fully initializing and then sending a proper ‚ÄúClose‚Äù instead of just cutting the connection. In a few extreme cases we have noticed that the target server even goes so far as to start a session, but never ending it since there‚Äôs no closure and finally having no sessions to spare for the real users. But on most servers it‚Äôs just an annoyance since the ‚Äúreal‚Äù errors is very hard to be found in all the connection related logs. Anyway. Just a good thing to keep in mind when running TCP Port Checks from Operations Manager 2007. Keep an eye on the logs when implementing the port checks.","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}],"tags":[{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"},{"name":"Errors","slug":"Errors","permalink":"https://www.teknoglot.se/tag/Errors/"},{"name":"Unix","slug":"Unix","permalink":"https://www.teknoglot.se/tag/Unix/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}]},{"title":"Why not use SQL Express? It‚Äôs for free!","slug":"whynotusesqlexpress-itsforfree","date":"2009-08-21T08:38:55.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/sql/whynotusesqlexpress-itsforfree/","link":"","permalink":"https://www.teknoglot.se/ms/sql/whynotusesqlexpress-itsforfree/","excerpt":"BackgroundI get this question every now and then and every time I find myself completely flabbergasted and having to look things up once again. To avoid wasting my time on the same question once again and perhaps help others doing the same, here‚Äôs a little guidance. Don‚Äôt get me wrong now.SQL Express has it‚Äôs applications and for a free database server, it‚Äôs not half-bad. Small development sites, minor, not that extremely important systems with lower performance and feature demands, minor website databases et cetera could do well with SQL Express. My ChecklistHere‚Äôs my list of questions you have to ask to find if SQL Express is the correct choice. 1. Do your applications support SQL Express?If your application developers cannot say ‚ÄúYes‚Äù to this, you‚Äôre out of luck. You could probably get their applications to run on SQL Express anyway, but application support if something goes bad will most likely be zilch. 2. Do your applications fit the hardware limitations?SQL Express is limited to 1GB RAM, 1 CPU and 4GB of databases. 1GB of RAM seems a bit tight to me for any production data. Also, on SQL Express 2005, according to Microsoft, you cannot run parallel queries. ‚ÄùSQL Server Express can install and run on multiprocessor machines, but only a single CPU is used at any time. Internally, the engine limits the number of user scheduler threads to 1 so that only 1 CPU is used at a time. Features such as parallel query execution are not supported because of the single CPU limit.‚Äù","text":"BackgroundI get this question every now and then and every time I find myself completely flabbergasted and having to look things up once again. To avoid wasting my time on the same question once again and perhaps help others doing the same, here‚Äôs a little guidance. Don‚Äôt get me wrong now.SQL Express has it‚Äôs applications and for a free database server, it‚Äôs not half-bad. Small development sites, minor, not that extremely important systems with lower performance and feature demands, minor website databases et cetera could do well with SQL Express. My ChecklistHere‚Äôs my list of questions you have to ask to find if SQL Express is the correct choice. 1. Do your applications support SQL Express?If your application developers cannot say ‚ÄúYes‚Äù to this, you‚Äôre out of luck. You could probably get their applications to run on SQL Express anyway, but application support if something goes bad will most likely be zilch. 2. Do your applications fit the hardware limitations?SQL Express is limited to 1GB RAM, 1 CPU and 4GB of databases. 1GB of RAM seems a bit tight to me for any production data. Also, on SQL Express 2005, according to Microsoft, you cannot run parallel queries. ‚ÄùSQL Server Express can install and run on multiprocessor machines, but only a single CPU is used at any time. Internally, the engine limits the number of user scheduler threads to 1 so that only 1 CPU is used at a time. Features such as parallel query execution are not supported because of the single CPU limit.‚Äù If this is still true on SQL Express 2008, I don‚Äôt know and I haven‚Äôt found any information about it (yet). When answering this question, remember to calculate expected growth and possibly new databases/applications too. 2. Do your applications use database replication? If, so. Do the new server need to act as a publisher? If, yes, then you‚Äôre out of luck. SQL Express do handle database replication, but only as a subscriber. If you need to publish data, then you need a ‚Äúbigger‚Äù SQL Edition. 4. Do you need Database Mail?SQL Express does not have Database Mail. You have to find other ways to code your notifications. This question has raised counter-questions from customers as to ‚ÄúWhat would I need Database Mail for?‚Äù. It is, evidently a feature not used by many. Personally, I find it useful. Clay McDonald has a nice blog-post on how to make SQL-triggers send mail on, for instance, inserts into a table using Database Mail. You could of course have it send mail on deletions as well. In my mind, this might come in handy in user-databases in CRM- or HR-systems. Every time an employee gets deleted from the database, the HR-admin could receive a notification. 5. Do you need the SQL Agent?Perhaps not. Maybe you feel comfortable with scheduling your database backups using the windows scheduler and homebrew scripts. Just make sure your monitoring software (or IT-personnel) discover when the script fails. An increasing amount of applications require the SQL Agent to schedule and monitor recurring tasks, like Microsoft‚Äôs App-V. Without the SQL Agent, the databases would grow ad infinitum. How about index maintenance? This is also possible to go by using your own scripts and the windows scheduler. SQL Express can do most maintenance tasks you would need using scripts and T-SQL. The SQL Agent just makes it simpler and more manageable. Once again, double-check this with the application developer. 6. Do you application use SSIS/DTS-jobs?This is not included in SQL Express. Maybe there‚Äôs a work-around, but I haven‚Äôt found it and I doubt it is supported by anyone. 7. Do you need to be able to troubleshoot performance problems?You can do this on SQL Express with a great deal of knowledge and timers. The SQL-profiler, the Performance Data Collection and the Database Tuning Advisor makes it easier. Specifically, the SQL-profiler comes in really handy when you suspect the application (not the system) to be the bad guy since you can trace the queries and pin-point where the performance-hit resides. Using the SQL-profiler I have been able to optimise indexes to and thus making database servers go from a 98% CPU Load to 3% CPU Load. I have also been able to pin-point specific queries and use them as ‚Äúevidence‚Äù that the problem is bad/sloppy code rather than problems with the database server. Also, using the SQL-profiler. There‚Äôs more, of course, but these point are the most common pit-falls in my experience. As you can see, there‚Äôs three ‚Äúdo you need‚Äù-questions and there are highly optional. Far from everyone use them and often because of lacking SQL Server knowledge. You don‚Äôt know what you can do. Still, the most important question is #1. Is SQL Express a supported database server for your applications. Hopefully, the developer knows the answer to this directly. No maybe‚Äôs. Yes or No. Personally, I find that If you need a database server for production data, don‚Äôt go for SQL Express. Many customers have gone that way because ‚Äúit‚Äôs free!‚Äù just to find themselves in the midst of a SQL Server upgrade and database migration a year later.","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"SQL Server","slug":"ms/sql","permalink":"https://www.teknoglot.se/topics/ms/sql/"}],"tags":[{"name":"Checklist","slug":"Checklist","permalink":"https://www.teknoglot.se/tag/Checklist/"},{"name":"SQL Express 2005","slug":"SQL-Express-2005","permalink":"https://www.teknoglot.se/tag/SQL-Express-2005/"},{"name":"SQL Express 2008","slug":"SQL-Express-2008","permalink":"https://www.teknoglot.se/tag/SQL-Express-2008/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"SQL Server","slug":"ms/sql","permalink":"https://www.teknoglot.se/topics/ms/sql/"}]},{"title":"MSMQ Management Pack: Subscript Out of Range","slug":"msmq-mp-subscriptoutofrange","date":"2009-06-24T07:51:01.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2007/msmq-mp-subscriptoutofrange/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2007/msmq-mp-subscriptoutofrange/","excerpt":"UPDATE: This problem seems to be fixed in the latest update! The MSMQ Management Pack seems to have a few problems with it‚Äôs discovery script that can lead to the following error showing up in the logs: The process started at 13:34:40 failed to create System.Discovery.Data. Errors found in output:C:Program FilesSystem Center Operations Manager 2007Health Service StateMonitoring Host Temporary Files 499788DiscoverQueues.vbs(107, 4) Microsoft VBScript runtime error: Subscript out of range: &apos;[number: 0]&apos;Command executed: &quot;C:WINDOWSsystem32cscript.exe&quot; /nologo &quot;DiscoverQueues.vbs&quot; &#123;615D37C9-477D-62E2-0833-6ECBF0E89A87&#125; &#123;A176AC83-CC31-01C3-5DE9-E2DFF64E7CC7&#125; &quot;MASKED.server.fqdn&quot; &quot;MSMQ&quot; &quot;true&quot; &quot;true&quot; &quot;False&quot; &quot;false&quot;Working Directory: C:Program FilesSystem Center Operations Manager 2007Health Service StateMonitoring Host Temporary Files 499788One or more workflows were affected by this.Workflow name: Microsoft.MSMQ.2003.DiscoverQueuesInstance name: MASKED.server.fqdnInstance ID: &#123;A176AC83-CC31-01C3-5DE9-E2DFF64E7CC7&#125;Management group: MASKED This seems to be related to the discovery of public queues on some servers that has none. One quick fix, or rather work-around, is to override the discovery on these servers to set DiscoverPublic to False.","text":"UPDATE: This problem seems to be fixed in the latest update! The MSMQ Management Pack seems to have a few problems with it‚Äôs discovery script that can lead to the following error showing up in the logs: The process started at 13:34:40 failed to create System.Discovery.Data. Errors found in output:C:Program FilesSystem Center Operations Manager 2007Health Service StateMonitoring Host Temporary Files 499788DiscoverQueues.vbs(107, 4) Microsoft VBScript runtime error: Subscript out of range: &apos;[number: 0]&apos;Command executed: &quot;C:WINDOWSsystem32cscript.exe&quot; /nologo &quot;DiscoverQueues.vbs&quot; &#123;615D37C9-477D-62E2-0833-6ECBF0E89A87&#125; &#123;A176AC83-CC31-01C3-5DE9-E2DFF64E7CC7&#125; &quot;MASKED.server.fqdn&quot; &quot;MSMQ&quot; &quot;true&quot; &quot;true&quot; &quot;False&quot; &quot;false&quot;Working Directory: C:Program FilesSystem Center Operations Manager 2007Health Service StateMonitoring Host Temporary Files 499788One or more workflows were affected by this.Workflow name: Microsoft.MSMQ.2003.DiscoverQueuesInstance name: MASKED.server.fqdnInstance ID: &#123;A176AC83-CC31-01C3-5DE9-E2DFF64E7CC7&#125;Management group: MASKED This seems to be related to the discovery of public queues on some servers that has none. One quick fix, or rather work-around, is to override the discovery on these servers to set DiscoverPublic to False.","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}],"tags":[{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"},{"name":"Errors","slug":"Errors","permalink":"https://www.teknoglot.se/tag/Errors/"},{"name":"MSMQ","slug":"MSMQ","permalink":"https://www.teknoglot.se/tag/MSMQ/"},{"name":"Fixed","slug":"Fixed","permalink":"https://www.teknoglot.se/tag/Fixed/"},{"name":"Quick-fix","slug":"Quick-fix","permalink":"https://www.teknoglot.se/tag/Quick-fix/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}]},{"title":"Windows Server 2008 NLB MP for OpsMgr released","slug":"windows-server-2008-nlb-m-for-opsmgr-released","date":"2009-04-29T10:59:54.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2007/windows-server-2008-nlb-m-for-opsmgr-released/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2007/windows-server-2008-nlb-m-for-opsmgr-released/","excerpt":"Don‚Äôt know how I missed this when writing the last post, but Microsoft released the MP for Windows Server 2008 NLB yesterday (28/4 -09). This is the initial release for Win2k8 NLB so I guess we just have to try it out then. Quick DetailsFile Name: Microsoft Server 2008 Network Load Balancing System Center Operations Manager 2007 MP.msiVersion: 6.0.6573.0Date Published: 4/28/2009Language: EnglishDownload Size: 519 KB Feature Summary Monitor the NLB Node status. Based on the status of individual cluster nodes, determine the overall state of the cluster. Where an integration management pack exists, determine the health state of a cluster node by looking at the health state of the load balanced application, such as IIS. Alert on errors and warnings that are reported by the NLB driver, such as an incorrectly configured NLB cluster. Take the node out of the NLB cluster if the underlying load-balanced application becomes unhealthy, and add the node back to the cluster when the application becomes healthy again. Requires OpsMgr 2007 SP1 or later, the Base Operating System MP for 2008, the QFEs for Windows Server 2008 and that you are not running the converted 2003 NLB MP. If you are running the old converted NLB MP, upgrade first. As an additional recommendation, Microsoft recommends in the MP Guide that you install the QFE for wmiprvse.exe problems on Windows Server 2008. No support for Mixed-mode (2008 and 2003) clusters though.","text":"Don‚Äôt know how I missed this when writing the last post, but Microsoft released the MP for Windows Server 2008 NLB yesterday (28/4 -09). This is the initial release for Win2k8 NLB so I guess we just have to try it out then. Quick DetailsFile Name: Microsoft Server 2008 Network Load Balancing System Center Operations Manager 2007 MP.msiVersion: 6.0.6573.0Date Published: 4/28/2009Language: EnglishDownload Size: 519 KB Feature Summary Monitor the NLB Node status. Based on the status of individual cluster nodes, determine the overall state of the cluster. Where an integration management pack exists, determine the health state of a cluster node by looking at the health state of the load balanced application, such as IIS. Alert on errors and warnings that are reported by the NLB driver, such as an incorrectly configured NLB cluster. Take the node out of the NLB cluster if the underlying load-balanced application becomes unhealthy, and add the node back to the cluster when the application becomes healthy again. Requires OpsMgr 2007 SP1 or later, the Base Operating System MP for 2008, the QFEs for Windows Server 2008 and that you are not running the converted 2003 NLB MP. If you are running the old converted NLB MP, upgrade first. As an additional recommendation, Microsoft recommends in the MP Guide that you install the QFE for wmiprvse.exe problems on Windows Server 2008. No support for Mixed-mode (2008 and 2003) clusters though.","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}],"tags":[{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"},{"name":"Management Pack","slug":"Management-Pack","permalink":"https://www.teknoglot.se/tag/Management-Pack/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}]},{"title":"MSMQ 3 MP for OpsMgr v.6.0.6587.0 Released","slug":"msmq-3-mp-for-opsmgr-v6065870-released","date":"2009-04-28T13:30:18.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2007/msmq-3-mp-for-opsmgr-v6065870-released/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2007/msmq-3-mp-for-opsmgr-v6065870-released/","excerpt":"Last friday, 24/4 -09, Microsoft released an updated Management Pack for MSMQ 3.0. Quick Details File Name: Message Queuing System Center Operations Manager 2007 MP.MSI Version: 6.0.6587.0 Date Published: 4/24/2009 Language: English Download Size: 502 KB Release History 6/3/2008 - Initial Release, version 6.0.6278.23. Refer to the MP guide for further details.* 4/24/2009 - Undated release, version 6.0.6587.0. Refer to the MP guide for further details. The MP Guide does not really say much about what‚Äôs updated and I don‚Äôt know how much more than the reporting they have fixed. I can just state the fact that support for clustered MSMQ 3 instances is still missing.","text":"Last friday, 24/4 -09, Microsoft released an updated Management Pack for MSMQ 3.0. Quick Details File Name: Message Queuing System Center Operations Manager 2007 MP.MSI Version: 6.0.6587.0 Date Published: 4/24/2009 Language: English Download Size: 502 KB Release History 6/3/2008 - Initial Release, version 6.0.6278.23. Refer to the MP guide for further details.* 4/24/2009 - Undated release, version 6.0.6587.0. Refer to the MP guide for further details. The MP Guide does not really say much about what‚Äôs updated and I don‚Äôt know how much more than the reporting they have fixed. I can just state the fact that support for clustered MSMQ 3 instances is still missing.","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}],"tags":[{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"},{"name":"Management Pack","slug":"Management-Pack","permalink":"https://www.teknoglot.se/tag/Management-Pack/"},{"name":"MSMQ","slug":"MSMQ","permalink":"https://www.teknoglot.se/tag/MSMQ/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}]},{"title":"NetworkAdapterCheck.vbs fails on Windows 2000","slug":"networkadaptercheck-fails-on-win2k","date":"2009-04-26T09:21:18.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2007/networkadaptercheck-fails-on-win2k/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2007/networkadaptercheck-fails-on-win2k/","excerpt":"ProblemHere‚Äôs my summary of the problems with the NetworkAdapterCheck.vbs script in the Windows Server 2000 Operating System Management Pack f√∂r Operations Manager 2007 that is causing the failed to create System.PropertyBagData error i wrote about earlier.This information in also available on https://connect.microsoft.com/feedback/ViewFeedback.aspx?FeedbackID=432627&amp;SiteID=446 SymptomsThis ‚Äúresearch‚Äù comes from getting an obscene amounts of Script or Executable Failed to run in the Operations Console. Each time it was the NetworkAdapterCheck.vbs script that could not create PropertyBagData. The error message copied from one of the alerts looks like this: The process started at 14:29:26 failed to create System.PropertyBagData, no errors detected in the output. The process exited with 0Command executed: &quot;C:WINNTsystem32cscript.exe&quot; /nologo &quot;NetworkAdapterCheck.vbs&quot; MASKEDCOMPUTERNAME 0 false true falseWorking Directory: C:Program FilesSystem Center Operations Manager 2007Health Service StateMonitoring Host Temporary Files 2882781One or more workflows were affected by this.Workflow name: Microsoft.Windows.Server.2000.NetworkAdapter.NetworkAdapterConnectionHealthInstance name: 0Instance ID: &#123;F4C478D3-38E5-8C29-3957-E3B7F486216E&#125;Management group: MASKED This error repeats almost as often as the script is scheduled to run and appears on almost every Windows 2000 server. Probable CauseI am not really sure, but after a quite a bit of troubleshooting I am pretty sure it all boils down to a malformed WMI-query. What I basically did was to extract the script from the MP and dry-run it to see if I could find anything obvious, which I didn‚Äôt.Since I didn‚Äôt have a good debugging too available, like in PrimalScript, I added the VBS equivalent of old-school printf debugging. I basically added wscript.echo \"Line XX:\" &amp; Err.Number","text":"ProblemHere‚Äôs my summary of the problems with the NetworkAdapterCheck.vbs script in the Windows Server 2000 Operating System Management Pack f√∂r Operations Manager 2007 that is causing the failed to create System.PropertyBagData error i wrote about earlier.This information in also available on https://connect.microsoft.com/feedback/ViewFeedback.aspx?FeedbackID=432627&amp;SiteID=446 SymptomsThis ‚Äúresearch‚Äù comes from getting an obscene amounts of Script or Executable Failed to run in the Operations Console. Each time it was the NetworkAdapterCheck.vbs script that could not create PropertyBagData. The error message copied from one of the alerts looks like this: The process started at 14:29:26 failed to create System.PropertyBagData, no errors detected in the output. The process exited with 0Command executed: &quot;C:WINNTsystem32cscript.exe&quot; /nologo &quot;NetworkAdapterCheck.vbs&quot; MASKEDCOMPUTERNAME 0 false true falseWorking Directory: C:Program FilesSystem Center Operations Manager 2007Health Service StateMonitoring Host Temporary Files 2882781One or more workflows were affected by this.Workflow name: Microsoft.Windows.Server.2000.NetworkAdapter.NetworkAdapterConnectionHealthInstance name: 0Instance ID: &#123;F4C478D3-38E5-8C29-3957-E3B7F486216E&#125;Management group: MASKED This error repeats almost as often as the script is scheduled to run and appears on almost every Windows 2000 server. Probable CauseI am not really sure, but after a quite a bit of troubleshooting I am pretty sure it all boils down to a malformed WMI-query. What I basically did was to extract the script from the MP and dry-run it to see if I could find anything obvious, which I didn‚Äôt.Since I didn‚Äôt have a good debugging too available, like in PrimalScript, I added the VBS equivalent of old-school printf debugging. I basically added wscript.echo \"Line XX:\" &amp; Err.Number after each object/function call in the Main Sub.The problem seems to be at line 118: Set WMISet = WMIGetInstance(\"winmgmts:\" + TargetComputer + \"rootcimv2\", query) At line 119 I had a debug line that never executes and it would seem like the script is unable to process the query and exits without any error codes. The query variable contains the following: Win32_NetworkAdapter Where DeviceID='0' And ( NetConnectionStatus = '0' ) When I was debugging this I started the script like this: cscript.exe /nologo \"NetworkAdapterCheck.vbs\" MASKED 0 false true false I did find that if I change the parameters to this: cscript.exe /nologo \"NetworkAdapterCheck.vbs\" MASKED 0 false false false Then the script runs smoothly and produces an XML-output like this: &lt;Collection&gt; &lt;DataItem type=\"System.PropertyBagData\" time=\"2009-04-22T15:03:44.6495202+02:00\" sourceHealthServiceId=\"C9F5A9F7-00A3-8A86-57B5-34FB634471A8\"&gt; &lt;Property Name=\"State\" VariantType=\"8\"&gt;GOOD&lt;/Property&gt; &lt;/DataItem&gt;&lt;/Collection&gt; CommentsThere‚Äôs quite the lot of similar errors posted on various forums on the internet but most of them ends up pointing towards the Antivirus Software as the perp and we have tried various exceptions on the server like excluding HealthExplorer.exe, MonitoringHost.exe and also the entire Health Service State folder with no improvement. But since I was able to run the scripts from other locations (not excluded) on the same server I find it hard to believe that the AV would be blocking it.","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}],"tags":[{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"},{"name":"Script","slug":"Script","permalink":"https://www.teknoglot.se/tag/Script/"},{"name":"Errors","slug":"Errors","permalink":"https://www.teknoglot.se/tag/Errors/"},{"name":"Management Pack","slug":"Management-Pack","permalink":"https://www.teknoglot.se/tag/Management-Pack/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}]},{"title":"Clearing Disabled Discovery in OpsMgr 2007","slug":"clearing-disabled-discovery","date":"2009-04-20T08:15:15.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/opsmgr2007/clearing-disabled-discovery/","link":"","permalink":"https://www.teknoglot.se/ms/opsmgr2007/clearing-disabled-discovery/","excerpt":"Jonathan Almquist has posted (a while ago) an article on how to clear discovered objects after you have disabled the discovery rules in OpsMgr that I think deserves a notion. Read more about it at Jonathan Almquist on Operations Manager : Remove-DisabledMonitoringObject.","text":"Jonathan Almquist has posted (a while ago) an article on how to clear discovered objects after you have disabled the discovery rules in OpsMgr that I think deserves a notion. Read more about it at Jonathan Almquist on Operations Manager : Remove-DisabledMonitoringObject.","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}],"tags":[{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"},{"name":"Script","slug":"Script","permalink":"https://www.teknoglot.se/tag/Script/"},{"name":"How-To","slug":"How-To","permalink":"https://www.teknoglot.se/tag/How-To/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"OpsMgr 2007","slug":"ms/opsmgr2007","permalink":"https://www.teknoglot.se/topics/ms/opsmgr2007/"}]},{"title":"Let's split!","slug":"lets-split","date":"2009-04-16T01:27:06.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"tb/lets-split/","link":"","permalink":"https://www.teknoglot.se/tb/lets-split/","excerpt":"Now would you look at that. Since my old site, Tranquillity.se, got messy and unfocused I have now started a new one. That‚Äôs right, you‚Äôre looking at it. Instead of blogging about mostly anything like I did before I have decided to split it into Three sites. This one for the Technical stuff, some other site I haven‚Äôt set up yet, and a personal blogg for the‚Ä¶ personal blogging‚Ä¶ stuff. When time gives, I will import the old tech-related posts from Tranquillity.se into this site but for now. Nothing yet so far. Have a nice day!","text":"Now would you look at that. Since my old site, Tranquillity.se, got messy and unfocused I have now started a new one. That‚Äôs right, you‚Äôre looking at it. Instead of blogging about mostly anything like I did before I have decided to split it into Three sites. This one for the Technical stuff, some other site I haven‚Äôt set up yet, and a personal blogg for the‚Ä¶ personal blogging‚Ä¶ stuff. When time gives, I will import the old tech-related posts from Tranquillity.se into this site but for now. Nothing yet so far. Have a nice day!","categories":[{"name":"Technobabble","slug":"tb","permalink":"https://www.teknoglot.se/topics/tb/"}],"tags":[],"keywords":[{"name":"Technobabble","slug":"tb","permalink":"https://www.teknoglot.se/topics/tb/"}]},{"title":"NVidia problems in Ubuntu 8.10","slug":"nvidia-problems-in-ubuntu-810","date":"2008-11-10T08:20:14.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"Linux/ubuntu/nvidia-problems-in-ubuntu-810/","link":"","permalink":"https://www.teknoglot.se/Linux/ubuntu/nvidia-problems-in-ubuntu-810/","excerpt":"[updated, scroll down if you want to skip some nonsense] So, I did an upgrade to Ubuntu Studio 8.10 (basically Ubuntu with rt-kernel and lots of nice media-related packages easily accessible and a skin that rocks) from the earlier 8.04. And the upgrade itself was really easy. I just opened the ‚ÄúSoftware Sources‚Äù, set the Release upgrade to Normal Releases (you find it under the Updates tab).After that you get the option to do a Distribution Upgrade, which I did (took some 45 minutes to finish). I did however run into some serious problems with the NVidia Drivers after the upgrade. Basically, the new drivers dont seem to install correctly under the new kernel. This conclusion took me a day of laborating with settings, installing packages, uninstalling packages, reinstalling packages and a whole lot of googling. What I have come down to right now is doing the following: sudo apt-get install module-assistantThis will install the module assistant and it will also make sure that you have all the correct linux headers to install the NVidia drivers. Going back to the ‚ÄúSoftware Sources‚Äù under i check the ‚ÄúUnsopported updates‚Äù.Then i execute sudo apt-get autoremovesudo apt-get install nvidia-177-kernel-sourcem-a auto-install nvidiaUPDATE! After fiddling around with this Laptop (Lenovo Thinkpad T61) I really just needed these three steps to fix the problem. All of them from X using the regular nv-drivers. In a terminal, run sudo apt-get install module assistant In a terminal, run sudo m-a auto-install nvidia Open the ‚ÄúHardware Drivers‚Äù application and pick the driver you want (177 in my case) and click Activate. If it worked alright, you‚Äôll get the green recycle icon and be asked to reboot to activate the settings.Hopefully, this might help someone. It did work for me and I am now able to work with wobbly windows and all that crap. (Besides some serious 3d stuff ;) ) Anyway. Since I did not save the urls, I cannot give credit to those who have pointed to stuff that did help me on the way, but I‚Äôve actually not find information anywhere yet that solve the problem totally and, well‚Ä¶ that‚Äôs why I did decide to post in here.","text":"[updated, scroll down if you want to skip some nonsense] So, I did an upgrade to Ubuntu Studio 8.10 (basically Ubuntu with rt-kernel and lots of nice media-related packages easily accessible and a skin that rocks) from the earlier 8.04. And the upgrade itself was really easy. I just opened the ‚ÄúSoftware Sources‚Äù, set the Release upgrade to Normal Releases (you find it under the Updates tab).After that you get the option to do a Distribution Upgrade, which I did (took some 45 minutes to finish). I did however run into some serious problems with the NVidia Drivers after the upgrade. Basically, the new drivers dont seem to install correctly under the new kernel. This conclusion took me a day of laborating with settings, installing packages, uninstalling packages, reinstalling packages and a whole lot of googling. What I have come down to right now is doing the following: sudo apt-get install module-assistantThis will install the module assistant and it will also make sure that you have all the correct linux headers to install the NVidia drivers. Going back to the ‚ÄúSoftware Sources‚Äù under i check the ‚ÄúUnsopported updates‚Äù.Then i execute sudo apt-get autoremovesudo apt-get install nvidia-177-kernel-sourcem-a auto-install nvidiaUPDATE! After fiddling around with this Laptop (Lenovo Thinkpad T61) I really just needed these three steps to fix the problem. All of them from X using the regular nv-drivers. In a terminal, run sudo apt-get install module assistant In a terminal, run sudo m-a auto-install nvidia Open the ‚ÄúHardware Drivers‚Äù application and pick the driver you want (177 in my case) and click Activate. If it worked alright, you‚Äôll get the green recycle icon and be asked to reboot to activate the settings.Hopefully, this might help someone. It did work for me and I am now able to work with wobbly windows and all that crap. (Besides some serious 3d stuff ;) ) Anyway. Since I did not save the urls, I cannot give credit to those who have pointed to stuff that did help me on the way, but I‚Äôve actually not find information anywhere yet that solve the problem totally and, well‚Ä¶ that‚Äôs why I did decide to post in here. Feel free to leave a comment if you got any more info or if you got any help from this.","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.teknoglot.se/topics/Linux/"},{"name":"Ubuntu","slug":"Linux/ubuntu","permalink":"https://www.teknoglot.se/topics/Linux/ubuntu/"}],"tags":[{"name":"Drivers","slug":"Drivers","permalink":"https://www.teknoglot.se/tag/Drivers/"},{"name":"NVidia","slug":"NVidia","permalink":"https://www.teknoglot.se/tag/NVidia/"}],"keywords":[{"name":"Linux","slug":"Linux","permalink":"https://www.teknoglot.se/topics/Linux/"},{"name":"Ubuntu","slug":"Linux/ubuntu","permalink":"https://www.teknoglot.se/topics/Linux/ubuntu/"}]},{"title":"Quest Software acquires eXc and VizionCore","slug":"quest-software-acquires-exc-and-vizioncore","date":"2008-01-30T11:09:18.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"tb/quest-software-acquires-exc-and-vizioncore/","link":"","permalink":"https://www.teknoglot.se/tb/quest-software-acquires-exc-and-vizioncore/","excerpt":"Yes, I am officially slow. But never mind. Quest Software is a rather nice software developer with some interesting products for a wide range of Microsoft systems ‚Äì like Site Administrator and Recovery Manager for SharePoint ‚Äì but also database and application servers like SAP and Oracle E-business. I have lately been working with some of their MOSS-related products that, neglecting the somewhat goofy and unspecific manuals, are stable and well worth taking a look at. Quite recently they have acquired two other companies also worth paying attention to as they, too, tend to deliver products that ease things up. eXc does it‚Äôs thing in the Microsoft SCOM/MOM arena while VizionCore dances with virtualization techniques. At least, that‚Äôs where I‚Äôve come across them both. How will this affect me, then?Not very much it would seem. Here‚Äôs what VizionCore says about their part: ‚ÄúThe completion of this acquisition signals another major step in Vizioncore‚Äôs evolution and growth in the virtualization market,‚Äù said David Bieneman, CEO of VizionCore. ‚ÄúWhile maintaining the autonomy that has made us successful, we will also be able to leverage technologies developed by and acquired by Quest, such as Invirtus and Provision Networks, to enhance and expand the feature sets of VizionCore products. This is very positive news for virtualization customers who will enjoy a richer and robust product set that will help them achieve greater levels of ROI from their investments in virtualization platforms.‚Äù In my head, this means that VizionCore will still be VizionCore but with, perhaps, tighter integration with Invirtus. Invirtus was, by the way, a ‚ÄúStrategic Partner‚Äù to VizionCore even before the acquisition. eXc then? Well. It is not clearly stated in the press-release as far as I can tell. We can only hope that they will make the decision to rebuild their not-even-web1.0 excuse for a website. And what the hell is up with that logo? Fortunately for us, their design skills ‚Äì or lack thereof ‚Äì does not reflect their programming skills. But still‚Ä¶ no sane man or woman uses Comic Sans in a logo. Not even jokingly. Actually, using Comic Sans at all should be considered an act of felony. references: Quest Software Continues Its Value Add to Microsoft System Center Quest Software Completes Acquisition of VizionCore‚Ä¶","text":"Yes, I am officially slow. But never mind. Quest Software is a rather nice software developer with some interesting products for a wide range of Microsoft systems ‚Äì like Site Administrator and Recovery Manager for SharePoint ‚Äì but also database and application servers like SAP and Oracle E-business. I have lately been working with some of their MOSS-related products that, neglecting the somewhat goofy and unspecific manuals, are stable and well worth taking a look at. Quite recently they have acquired two other companies also worth paying attention to as they, too, tend to deliver products that ease things up. eXc does it‚Äôs thing in the Microsoft SCOM/MOM arena while VizionCore dances with virtualization techniques. At least, that‚Äôs where I‚Äôve come across them both. How will this affect me, then?Not very much it would seem. Here‚Äôs what VizionCore says about their part: ‚ÄúThe completion of this acquisition signals another major step in Vizioncore‚Äôs evolution and growth in the virtualization market,‚Äù said David Bieneman, CEO of VizionCore. ‚ÄúWhile maintaining the autonomy that has made us successful, we will also be able to leverage technologies developed by and acquired by Quest, such as Invirtus and Provision Networks, to enhance and expand the feature sets of VizionCore products. This is very positive news for virtualization customers who will enjoy a richer and robust product set that will help them achieve greater levels of ROI from their investments in virtualization platforms.‚Äù In my head, this means that VizionCore will still be VizionCore but with, perhaps, tighter integration with Invirtus. Invirtus was, by the way, a ‚ÄúStrategic Partner‚Äù to VizionCore even before the acquisition. eXc then? Well. It is not clearly stated in the press-release as far as I can tell. We can only hope that they will make the decision to rebuild their not-even-web1.0 excuse for a website. And what the hell is up with that logo? Fortunately for us, their design skills ‚Äì or lack thereof ‚Äì does not reflect their programming skills. But still‚Ä¶ no sane man or woman uses Comic Sans in a logo. Not even jokingly. Actually, using Comic Sans at all should be considered an act of felony. references: Quest Software Continues Its Value Add to Microsoft System Center Quest Software Completes Acquisition of VizionCore‚Ä¶","categories":[{"name":"Technobabble","slug":"tb","permalink":"https://www.teknoglot.se/topics/tb/"}],"tags":[{"name":"OpsMgr","slug":"OpsMgr","permalink":"https://www.teknoglot.se/tag/OpsMgr/"}],"keywords":[{"name":"Technobabble","slug":"tb","permalink":"https://www.teknoglot.se/topics/tb/"}]},{"title":"Intel Drivers causes old-school freezes on Windows Vista","slug":"intel-drivers-causes-old-school-freezes-on-windows-vista","date":"2007-12-01T11:31:55.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/winvista/intel-drivers-causes-old-school-freezes-on-windows-vista/","link":"","permalink":"https://www.teknoglot.se/ms/winvista/intel-drivers-causes-old-school-freezes-on-windows-vista/","excerpt":"I recently got a nice new Lenovo ThinkPad T61 laptop at work to replace the old T42 I had earlier. Totally nice with 2,2GHz dual-core, Windows Vista and stuff. Now, there seems to be a problem with some drivers since I get the back-to-the-90s kinda lockups. You know were pretty much everything remotely interactive freeze. No BSOD, no crasches, no reboot. Just a plain freeze and all you can do is to press and hold the powerbutton until the computer powers off. Apparently, these problems are caused by some bug or something in the Intel Turbo Memory Driver and the Intel Matrix Storage Manager in combination with some power-save feature in Windows Vista called ‚ÄúWindows Hybrid Hard Disk Power Savings Mode‚Äù. (Christ! Whatever happened to abrevations? I think i want those back. ‚ÄúITMD and IMSM with WHDDPSM causes hickups‚Äù‚Ä¶ no‚Ä¶ wait.) Aaaanyway.The people over at the forums of Notebookreview.com has experienced this and posted a guide with the appropriate links. Check it out at http://forum.notebookreview.com/showthread.php?t=160154&amp;page=2 Cheers!","text":"I recently got a nice new Lenovo ThinkPad T61 laptop at work to replace the old T42 I had earlier. Totally nice with 2,2GHz dual-core, Windows Vista and stuff. Now, there seems to be a problem with some drivers since I get the back-to-the-90s kinda lockups. You know were pretty much everything remotely interactive freeze. No BSOD, no crasches, no reboot. Just a plain freeze and all you can do is to press and hold the powerbutton until the computer powers off. Apparently, these problems are caused by some bug or something in the Intel Turbo Memory Driver and the Intel Matrix Storage Manager in combination with some power-save feature in Windows Vista called ‚ÄúWindows Hybrid Hard Disk Power Savings Mode‚Äù. (Christ! Whatever happened to abrevations? I think i want those back. ‚ÄúITMD and IMSM with WHDDPSM causes hickups‚Äù‚Ä¶ no‚Ä¶ wait.) Aaaanyway.The people over at the forums of Notebookreview.com has experienced this and posted a guide with the appropriate links. Check it out at http://forum.notebookreview.com/showthread.php?t=160154&amp;page=2 Cheers!","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"Windows Vista","slug":"ms/winvista","permalink":"https://www.teknoglot.se/topics/ms/winvista/"}],"tags":[{"name":"Drivers","slug":"Drivers","permalink":"https://www.teknoglot.se/tag/Drivers/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"Windows Vista","slug":"ms/winvista","permalink":"https://www.teknoglot.se/topics/ms/winvista/"}]},{"title":"w3Socket in VBScript","slug":"w3socket-in-vbscript","date":"2007-04-21T14:10:05.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"code/vbs/w3socket-in-vbscript/","link":"","permalink":"https://www.teknoglot.se/code/vbs/w3socket-in-vbscript/","excerpt":"I‚Äôve been doing quite a lot of VBScripting in a couple of projects lately. The current one requires med to connect to a couple of telnet servers and look for‚Ä¶ stuff.Since we‚Äôre not in VB6 och .Net i cannot simply user Winsock as normally due to the lack of licensing features in VBS/WSH. Thankfully for me, Dimac has release a nifty little component for free that makes talking telnet in VBS very simple. I thought that, hey! I must share this!So here‚Äôs an example in Classic VBS: Dim oTelnetoTelnet = CreateObject(Socket.Tcp)With oTelnet.DoTelnetEmulation = True.TelnetEmulation = TTY.Host = 192.168.242.1:23.Open.WaitFor SLUSSEN login:.SendLine ANiftyUsename.WaitFor Password:.SendLine TEHP@ssw0rd.WaitFor ~ #.SendLine ifconfigMsgBox .Buffer.CloseEnd WithSet oTelnet = Nothing Not very hard at all. This one is connecting to my router (with fake user/pwd‚Ä¶ DUH!) and there‚Äôs no support for setting the prompt type there, thus the ‚Äú~ #‚Äù.The result of running this script with correct login info gives me a popup with the routers NIC-configuration.","text":"I‚Äôve been doing quite a lot of VBScripting in a couple of projects lately. The current one requires med to connect to a couple of telnet servers and look for‚Ä¶ stuff.Since we‚Äôre not in VB6 och .Net i cannot simply user Winsock as normally due to the lack of licensing features in VBS/WSH. Thankfully for me, Dimac has release a nifty little component for free that makes talking telnet in VBS very simple. I thought that, hey! I must share this!So here‚Äôs an example in Classic VBS: Dim oTelnetoTelnet = CreateObject(Socket.Tcp)With oTelnet.DoTelnetEmulation = True.TelnetEmulation = TTY.Host = 192.168.242.1:23.Open.WaitFor SLUSSEN login:.SendLine ANiftyUsename.WaitFor Password:.SendLine TEHP@ssw0rd.WaitFor ~ #.SendLine ifconfigMsgBox .Buffer.CloseEnd WithSet oTelnet = Nothing Not very hard at all. This one is connecting to my router (with fake user/pwd‚Ä¶ DUH!) and there‚Äôs no support for setting the prompt type there, thus the ‚Äú~ #‚Äù.The result of running this script with correct login info gives me a popup with the routers NIC-configuration.","categories":[{"name":"Code","slug":"code","permalink":"https://www.teknoglot.se/topics/code/"},{"name":"VBS","slug":"code/vbs","permalink":"https://www.teknoglot.se/topics/code/vbs/"}],"tags":[{"name":"Script","slug":"Script","permalink":"https://www.teknoglot.se/tag/Script/"}],"keywords":[{"name":"Code","slug":"code","permalink":"https://www.teknoglot.se/topics/code/"},{"name":"VBS","slug":"code/vbs","permalink":"https://www.teknoglot.se/topics/code/vbs/"}]},{"title":"Silly Hibernation doo-doo on WinXP","slug":"silly-hibernation-doo-doo-on-winxp","date":"2006-12-03T11:55:52.000Z","updated":"2017-06-05T12:55:35.000Z","comments":true,"path":"ms/windows/winxp/silly-hibernation-doo-doo-on-winxp/","link":"","permalink":"https://www.teknoglot.se/ms/windows/winxp/silly-hibernation-doo-doo-on-winxp/","excerpt":"I recently added another 500MB of RAM to my computer‚Ä¶ and there was much rejoice. However, after a few days it started to behave erraticly when pressing the Fn+F12 combo (on a ThinkPad that means ‚ÄúHibernate‚Äù). It simply refused to hibernate with the very intuitive error message ‚ÄúInsufficent System Resources Exist to Complete the API‚Äù. Anyway. Microsoft has a fix for it, and you don‚Äôt have to call them to get it anymore either. Just follow the link below.http://support.microsoft.com/kb/Q909095","text":"I recently added another 500MB of RAM to my computer‚Ä¶ and there was much rejoice. However, after a few days it started to behave erraticly when pressing the Fn+F12 combo (on a ThinkPad that means ‚ÄúHibernate‚Äù). It simply refused to hibernate with the very intuitive error message ‚ÄúInsufficent System Resources Exist to Complete the API‚Äù. Anyway. Microsoft has a fix for it, and you don‚Äôt have to call them to get it anymore either. Just follow the link below.http://support.microsoft.com/kb/Q909095","categories":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"Windows","slug":"ms/windows","permalink":"https://www.teknoglot.se/topics/ms/windows/"},{"name":"Windows XP","slug":"ms/windows/winxp","permalink":"https://www.teknoglot.se/topics/ms/windows/winxp/"}],"tags":[{"name":"KB","slug":"KB","permalink":"https://www.teknoglot.se/tag/KB/"},{"name":"Drivers","slug":"Drivers","permalink":"https://www.teknoglot.se/tag/Drivers/"}],"keywords":[{"name":"Microsoft","slug":"ms","permalink":"https://www.teknoglot.se/topics/ms/"},{"name":"Windows","slug":"ms/windows","permalink":"https://www.teknoglot.se/topics/ms/windows/"},{"name":"Windows XP","slug":"ms/windows/winxp","permalink":"https://www.teknoglot.se/topics/ms/windows/winxp/"}]}]}